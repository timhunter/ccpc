(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     99407,       2347]
NotebookOptionsPosition[     96479,       2250]
NotebookOutlinePosition[     96876,       2268]
CellTagsIndexPosition[     96833,       2265]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Adapted from Jiwon Yun\[CloseCurlyQuote]s notebook, \"entropy\"\
\>", "Subsubtitle",
 CellChangeTimes->{{3.521046126505453*^9, 3.521046181479065*^9}, 
   3.521047276315086*^9}],

Cell[CellGroupData[{

Cell["Preliminary", "Section",
 CellChangeTimes->{{3.5210508405518312`*^9, 3.5210508497658653`*^9}, 
   3.5211105377011147`*^9, 3.5213195845808067`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", "\"\<~/projects/mcfgcky2_repos/\>\"", "]"}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"John", "'"}], "s", " ", "laptop"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.521041240635828*^9, 3.52104125008845*^9}, 
   3.521047276320116*^9, 3.521050849766611*^9, 3.521110537701565*^9, {
   3.521110577811446*^9, 3.521110585020406*^9}, 3.521319584581023*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Off", "[", 
    StyleBox[
     RowBox[{"Graph", "::", "optx"}], "MessageName"], "]"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Turn", " ", "off", " ", "warnings", " ", "about", " ", "graph", " ", 
    "options"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.521041824893127*^9, 3.521041827901721*^9}, 
   3.521047276317972*^9, 3.521050849766397*^9, 3.521110537701359*^9, {
   3.521110577811822*^9, 3.521110585021237*^9}, 3.5213195845812073`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "Combinatorica`", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"was", " ", 
     RowBox[{"<<", "DiscreteMath`Combinatorica`"}]}], ";"}], "  ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{
  3.521110537701769*^9, {3.521110577811635*^9, 3.5211105919804497`*^9}, 
   3.52131958458139*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "compat"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Combinatorica Graph and Permutations functionality has \
been superseded by preloaded functionaliy. The package now being loaded may \
conflict with this. Please see the Compatibility Guide for details.\"\>"}]], \
"Message", "MSG",
 CellChangeTimes->{3.52112449306336*^9, 3.521203852725874*^9, 
  3.52122704930739*^9, 3.521241534312839*^9, 3.521278625206046*^9, 
  3.5212955477130327`*^9, 3.5212963254779863`*^9, 3.521297104128696*^9, 
  3.52129748864942*^9, 3.521317871651843*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Normalize Grammar", "Section",
 CellChangeTimes->{{3.521050665803228*^9, 3.521050697003292*^9}, {
   3.521050778363489*^9, 3.521050807825485*^9}, 3.521319584581579*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChartToGrammar", "[", 
    RowBox[{"ch_", ",", 
     RowBox[{"startsymbolregexp_", " ", ":", "\"\<S.*\>\""}]}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nonterminals", ",", "terminals"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"LhsRhsSymbol", "[", "line_", "]"}], " ", ":=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"Length", "[", "line", "]"}], ",", "\[IndentingNewLine]", 
         "6", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}]}], "}"}], ",", "   ", 
         RowBox[{"(*", " ", 
          RowBox[{"terminal", " ", "line"}], " ", "*)"}], 
         "\[IndentingNewLine]", "7", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}]}], "}"}], ",", "    ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "unary", " ", "with", " ", "string", " ", "rewriting", " ", 
           "recipe"}], " ", "*)"}], "\[IndentingNewLine]", "8", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "7"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"(*", " ", "binary", " ", "*)"}], "\[IndentingNewLine]", "_",
          ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LhsSymbol", "[", "line_", "]"}], " ", ":=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"Length", "[", "line", "]"}], ",", "\[IndentingNewLine]", 
         "6", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Part", "[", 
           RowBox[{"line", ",", "4"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", "7", ",", 
         RowBox[{"{", 
          RowBox[{"Part", "[", 
           RowBox[{"line", ",", "4"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", "8", ",", 
         RowBox[{"{", 
          RowBox[{"Part", "[", 
           RowBox[{"line", ",", "4"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", "_", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kind", "[", "f_", "]"}], " ", ":=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"f", " ", "/@", " ", "ch"}], " ", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nonterminals", " ", "=", " ", 
       RowBox[{"kind", "[", "LhsSymbol", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"terminals", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"kind", "[", "LhsRhsSymbol", "]"}], ",", 
         RowBox[{"kind", "[", "LhsSymbol", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"both", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"nonterminals", ",", "terminals"}], "]"}]}], ";"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"markup", "[", "line_", "]"}], " ", ":=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"Length", "[", "line", "]"}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"throw", " ", "away", " ", "recipe"}], " ", "*)"}], 
         "\[IndentingNewLine]", "6", ",", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<Preterminal\>\"", ",", 
           FractionBox[
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "1"}], "]"}], 
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "3"}], "]"}]], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "7", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Unary\>\"", ",", 
           FractionBox[
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "1"}], "]"}], 
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "3"}], "]"}]], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "8", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Binary\>\"", ",", 
           FractionBox[
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "1"}], "]"}], 
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "3"}], "]"}]], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "7"}], "]"}]}], "}"}], ",", " ", 
         "\[IndentingNewLine]", "_", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Return", "[", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"nonterminals", ",", 
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"#", ",", 
               RowBox[{"RegularExpression", "[", "startsymbolregexp", "]"}]}],
               "]"}], "&"}]}], "]"}], "]"}], ",", 
         RowBox[{"(*", " ", 
          RowBox[{"assume", " ", 
           RowBox[{"it", "'"}], "s", " ", "the", " ", "first", " ", "one"}], 
          " ", "*)"}], "\[IndentingNewLine]", "              ", 
         "nonterminals", ",", "   ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "second", " ", "and", " ", "third", " ", "components", " ", 
           "constitute", " ", "a", " ", "disjoint", " ", "set", " ", "of", 
           " ", "vertex", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]",
          "              ", "terminals", ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"markup", "/@", "ch"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{"was", " ", ":", " ", 
          RowBox[{"divide", " ", "/@", " ", "vulgar"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5210453616988564`*^9, 3.521045509758832*^9}, {
   3.521045715358897*^9, 3.5210457644487534`*^9}, {3.5210459215826387`*^9, 
   3.521045947548011*^9}, {3.521045981802122*^9, 3.521046026772624*^9}, {
   3.521046057423563*^9, 3.5210460587118883`*^9}, {3.521046209436735*^9, 
   3.5210462620031843`*^9}, {3.521046424560535*^9, 3.521046437502431*^9}, {
   3.521046537202574*^9, 3.521046562580079*^9}, {3.521046886481656*^9, 
   3.5210469504606447`*^9}, 3.5210472763329477`*^9, {3.521047322676434*^9, 
   3.521047417919262*^9}, {3.521047500450485*^9, 3.521047566205042*^9}, {
   3.521047599390966*^9, 3.5210476005019903`*^9}, {3.521047730504223*^9, 
   3.521047730889804*^9}, {3.521047832629524*^9, 3.5210478353071613`*^9}, 
   3.521050807825715*^9, {3.5210595696987543`*^9, 3.521059584971801*^9}, {
   3.521059615405764*^9, 3.521059677094536*^9}, {3.521059783677019*^9, 
   3.521059833273716*^9}, {3.521059863494815*^9, 3.521060248406458*^9}, {
   3.5210602907553577`*^9, 3.5210603065615797`*^9}, {3.521229429665511*^9, 
   3.521229459648827*^9}, {3.521282679198513*^9, 3.521282683065998*^9}, {
   3.521282737823332*^9, 3.521282742824397*^9}, {3.5212828074589043`*^9, 
   3.521282839983326*^9}, {3.5212853969616632`*^9, 3.5212854114860783`*^9}, 
   3.521285902428548*^9, {3.5212885355773077`*^9, 3.5212885741874638`*^9}, {
   3.521294696925201*^9, 3.5212947146195173`*^9}, 3.521294779902314*^9, 
   3.521294864924876*^9, 3.5212949848535957`*^9, {3.521312817265922*^9, 
   3.5213128182490597`*^9}, {3.521312863434371*^9, 3.521312866356287*^9}, {
   3.521312941666684*^9, 3.521312948123149*^9}, {3.52131301190842*^9, 
   3.521313039276209*^9}, {3.521313124434664*^9, 3.521313194541823*^9}, {
   3.521313239050331*^9, 3.5213132663792553`*^9}, {3.521313329431266*^9, 
   3.521313380884316*^9}, {3.521313413168827*^9, 3.521313467645018*^9}, {
   3.521313504007193*^9, 3.521313537729723*^9}, {3.521313578500512*^9, 
   3.521313578968895*^9}, {3.521313667400344*^9, 3.521313715615177*^9}, {
   3.52131379427017*^9, 3.5213138044202538`*^9}, 3.521317882539277*^9, 
   3.521319584581788*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Create Graph Projection", "Section",
 CellChangeTimes->{{3.521050816821314*^9, 3.52105082730166*^9}, 
   3.521319584581963*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GraphProjection", "[", "g_", " ", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "start", ",", "nonterminals", ",", "terminals", ",", "vertices", ",", 
       "rules", ",", "edges"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "g"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"vertices", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"nonterminals", ",", "terminals"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"edges", " ", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"lookup", "[", 
        RowBox[{"rulenum_", ",", "eltnum_"}], "]"}], " ", ":=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"vertices", ",", 
           RowBox[{
            RowBox[{"rules", "[", 
             RowBox[{"[", "rulenum", "]"}], "]"}], "[", 
            RowBox[{"[", "eltnum", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "rules", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t    ", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"rules", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]",
           "\t ", "\"\<Preterminal\>\"", ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"edges", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"lookup", "[", 
               RowBox[{"i", ",", "3"}], "]"}], ",", 
              RowBox[{"lookup", "[", 
               RowBox[{"i", ",", "4"}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", "\"\<Unary\>\"", ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"edges", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"lookup", "[", 
               RowBox[{"i", ",", "3"}], "]"}], ",", 
              RowBox[{"lookup", "[", 
               RowBox[{"i", ",", "4"}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", "\"\<Binary\>\"", ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"edges", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"lookup", "[", 
                RowBox[{"i", ",", "3"}], "]"}], ",", 
               RowBox[{"lookup", "[", 
                RowBox[{"i", ",", "4"}], "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t   ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"edges", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"lookup", "[", 
                RowBox[{"i", ",", "3"}], "]"}], ",", 
               RowBox[{"lookup", "[", 
                RowBox[{"i", ",", "5"}], "]"}]}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", "\t", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FromOrderedPairs", "[", "edges", "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.521046308779977*^9, 3.521046417471559*^9}, {
   3.521046465705617*^9, 3.52104648275665*^9}, 3.5210472763788977`*^9, {
   3.521047623054633*^9, 3.5210476292926483`*^9}, {3.5210478406806717`*^9, 
   3.521048085333157*^9}, {3.5210481224280653`*^9, 3.5210482947953777`*^9}, {
   3.521048342418798*^9, 3.5210486200115347`*^9}, 3.521048832480753*^9, 
   3.52105082730197*^9, 3.521319584582135*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Strongly - Connected Components", "Section",
 CellChangeTimes->{{3.5210508646150627`*^9, 3.5210509050477533`*^9}, 
   3.521234159712307*^9, 3.521319584582305*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ftimeDFSVisit", "[", "u_Integer", "]"}], " ", ":=", 
  "\[IndentingNewLine]", "\t\t", 
  RowBox[{"Module", " ", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "recursive", " ", "helper", " ", "function", " ", "for", " ", 
       "ftimeDFS"}], ",", " ", "below"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"color", "[", 
       RowBox[{"[", "u", "]"}], "]"}], " ", "=", " ", "Gray"}], ";", 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"Scan", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"color", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "White"}], ",", 
            "\[IndentingNewLine]", "\t\t\t\t", 
            RowBox[{
             RowBox[{"ftimeDFSVisit", "[", "#", "]"}], ";", 
             "\[IndentingNewLine]", "\t\t\t\t", 
             RowBox[{
              RowBox[{"color", "[", 
               RowBox[{"[", "u", "]"}], "]"}], "=", "Black"}]}]}], "]"}], ";",
           "\[IndentingNewLine]", "\t\t\t\t   ", 
          RowBox[{"t", "++"}], ";", "\[IndentingNewLine]", "\t\t\t   ", 
          RowBox[{
           RowBox[{"ftime", "[", 
            RowBox[{"[", "u", "]"}], "]"}], "=", " ", "t"}], ";"}], 
         "\[IndentingNewLine]", "\t\t", ")"}], "&"}], ",", 
       RowBox[{"e", "[", 
        RowBox[{"[", "u", "]"}], "]"}]}], "\[IndentingNewLine]", "\t\t\t", 
      "]"}]}]}], "\[IndentingNewLine]", "\t\t", "]"}]}]], "Input",
 CellChangeTimes->{{3.52123380834979*^9, 3.5212338390229673`*^9}, {
   3.5212340668484163`*^9, 3.5212340876523523`*^9}, 3.521234168680027*^9, 
   3.52124157637729*^9, 3.5213195845824757`*^9}],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{"ftimeDFS", "[", "g_Graph", "]"}], " ", ":=", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "function", " ", "computes", " ", "a", " ", "list", " ", 
      "of", " ", "finishing", " ", "times", " ", "in", " ", "a", " ", "DFS", 
      " ", "traversal", " ", "of", " ", 
      RowBox[{"g", ".", " ", "p541"}], " ", "of", " ", "Cormen"}], ",", " ", 
     RowBox[{
      RowBox[{"Leisersohn", " ", "&"}], " ", "Rivest"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"color", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"White", ",", 
          RowBox[{"{", 
           RowBox[{"V", "[", "g", "]"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"t", "=", "0"}], ",", 
       RowBox[{"e", "=", 
        RowBox[{"ToAdjacencyLists", "[", "g", "]"}]}], ",", 
       RowBox[{"ftime", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"V", "[", "g", "]"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"$RecursionLimit", " ", "=", " ", "Infinity"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"for", " ", "each", " ", "vertex"}], ",", " ", 
       RowBox[{"check", " ", "if", " ", 
        RowBox[{"we", "'"}], "ve", " ", "been", " ", "there", " ", "before"}],
        ",", " ", 
       RowBox[{"otherwise", " ", "call", " ", "ftimeDFSVisit"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"color", "[", 
            RowBox[{"[", "vert", "]"}], "]"}], "\[Equal]", "White"}], ",", 
          RowBox[{"ftimeDFSVisit", "[", "vert", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"vert", ",", "1", ",", 
          RowBox[{"V", "[", "g", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"V", "[", "g", "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ftime", "[", 
             RowBox[{"[", "#1", "]"}], "]"}], ">", 
            RowBox[{"ftime", "[", 
             RowBox[{"[", "#2", "]"}], "]"}]}], ")"}], "&"}]}], "]"}], 
       "]"}]}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Descending", " ", "order", " ", "order", " ", "on", " ", "times"}], 
      " ", "=", " ", 
      RowBox[{"Ascending", " ", "whole", " ", "numbers"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.52123380834979*^9, 3.521233815624053*^9}, {
   3.521234028429615*^9, 3.52123406191055*^9}, 3.521234168680298*^9, 
   3.5213195845826387`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"myDFSVisit", "[", "u_Integer", "]"}], " ", ":=", " ", 
   RowBox[{"Module", " ", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "recursive", " ", "helper", " ", "function", " ", "for", " ", 
        "myDFS"}], ",", " ", "below"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"lastfound", ",", "u"}], "]"}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{
       RowBox[{"color", "[", 
        RowBox[{"[", "u", "]"}], "]"}], " ", "=", " ", "Gray"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"Scan", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"color", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "White"}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{"myDFSVisit", "[", "#", "]"}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{"color", "[", 
               RowBox[{"[", "u", "]"}], "]"}], "=", "Black"}]}]}], "]"}], 
          ")"}], "&"}], ",", 
        RowBox[{"e", "[", 
         RowBox[{"[", "u", "]"}], "]"}]}], "\[IndentingNewLine]", "\t\t", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.52123380834979*^9, 3.521233849303899*^9}, {
   3.521234092238488*^9, 3.521234099003668*^9}, 3.521234168680518*^9, 
   3.521319584582803*^9}],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"myDFS", "[", 
     RowBox[{"graph_Graph", ",", "orderedvertices_List"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "same", " ", "algorithm", " ", "but", " ", "keep", " ", "track", " ", 
       "of", " ", "all", " ", "vertices", " ", "in", " ", "what", " ", "CLR", 
       " ", "call", " ", "the", " ", "Depth"}], "-", 
      RowBox[{"first", " ", "Forest"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"color", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"White", ",", 
           RowBox[{"{", 
            RowBox[{"V", "[", "graph", "]"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"e", "=", 
         RowBox[{"ToAdjacencyLists", "[", "graph", "]"}]}], ",", 
        RowBox[{"lastfound", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"$RecursionLimit", " ", "=", " ", "Infinity"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"color", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", " ", "White"}], ",", 
           
           RowBox[{
            RowBox[{"myDFSVisit", "[", "#", "]"}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"SCCs", ",", "lastfound"}], "]"}], ";", 
            RowBox[{"lastfound", "=", 
             RowBox[{"{", "}"}]}]}]}], "]"}], ")"}], "&"}], " ", "/@", " ", 
       "orderedvertices"}]}], "\[IndentingNewLine]", "\t", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.52123380834979*^9, 3.521233849303899*^9}, {
   3.521234107952362*^9, 3.521234168680736*^9}, 3.521319584582965*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getSCCs", "[", "graph_Graph", "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"SCCs", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"myDFS", "[", 
      RowBox[{
       RowBox[{"ReverseEdges", "[", "graph", "]"}], ",", 
       RowBox[{"ftimeDFS", "[", "graph", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", 
      RowBox[{"Reverse", "[", "SCCs", "]"}], "]"}]}]}], "\[IndentingNewLine]",
    "\t", "]"}]}]], "Input",
 CellChangeTimes->{{3.521203983708074*^9, 3.521203997087873*^9}, {
   3.5212040465146713`*^9, 3.521204154075883*^9}, {3.5212042099955673`*^9, 
   3.5212042173062763`*^9}, {3.5212043858620663`*^9, 3.521204389899292*^9}, {
   3.521204441693245*^9, 3.5212044481989393`*^9}, {3.5212045916664057`*^9, 
   3.521204605292041*^9}, {3.521204853517263*^9, 3.521204876868855*^9}, {
   3.521206412706799*^9, 3.5212064505112133`*^9}, {3.521207493615526*^9, 
   3.5212074963433123`*^9}, {3.521208179064296*^9, 3.521208180547997*^9}, {
   3.521208211453815*^9, 3.521208213237515*^9}, {3.521208251008823*^9, 
   3.521208251729707*^9}, {3.52120853237495*^9, 3.521208533062118*^9}, {
   3.521228394334072*^9, 3.521228395813717*^9}, 3.521233406799541*^9, {
   3.521233615686246*^9, 3.521233674420582*^9}, {3.5212337182113028`*^9, 
   3.521233759500865*^9}, 3.521233793419997*^9, 3.521233863737523*^9, 
   3.52131958458313*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculate Inside Probabilities", "Section",
 CellChangeTimes->{{3.521050924216598*^9, 3.521050936466646*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CalculateZ", "[", 
    RowBox[{"grammar_", ",", "graphprojection_", ",", "sortedSCCs_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myZ", ",", "start", ",", "nonterminals", ",", "terminals", ",", 
       "rules", ",", "tbl", ",", "vertices", ",", "vertexNumber", ",", 
       "vertexLabel", ",", "eqns", ",", "vars", ",", "zValues"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "grammar"}], ";", "\[IndentingNewLine]", 
      RowBox[{"vertices", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"nonterminals", ",", "terminals"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "is", " ", "the", " ", "ordering", " ", "used", " ", "in",
         " ", "GraphProjection"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"tbl", " ", "=", " ", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"nt", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"rules", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "\[Equal]", "nt"}], "&"}]}], 
           "]"}]}], "]"}], "/@", " ", "nonterminals"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Initialize", " ", "the", " ", "list", " ", "of", " ", "Z", " ", 
        "values", " ", "as", " ", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"myZ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"V", "[", "graphprojection", "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"vertexNumber", " ", "\[Rule]", " ", "x_vertexNumber"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XVariable", "[", "n_", "]"}], ":=", 
       RowBox[{"Subscript", "[", 
        RowBox[{"x", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vertexNumber", "[", "v_String", "]"}], " ", ":=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"vertices", ",", "v"}], "]"}], "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"just", " ", "as", " ", "in", " ", "GraphProjection"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vertexLabel", "[", "v_Integer", "]"}], " ", ":=", " ", 
       RowBox[{"vertices", "[", 
        RowBox[{"[", "v", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Recursive", " ", "Function", " ", 
         RowBox[{"Falpha", ":", " ", 
          RowBox[{
           RowBox[{"Falpha", "[", 
            RowBox[{"scc", ",", "rhs"}], "]"}], " ", "calculates", " ", "the",
            " ", "value", " ", "of", " ", "f_a", " ", "for", " ", "the", " ", 
           "given", " ", "scc"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "following", " ", "the", " ", "instruction", " ", "in", " ", 
           "Nederhof"}], " ", "&"}], " ", "Satta", " ", 
         RowBox[{"(", "2008", ")"}], " ", "p", ".146"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"caller", ":", " ", "Expr"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Falpha", "[", 
        RowBox[{"scc_", ",", "rhs_"}], "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"rhs", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "1", "]"}], ",", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", "22", ")"}], " ", "f_epsilon"}], " ", "=", " ", 
              "1"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"terminals", ",", 
                 RowBox[{"vertexLabel", "[", 
                  RowBox[{"First", "[", "rhs", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", 
                RowBox[{"Falpha", "[", 
                 RowBox[{"scc", ",", 
                  RowBox[{"Rest", "[", "rhs", "]"}]}], "]"}], "]"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", "23", ")"}], " ", "f_ab"}], " ", "=", " ", 
                  "f_b"}], ",", " ", 
                 RowBox[{"if", " ", "a", " ", "is", " ", "terminal"}]}], " ", 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"scc", ",", 
                    RowBox[{"First", "[", "rhs", "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Return", "[", 
                   RowBox[{
                    RowBox[{"myZ", "[", 
                    RowBox[{"[", 
                    RowBox[{"First", "[", "rhs", "]"}], "]"}], "]"}], "*", 
                    RowBox[{"Falpha", "[", 
                    RowBox[{"scc", ",", 
                    RowBox[{"Rest", "[", "rhs", "]"}]}], "]"}]}], "]"}], ",", 
                  
                  RowBox[{"(*", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", "24", ")"}], " ", "f_Bb"}], " ", "=", " ", 
                    RowBox[{"Z", 
                    RowBox[{"(", "B", ")"}], " ", "*", " ", "f_b"}]}], ",", 
                    " ", 
                    RowBox[{
                    "if", " ", "B", " ", "is", " ", "not", " ", "a", " ", 
                    "member", " ", "of", " ", "the", " ", "scc"}]}], " ", 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"Return", "[", 
                   RowBox[{
                    RowBox[{"XVariable", "[", 
                    RowBox[{"First", "[", "rhs", "]"}], "]"}], "*", 
                    RowBox[{"Falpha", "[", 
                    RowBox[{"scc", ",", 
                    RowBox[{"Rest", "[", "rhs", "]"}]}], "]"}]}], "]"}]}], 
                 " ", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", "25", ")"}], " ", "f_Bb"}], " ", "=", " ", 
                    RowBox[{"x_i", " ", "*", " ", "f_b"}]}], ",", " ", 
                   RowBox[{
                   "if", " ", "B", " ", "is", " ", "a", " ", "member", " ", 
                    "of", " ", "the", " ", "scc"}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Function", " ", 
         RowBox[{"Expr", ":", " ", 
          RowBox[{
           RowBox[{"Expr", "[", 
            RowBox[{"scc", ",", "vertex"}], "]"}], " ", "gives", " ", "a", 
           " ", "polynomial", " ", "expression", " ", "for", " ", "each", " ",
            "vertex", " ", "in", " ", "the", " ", "scc"}]}]}], ",", " ", 
        RowBox[{"which", " ", "eventually", " ", "comprises", " ", "Eqns"}]}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Expr", "[", 
        RowBox[{"scc_", ",", "vertex_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "myValue", ",", "weight", ",", "rhs", ",", "relevantRules"}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"terminals", ",", 
              RowBox[{"vertexLabel", "[", "vertex", "]"}]}], "]"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"XVariable", "[", "vertex", "]"}]}], "+", "1"}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"otherwise", "..."}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"myValue", "=", 
           RowBox[{"-", 
            RowBox[{"XVariable", "[", "vertex", "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Scan", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"r", ",", 
              RowBox[{
               RowBox[{"weight", " ", "=", " ", 
                RowBox[{"r", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
                "\t", 
               RowBox[{"rhs", " ", "=", " ", 
                RowBox[{"vertexNumber", " ", "/@", " ", 
                 RowBox[{"Switch", "[", 
                  RowBox[{
                   RowBox[{"First", "[", "r", "]"}], ",", "\"\<Binary\>\"", 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", "_", ",", 
                   RowBox[{"{", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "}"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"myValue", "+=", 
                RowBox[{"weight", "*", 
                 RowBox[{"Falpha", "[", 
                  RowBox[{"scc", ",", "rhs"}], "]"}]}]}]}]}], "]"}], ",", 
            RowBox[{"tbl", "[", 
             RowBox[{"[", "vertex", "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "myValue", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Vars", "[", "scc_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "poly", "}"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"poly", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Expr", "[", 
              RowBox[{"scc", ",", "#"}], "]"}], "&"}], "/@", " ", "scc"}]}], 
          ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"Variables", "[", "poly", "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eqns", "[", "scc_", "]"}], ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Expr", "[", 
            RowBox[{"scc", ",", "#"}], "]"}], "\[Equal]", "0"}], ")"}], "&"}],
         "/@", "scc"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"For", " ", "each", " ", "scc"}], ",", " ", 
        RowBox[{
        "calculate", " ", "the", " ", "Z", " ", "value", " ", "of", " ", 
         "all", " ", "the", " ", "vertices", " ", "in", " ", "it"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"myBucket", ",", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "myBucket", "]"}], "\[Equal]", "0"}], ",",
             " ", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Case", " ", "0"}], ":", " ", 
               RowBox[{"the", " ", "scc", " ", "is", " ", "empty"}]}], " ", 
              "\[Rule]", " ", 
              RowBox[{"something", " ", "is", " ", 
               RowBox[{"wrong", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Fail: The scc is empty\>\"", ",", "i"}], "]"}], ",",
             " ", 
            RowBox[{"(*", " ", 
             RowBox[{"Jiwon", ":", " ", 
              RowBox[{"break", " ", 
               RowBox[{"here", "!!"}]}]}], " ", "*)"}], "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Case", " ", "1"}], ":", " ", 
              RowBox[{
              "otherwise", " ", "we", " ", "can", " ", "calculate", " ", 
               "the", " ", "inside", " ", "probability", " ", "of", " ", 
               "each", " ", "node", " ", "in", " ", "the", " ", 
               RowBox[{"scc", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"eqns", "=", 
              RowBox[{"Eqns", "[", "myBucket", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"vars", "=", 
              RowBox[{"Vars", "[", "myBucket", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"zValues", "=", 
              RowBox[{"vars", "/.", 
               RowBox[{"FindRoot", "[", 
                RowBox[{"eqns", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "0"}], "}"}], "&"}], "/@", "vars"}], 
                  ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Scan", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", ">", "10"}], " ", "||", 
                  RowBox[{"#", "<", "0"}]}], ",", 
                 RowBox[{"Abort", "[", "]"}]}], "]"}], ",", "zValues"}], 
              "]"}], ";", " ", 
             RowBox[{"(*", " ", "sanity", " ", "*)"}], "\[IndentingNewLine]", 
             
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "<=", 
                RowBox[{"Length", "[", "vars", "]"}]}], ",", 
               RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"vars", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "=", " ", 
                 RowBox[{
                  RowBox[{"subscript", " ", "number"}], " ", "=", " ", 
                  RowBox[{"vertex", " ", "number"}]}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<node \>\"", ",", 
                   RowBox[{
                    RowBox[{"vars", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\< Z=\>\"", ",", 
                   RowBox[{"zValues", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"myZ", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"vars", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
                 RowBox[{"zValues", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], ",", "sortedSCCs"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "myZ", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.521050963466382*^9, 3.52105096490619*^9}, {
   3.521051028829207*^9, 3.52105103526641*^9}, {3.5210511788734503`*^9, 
   3.521051222761256*^9}, {3.521051256017447*^9, 3.521051355503663*^9}, {
   3.521051387885639*^9, 3.521051421914116*^9}, {3.521051473038464*^9, 
   3.5210514964544907`*^9}, {3.521051906150488*^9, 3.521051912721962*^9}, {
   3.521051959234867*^9, 3.52105198039261*^9}, {3.5210520493787107`*^9, 
   3.5210520572922983`*^9}, {3.5210521289949512`*^9, 
   3.5210522489685907`*^9}, {3.521052312223234*^9, 3.521052374827656*^9}, {
   3.521052410222352*^9, 3.5210525085050364`*^9}, {3.5210526387111683`*^9, 
   3.521052645338029*^9}, {3.5210527525730047`*^9, 3.521052816311141*^9}, {
   3.521052890899049*^9, 3.521052891303132*^9}, {3.521052965058267*^9, 
   3.521052991424265*^9}, {3.5210530292931423`*^9, 3.521053060015956*^9}, {
   3.521053140055848*^9, 3.52105317069984*^9}, {3.5210532441177998`*^9, 
   3.521053273327066*^9}, {3.521053310906169*^9, 3.521053350949424*^9}, {
   3.5210534258260393`*^9, 3.521053428187635*^9}, {3.5210534782939167`*^9, 
   3.521053501001923*^9}, {3.521053533097218*^9, 3.5210535453727627`*^9}, {
   3.5210535808284273`*^9, 3.521053647318647*^9}, {3.521053682077736*^9, 
   3.521053704631069*^9}, {3.5210537760590343`*^9, 3.521053971386417*^9}, {
   3.521054152689769*^9, 3.521054160827986*^9}, {3.52105460370862*^9, 
   3.521054604319113*^9}, {3.5210546978427067`*^9, 3.5210547017024393`*^9}, {
   3.521054811549306*^9, 3.5210548124454727`*^9}, {3.5210548679487057`*^9, 
   3.521054894891707*^9}, {3.521055410801669*^9, 3.521055443681818*^9}, {
   3.5210569799374733`*^9, 3.521056981731896*^9}, 3.521057367750722*^9, {
   3.521057974663062*^9, 3.521057983544602*^9}, {3.52106045028405*^9, 
   3.521060452551876*^9}, {3.521065660642516*^9, 3.521065661772284*^9}, {
   3.521103417042163*^9, 3.521103418422183*^9}, {3.5211106556287107`*^9, 
   3.521110679759441*^9}, {3.521110826925111*^9, 3.521110828439506*^9}, {
   3.521241931289513*^9, 3.521242099300514*^9}, {3.521242142337459*^9, 
   3.521242206307404*^9}, {3.5212422560229273`*^9, 3.521242356814395*^9}, {
   3.5212423902691317`*^9, 3.521242567289056*^9}, {3.521242609314695*^9, 
   3.5212426132087107`*^9}, {3.521242651933394*^9, 3.521242689170977*^9}, {
   3.521242814646936*^9, 3.521242862862753*^9}, {3.5212430616728783`*^9, 
   3.521243103365232*^9}, {3.521243468387285*^9, 3.521243487402128*^9}, {
   3.521243692157366*^9, 3.5212437204809713`*^9}, {3.521243813520628*^9, 
   3.521243833782428*^9}, {3.521243953132824*^9, 3.521243999676551*^9}, {
   3.521244057871716*^9, 3.521244062105088*^9}, {3.5212442045589046`*^9, 
   3.5212442222877893`*^9}, {3.52124427168361*^9, 3.521244283944644*^9}, {
   3.52124492175791*^9, 3.5212449852412567`*^9}, {3.521245024273617*^9, 
   3.521245094337302*^9}, {3.521245146219775*^9, 3.521245166108247*^9}, {
   3.52124520475524*^9, 3.5212452088505707`*^9}, {3.5212452697323914`*^9, 
   3.5212452782474947`*^9}, {3.521245386986876*^9, 3.521245390927082*^9}, {
   3.521245432815832*^9, 3.521245433341372*^9}, {3.521245706975243*^9, 
   3.5212457176429243`*^9}, {3.521245915074039*^9, 3.521245919079719*^9}, {
   3.521245983999357*^9, 3.5212459904934673`*^9}, {3.521246298820109*^9, 
   3.521246316915447*^9}, {3.521246455276247*^9, 3.5212464669908524`*^9}, {
   3.521246581061974*^9, 3.521246621449978*^9}, {3.521246701066279*^9, 
   3.521246732823806*^9}, {3.521246813840914*^9, 3.521246827251734*^9}, {
   3.521246860925748*^9, 3.52124690678019*^9}, {3.5212469846728354`*^9, 
   3.5212470325721607`*^9}, {3.52124708011476*^9, 3.521247198040626*^9}, {
   3.5212784966515913`*^9, 3.521278545859209*^9}, 3.5212789577540092`*^9, {
   3.52128648359439*^9, 3.521286530917808*^9}, {3.5212882338114443`*^9, 
   3.521288235244276*^9}, 3.5212886589309196`*^9, {3.521290685953918*^9, 
   3.5212906893364897`*^9}, {3.521290783912389*^9, 3.521290785853427*^9}, {
   3.521290873754937*^9, 3.521290879163756*^9}, {3.5212950227211533`*^9, 
   3.521295027709084*^9}, {3.521296428087329*^9, 3.5212964293726387`*^9}, {
   3.521297004097254*^9, 3.521297032841053*^9}, {3.5212971167915*^9, 
   3.521297122285644*^9}, {3.521297163093952*^9, 3.521297174674197*^9}, {
   3.521297304382716*^9, 3.521297350457254*^9}, 3.521317754661022*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Tilt by Z", "Section",
 CellChangeTimes->{{3.5210627888864403`*^9, 3.521062802172014*^9}, {
  3.521319353359457*^9, 3.521319355041935*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TiltGrammar", "[", 
    RowBox[{"g_", ",", "z_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "start", ",", "nonterminals", ",", "terminals", ",", "rules", ",", 
       "amount"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "g"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"vertices", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"nonterminals", ",", "terminals"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"vertexNumber", "[", "v_String", "]"}], " ", ":=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"vertices", ",", "v"}], "]"}], "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"just", " ", "as", " ", "in", " ", "GraphProjection"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"zParent", "[", "lhs_String", "]"}], " ", ":=", " ", 
       RowBox[{"z", "[", 
        RowBox[{"[", 
         RowBox[{"vertexNumber", "[", "lhs", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "         ", 
      RowBox[{
       RowBox[{"zChildren", "[", "rhs_List", "]"}], " ", ":=", " ", 
       RowBox[{"Fold", "[", 
        RowBox[{"Times", ",", "1", ",", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"sym", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"terminals", ",", "sym"}], "]"}], ",", "1", ",", 
              RowBox[{"z", "[", 
               RowBox[{"[", 
                RowBox[{"vertexNumber", "[", "sym", "]"}], "]"}], "]"}]}], 
             "]"}]}], "]"}], "/@", "rhs"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\n", "\t       ", 
      RowBox[{
       RowBox[{"TiltRule", "[", "wrule_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"originalprob", ",", "lhs", ",", "rhs"}], "}"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"originalprob", " ", "=", " ", 
           RowBox[{"Part", "[", 
            RowBox[{"wrule", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"lhs", " ", "=", 
           RowBox[{"Part", "[", 
            RowBox[{"wrule", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"rhs", " ", "=", " ", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"wrule", ",", "1"}], "]"}], ",", "\"\<Binary\>\"", ",", 
             
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"wrule", ",", "4"}], "]"}], ",", 
               RowBox[{"Part", "[", 
                RowBox[{"wrule", ",", "5"}], "]"}]}], "}"}], ",", "_", ",", 
             RowBox[{"{", 
              RowBox[{"Part", "[", 
               RowBox[{"wrule", ",", "4"}], "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"amount", " ", "=", " ", 
           FractionBox[
            RowBox[{"zChildren", "[", "rhs", "]"}], 
            RowBox[{"zParent", "[", "lhs", "]"}]]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"1", "-", "amount"}], "]"}], ">", 
             SuperscriptBox["10", 
              RowBox[{"-", "10"}]]}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<tilting by \>\"", ",", "amount"}], "]"}]}], "]"}], 
          ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"wrule", ",", 
            RowBox[{"2", "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"originalprob", "*", "amount"}], ")"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "start", ",", "\[IndentingNewLine]", "                      ", 
         "nonterminals", ",", "\[IndentingNewLine]", "                      ",
          "terminals", ",", "\[IndentingNewLine]", "\t             ", 
         RowBox[{"TiltRule", "/@", "rules"}]}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.521064634288941*^9, 3.521064669575275*^9}, {
   3.521064749358428*^9, 3.52106477920584*^9}, {3.521064820572771*^9, 
   3.521064934116136*^9}, {3.521064969236292*^9, 3.5210650520642843`*^9}, {
   3.521065103872355*^9, 3.5210652469257803`*^9}, {3.521065323291642*^9, 
   3.52106532910573*^9}, {3.5210653615932083`*^9, 3.5210653622175713`*^9}, {
   3.521065451504815*^9, 3.521065496517537*^9}, {3.521065530359167*^9, 
   3.521065596445261*^9}, {3.521065685692095*^9, 3.5210658909074697`*^9}, 
   3.521066206789157*^9, {3.521066239231772*^9, 3.521066240665299*^9}, {
   3.5210663961555233`*^9, 3.521066414728958*^9}, {3.521278987834457*^9, 
   3.521279008295988*^9}, {3.521279070665119*^9, 3.521279194785535*^9}, {
   3.52129042455934*^9, 3.52129042464744*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Entropy of Grammar", "Section",
 CellChangeTimes->{{3.521066615424281*^9, 3.521066623161025*^9}, 
   3.521067480624716*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"littleh", "[", "g_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"start", ",", "nonterminals", ",", "terminals", ",", "rules"}], 
      "}"}], ",", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "g"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\t\t\t", 
      RowBox[{
       RowBox[{"Eta", "[", "p_", "]"}], ":=", 
       RowBox[{
        RowBox[{"-", "p"}], "*", 
        RowBox[{"Log2", "[", "p", "]"}]}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"is", " ", "there", " ", "a", " ", "better", " ", 
        RowBox[{"name", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"nt", ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
          RowBox[{"Fold", "[", 
           RowBox[{"Plus", ",", "0", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Eta", "[", 
               RowBox[{"Part", "[", 
                RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], "/@", " ", 
             RowBox[{"Select", "[", 
              RowBox[{"rules", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "3"}], "]"}], "\[Equal]", "nt"}], "&"}]}],
               " ", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
         "\t\t                    ", "]"}], " ", "/@", " ", "nonterminals"}], 
       "\[IndentingNewLine]", "\t\t\t\t", "]"}]}]}], "\[IndentingNewLine]", 
    "\t\t\t", "\[IndentingNewLine]", "\t\t\t", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.521066926550675*^9, 3.521066987787122*^9}, {
  3.521067025158918*^9, 3.521067040924506*^9}, {3.521067073364771*^9, 
  3.52106707361235*^9}, {3.521067111902608*^9, 3.521067170551113*^9}, {
  3.521067223857483*^9, 3.521067284371007*^9}, {3.521067456602127*^9, 
  3.521067480629274*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fertilitymatrix", "[", "g_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "start", ",", "nonterminals", ",", "terminals", ",", "rules", ",", 
       "idx", ",", "a"}], "}"}], ",", "\[IndentingNewLine]", 
     "\t\t\t                    ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "g"}], ";", "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{
       RowBox[{"idx", "[", "nt_String", "]"}], " ", ":=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"nonterminals", ",", "nt"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{"a", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "nonterminals", "]"}], ",", 
           RowBox[{"Length", "[", "nonterminals", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{
       RowBox[{"updateA", "[", "r_", "]"}], " ", ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"prob", ",", "lhs"}], "}"}], ",", "\[IndentingNewLine]", 
         "\t                                              ", 
         RowBox[{
          RowBox[{"prob", " ", "=", " ", 
           RowBox[{"Part", "[", 
            RowBox[{"r", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t\t\t\t\t\t", 
          RowBox[{"lhs", " ", "=", 
           RowBox[{"Part", "[", 
            RowBox[{"r", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"nonterminals", ",", 
              RowBox[{"Part", "[", 
               RowBox[{"r", ",", "4"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"idx", "[", "lhs", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"idx", "[", 
                RowBox[{"Part", "[", 
                 RowBox[{"r", ",", "4"}], "]"}], "]"}], "]"}], "]"}], " ", "+=",
              " ", "prob"}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t\t\t\t\t", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"r", ",", "1"}], "]"}], "\[Equal]", "\"\<Binary\>\""}],
              " ", "&&", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"nonterminals", ",", 
               RowBox[{"Part", "[", 
                RowBox[{"r", ",", "5"}], "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"idx", "[", "lhs", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"idx", "[", 
                RowBox[{"Part", "[", 
                 RowBox[{"r", ",", "5"}], "]"}], "]"}], "]"}], "]"}], " ", "+=",
              " ", "prob"}]}], "]"}]}]}], " ", "\[IndentingNewLine]", 
        "\t\t\t\t\t", "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{"Scan", "[", 
       RowBox[{"updateA", ",", "rules"}], "]"}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t\t", 
      RowBox[{"Return", "[", "a", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.521067433958193*^9, 3.521067480629919*^9}, {
  3.521067594786831*^9, 3.5210676226495037`*^9}, {3.521067664039221*^9, 
  3.521067717624651*^9}, {3.52106776703487*^9, 3.521067869159582*^9}, {
  3.521067923521698*^9, 3.5210679516257544`*^9}, {3.521067982167158*^9, 
  3.521068256295389*^9}, {3.521068382251794*^9, 3.521068403551566*^9}, {
  3.521068454131744*^9, 3.5210684869538603`*^9}, {3.52106859573897*^9, 
  3.521068714993072*^9}, {3.521068780048923*^9, 3.521068786610106*^9}, {
  3.52106885766037*^9, 3.521068859260067*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"entropyOfGrammar", "[", "g_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "start", ",", "nonterminals", ",", "terminals", ",", "rules", ",", 
       "idx", ",", "fert", ",", "h", ",", "spectralradius", ",", 
       "everybody"}], "}"}], ",", "\[IndentingNewLine]", 
     "\t\t\t                    ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "g"}], ";", "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{
       RowBox[{"idx", "[", "nt_String", "]"}], " ", ":=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"nonterminals", ",", "nt"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"littleh", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t\t", 
      RowBox[{"fert", " ", "=", " ", 
       RowBox[{"fertilitymatrix", "[", "g", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{"spectralradius", " ", "=", " ", 
       RowBox[{
        RowBox[{"Eigenvalues", "[", "fert", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"spectralradius", " ", ">", " ", "1"}], ",", 
        RowBox[{
        "Print", "[", "\"\<entropyOfGrammar: grammar not consistent\>\"", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\t\t\t\t\t", 
      RowBox[{"everybody", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", "nonterminals", "]"}], "]"}], "-", 
           "fert"}], "]"}], ")"}], " ", ".", " ", "h"}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"everybody", "[", 
           RowBox[{"[", 
            RowBox[{"idx", "[", "start", "]"}], "]"}], "]"}], ",", 
          "everybody"}], "}"}], "]"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\t\t\t\t\t", 
      RowBox[{"everybody", "[", 
       RowBox[{"[", 
        RowBox[{"idx", "[", "start", "]"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.521068927478796*^9, 3.521068997063561*^9}, {
  3.521069089232115*^9, 3.521069390506503*^9}, {3.521069499561411*^9, 
  3.5210695073808804`*^9}, {3.5210695594816303`*^9, 3.521069621548584*^9}, {
  3.521069708342515*^9, 3.521069720749278*^9}, {3.521070174948873*^9, 
  3.5210701861123037`*^9}, {3.5212475165391483`*^9, 3.5212475317529984`*^9}, {
  3.52127856404617*^9, 3.521278569265682*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["End - to - End", "Section",
 CellChangeTimes->{{3.5213195187848387`*^9, 3.521319543317102*^9}, 
   3.521319578908976*^9, 3.521319771947098*^9}],

Cell[TextData[{
 StyleBox[" ah-singular.m",
  FontFamily->"Courier"],
 " is a ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " list of strings encoding the Keenan Hawkins stimuli from their 1974 study"
}], "Subsubtitle",
 CellChangeTimes->{{3.521317142501919*^9, 3.521317166835775*^9}, {
   3.521319386731978*^9, 3.521319401375168*^9}, 3.521319463475148*^9, {
   3.5213195138292847`*^9, 3.521319607805811*^9}, {3.521319659659851*^9, 
   3.521319671641014*^9}, {3.521319843356265*^9, 3.521319866520307*^9}}],

Cell[BoxData[
 RowBox[{"<<", "ah-singular.m", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "keenanhawkins", " ", "with", " ", "all", " ", "NPs", " ", "made", " ", 
    "singular"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5210698395909843`*^9, 3.521069863894834*^9}, {
   3.521069925943438*^9, 3.5210701069196167`*^9}, {3.521070145826118*^9, 
   3.521070238897768*^9}, {3.521070288207314*^9, 3.5210703887510366`*^9}, {
   3.521070464695272*^9, 3.521070470054871*^9}, {3.521070524424835*^9, 
   3.521070524750812*^9}, {3.52107070763085*^9, 3.521070708196704*^9}, {
   3.521071054440201*^9, 3.521071081409778*^9}, {3.521071122758716*^9, 
   3.521071126478445*^9}, {3.521110899821299*^9, 3.521110950061779*^9}, {
   3.521111044775882*^9, 3.521111053978692*^9}, {3.521111090803322*^9, 
   3.5211111313673058`*^9}, {3.521228530125078*^9, 3.5212285315968018`*^9}, {
   3.521229499822503*^9, 3.521229501441409*^9}, {3.5212300547390547`*^9, 
   3.5212300596656513`*^9}, {3.521230111767807*^9, 3.5212301493089657`*^9}, {
   3.521232691968664*^9, 3.5212326991235743`*^9}, {3.5212331368181*^9, 
   3.5212331375695868`*^9}, {3.5212416374547243`*^9, 3.521241666446217*^9}, 
   3.5212438711085043`*^9, 3.521294877755548*^9, {3.521319386731803*^9, 
   3.52131940137494*^9}, 3.521319463474987*^9, {3.5213195138290873`*^9, 
   3.521319607805608*^9}, 3.52131972884424*^9}],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox[" entOfGrammarFile",
  FontFamily->"Courier"],
 " computes the entropy of a grammar after first renormalizing using all of \
the function defined above, especially CalculateZ"
}], "Subsubtitle",
 CellChangeTimes->{{3.521317142501919*^9, 3.521317166835775*^9}, {
   3.521319386731978*^9, 3.521319401375168*^9}, 3.521319463475148*^9, {
   3.5213195138292847`*^9, 3.521319607805811*^9}, {3.521319659659851*^9, 
   3.521319671641014*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"entOfGrammarFile", "[", "filename_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "commandline", ",", "grammar", ",", "graph", ",", "SCCs", ",", "z", ",",
        "gprime", ",", "Hstart", ",", "t1", ",", "t2", ",", "t3", ",", "t4", 
       ",", "t5", ",", "t6", ",", "t7"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"commandline", " ", "=", " ", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<!sed -e 's/\\\" \\\"/EMPTY/' <\>\"", ",", "filename"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", " ", "=", " ", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"grammar", " ", "=", " ", 
       RowBox[{"ChartToGrammar", "[", 
        RowBox[{"Import", "[", 
         RowBox[{"commandline", ",", "\"\<Table\>\""}], "]"}], "]"}]}], ";", 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "add", " ", "regexp", " ", "here", " ", "for", " ", "custom", " ", 
        "start", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"t2", " ", "=", " ", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"graph", "=", 
       RowBox[{"GraphProjection", "[", "grammar", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t3", " ", "=", " ", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SCCs", " ", "=", " ", 
       RowBox[{"getSCCs", "[", "graph", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t4", " ", "=", " ", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"z", " ", "=", " ", 
       RowBox[{"CalculateZ", "[", 
        RowBox[{"grammar", ",", "graph", ",", "SCCs"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t5", " ", "=", " ", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gprime", " ", "=", " ", 
       RowBox[{"TiltGrammar", "[", 
        RowBox[{"grammar", ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t6", " ", "=", " ", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Hstart", " ", "=", " ", 
       RowBox[{"entropyOfGrammar", "[", "gprime", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t7", " ", "=", " ", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Sow", "[", 
       RowBox[{"t7", "-", "t1"}], "]"}], ";", 
      RowBox[{"Sow", "[", 
       RowBox[{"t2", "-", "t1"}], "]"}], ";", 
      RowBox[{"Sow", "[", 
       RowBox[{"t3", "-", "t2"}], "]"}], ";", 
      RowBox[{"Sow", "[", 
       RowBox[{"t4", "-", "t3"}], "]"}], ";", 
      RowBox[{"Sow", "[", 
       RowBox[{"t5", "-", "t4"}], "]"}], ";", 
      RowBox[{"Sow", "[", 
       RowBox[{"t6", "-", "t5"}], "]"}], ";", 
      RowBox[{"Sow", "[", 
       RowBox[{"t7", "-", "t6"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<vertices\>\"", ",", 
          RowBox[{"V", "[", "graph", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<edges\>\"", ",", 
          RowBox[{"M", "[", "graph", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"t7", "-", "t0"}], ",", "\"\< seconds\>\""}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Hstart", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5210698395909843`*^9, 3.521069863894834*^9}, {
   3.521069925943438*^9, 3.5210701069196167`*^9}, {3.521070145826118*^9, 
   3.521070238897768*^9}, {3.521070288207314*^9, 3.5210703887510366`*^9}, {
   3.521070464695272*^9, 3.521070470054871*^9}, {3.521070524424835*^9, 
   3.521070524750812*^9}, {3.52107070763085*^9, 3.521070708196704*^9}, {
   3.521071054440201*^9, 3.521071081409778*^9}, {3.521071122758716*^9, 
   3.521071126478445*^9}, {3.521110899821299*^9, 3.521110950061779*^9}, {
   3.521111044775882*^9, 3.521111053978692*^9}, {3.521111090803322*^9, 
   3.5211111313673058`*^9}, {3.521228530125078*^9, 3.5212285315968018`*^9}, {
   3.521229499822503*^9, 3.521229501441409*^9}, {3.5212300547390547`*^9, 
   3.5212300596656513`*^9}, {3.521230111767807*^9, 3.5212301493089657`*^9}, {
   3.521232691968664*^9, 3.5212326991235743`*^9}, {3.5212331368181*^9, 
   3.5212331375695868`*^9}, {3.5212416374547243`*^9, 3.521241720403041*^9}, 
   3.521243871112418*^9, {3.521247286872305*^9, 3.521247376164542*^9}, {
   3.521288981945671*^9, 3.521289011823636*^9}, {3.5212890674761543`*^9, 
   3.521289102435152*^9}, 3.521294877759672*^9, 3.521299780493725*^9, {
   3.521319386732151*^9, 3.52131940137539*^9}, 3.521319463475306*^9, {
   3.521319513829475*^9, 3.5213196078060093`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The purpose of ",
 StyleBox["sccsOfSentence",
  FontFamily->"Courier"],
 " is to count the number of \"interesting\"( ie non - singleton) SCCs in the \
chart corresponding to each prefix of a given sentence."
}], "Subsubtitle",
 CellChangeTimes->{{3.521316978043276*^9, 3.521317007790205*^9}, {
   3.521317132099325*^9, 3.5213171348103647`*^9}, {3.521319386732327*^9, 
   3.521319401375622*^9}, 3.521319463475465*^9, {3.5213195138296833`*^9, 
   3.521319607806211*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sccsOfSentence", "[", 
   RowBox[{"unconditionedgrammarfilename_", ",", "words_List"}], "]"}], ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "cleanupEpsilon", "=", " ", "\"\<sed -e 's/\\\" \\\"/EMPTY/'\>\""}], 
      ",", "prefixes", ",", "interdigitate", ",", "grindout", ",", "grammar", 
      ",", "sccs", ",", "total", ",", "interesting", ","}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"prefixes", "[", "x_List", "]"}], " ", ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Take", "[", 
          RowBox[{"x", ",", "#"}], "]"}], ")"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "x", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"interdigitate", "[", 
       RowBox[{"a_String", ",", "b_String"}], "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "\"\<\>\""}], ",", "b", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"b", "\[Equal]", "\"\<\>\""}], ",", "a", ",", 
          RowBox[{"a", "<>", "\"\< \>\"", "<>", "b"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"grindout", "[", 
       RowBox[{"initialfragment_List", ",", "sequencenumber_List"}], "]"}], 
      " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cmd", ",", "fragstring", ",", "dest"}], "}"}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"fragstring", "=", " ", 
          RowBox[{"Fold", "[", 
           RowBox[{"interdigitate", ",", "\"\<\>\"", ",", "initialfragment"}],
            "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"dest", "=", " ", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<prefix\>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"First", "[", "sequencenumber", "]"}], "]"}], ",", 
            "\"\<.chart\>\""}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"cmd", "  ", "=", " ", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
           "\"\<./mcfg_nt \>\"", " ", ",", "unconditionedgrammarfilename", 
            ",", "\"\< -p \\\"\>\"", ",", "fragstring", ",", 
            "\"\<\\\" | \>\"", ",", "cleanupEpsilon", ",", "\"\< > \>\"", ",",
             "dest"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<trying: \>\"", ",", "cmd"}], "]"}], ">>>", 
            "\"\<grindout.log\>\""}], ";"}], "*)"}], "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<trying: \>\"", ",", "cmd"}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Run", "[", "cmd", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"grammar", "=", 
          RowBox[{"ChartToGrammar", "[", 
           RowBox[{"Import", "[", 
            RowBox[{"dest", ",", "\"\<Table\>\""}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"sccs", " ", "=", " ", 
          RowBox[{"getSCCs", "[", 
           RowBox[{"GraphProjection", "[", "grammar", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"total", " ", "=", " ", 
          RowBox[{"Length", "[", "sccs", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"interesting", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Length", "/@", " ", "sccs"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[NotEqual]", "1"}], ")"}], "&"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"total", ",", "interesting"}], "}"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{"grindout", ",", 
        RowBox[{"prefixes", "[", "words", "]"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.521230223778779*^9, 3.521230285891438*^9}, {
   3.521230506137141*^9, 3.521230508804079*^9}, {3.521230638725775*^9, 
   3.521230730905217*^9}, {3.521230761108287*^9, 3.521230773396546*^9}, {
   3.521230871217618*^9, 3.521230939366537*^9}, {3.5212311020863028`*^9, 
   3.521231115220996*^9}, {3.521231157751893*^9, 3.52123122469064*^9}, {
   3.521231268171501*^9, 3.521231330746172*^9}, {3.5212314084216413`*^9, 
   3.521231733931239*^9}, {3.5212317796616297`*^9, 3.521231785916037*^9}, {
   3.521231869832955*^9, 3.52123211537459*^9}, {3.521232146653811*^9, 
   3.521232147794187*^9}, {3.521232183707019*^9, 3.521232272962346*^9}, {
   3.521232308116851*^9, 3.5212324436408377`*^9}, {3.521232518528755*^9, 
   3.521232565350956*^9}, {3.521232930017671*^9, 3.521232986293044*^9}, {
   3.521233026482492*^9, 3.5212330464330378`*^9}, {3.521233208098222*^9, 
   3.5212332426428337`*^9}, {3.521242904526806*^9, 3.521242982765984*^9}, 
   3.5212438711166687`*^9, {3.521247892316291*^9, 3.521247935687792*^9}, {
   3.521248046311225*^9, 3.521248060981613*^9}, {3.521280044502046*^9, 
   3.521280084278262*^9}, {3.521290202453122*^9, 3.521290208941087*^9}, 
   3.521294877829378*^9, {3.521315892863329*^9, 3.521315895655286*^9}, {
   3.5213159549046288`*^9, 3.5213160823204536`*^9}, {3.521316194154498*^9, 
   3.5213163148900967`*^9}, {3.521316390093478*^9, 3.521316406459783*^9}, {
   3.521316453926993*^9, 3.5213164542547007`*^9}, {3.52131660609785*^9, 
   3.521316609386064*^9}, {3.521319386732502*^9, 3.521319401375821*^9}, 
   3.521319463475625*^9, {3.521319513829874*^9, 3.521319607806408*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sccsOfSentence", "[", 
  RowBox[{"\"\<grammars/wmcfg/larsonian1.wmcfg\>\"", ",", 
   RowBox[{"keenanhawkins", "[", 
    RowBox[{"[", "8", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.521316321640366*^9, 3.521316365130529*^9}, {
   3.521316467812645*^9, 3.521316468442376*^9}, {3.521316714140441*^9, 
   3.521316714322221*^9}, {3.5213193867326727`*^9, 3.5213194013760157`*^9}, 
   3.5213194634757767`*^9, {3.521319513830061*^9, 3.5213196078066*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he\\\" | sed -e 's/\\\" \\\"/EMPTY/' > prefix1.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he\" | sed -e 's/\" \
\"/EMPTY/' > prefix1.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.5213167149393387`*^9, {3.52131938673287*^9, 3.521319401376987*^9}, 
   3.521319463475916*^9, {3.52131951383027*^9, 3.521319607806815*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember\\\" | sed -e 's/\\\" \\\"/EMPTY/' > prefix2.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember\" | sed -e 's/\
\" \"/EMPTY/' > prefix2.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.521316716516596*^9, {3.521319386733068*^9, 3.5213194013772078`*^9}, 
   3.52131946347605*^9, {3.521319513830483*^9, 3.521319607807032*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed\\\" | sed -e 's/\\\" \\\"/EMPTY/' > prefix3.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed\" | sed -e \
's/\" \"/EMPTY/' > prefix3.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.521316718101541*^9, {3.521319386733247*^9, 3.521319401377494*^9}, 
   3.521319463476185*^9, {3.521319513830694*^9, 3.52131960780725*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that\\\" | sed -e 's/\\\" \\\"/EMPTY/' > \
prefix4.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that\" | \
sed -e 's/\" \"/EMPTY/' > prefix4.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.52131671970686*^9, {3.521319386733425*^9, 3.521319401377718*^9}, 
   3.521319463476318*^9, {3.521319513830904*^9, 3.521319607807466*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the\\\" | sed -e 's/\\\" \\\"/EMPTY/' > \
prefix5.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the\" \
| sed -e 's/\" \"/EMPTY/' > prefix5.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.521316721252303*^9, {3.521319386733603*^9, 3.521319401377935*^9}, 
   3.521319463476451*^9, {3.521319513831113*^9, 3.5213196078076897`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the sweet\\\" | sed -e 's/\\\" \\\"/EMPTY/' > \
prefix6.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the \
sweet\" | sed -e 's/\" \"/EMPTY/' > prefix6.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.521316722995319*^9, {3.521319386733781*^9, 3.521319401378154*^9}, 
   3.521319463476584*^9, {3.521319513831299*^9, 3.521319607807889*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the sweet which\\\" | sed -e 's/\\\" \\\"/EMPTY/' > \
prefix7.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the \
sweet which\" | sed -e 's/\" \"/EMPTY/' > prefix7.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.521316725629119*^9, {3.5213193867339582`*^9, 3.5213194013783712`*^9}, 
   3.521319463476717*^9, {3.521319513831484*^9, 3.5213196078080807`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the sweet which David\\\" | sed -e 's/\\\" \
\\\"/EMPTY/' > prefix8.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the \
sweet which David\" | sed -e 's/\" \"/EMPTY/' > prefix8.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.521316728241755*^9, {3.5213193867341337`*^9, 3.5213194013785877`*^9}, 
   3.52131946347685*^9, {3.521319513831669*^9, 3.521319607808275*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the sweet which David give\\\" | sed -e 's/\\\" \
\\\"/EMPTY/' > prefix9.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the \
sweet which David give\" | sed -e 's/\" \"/EMPTY/' > prefix9.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.5213167310892973`*^9, {3.521319386734311*^9, 3.521319401378821*^9}, 
   3.521319463476983*^9, {3.521319513831854*^9, 3.5213196078084784`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the sweet which David give -ed\\\" | sed -e 's/\\\" \
\\\"/EMPTY/' > prefix10.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the \
sweet which David give -ed\" | sed -e 's/\" \"/EMPTY/' > prefix10.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.521316733598338*^9, {3.521319386734489*^9, 3.5213194013790407`*^9}, 
   3.5213194634771147`*^9, {3.521319513832038*^9, 3.52131960780867*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the sweet which David give -ed Sally\\\" | sed -e \
's/\\\" \\\"/EMPTY/' > prefix11.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the \
sweet which David give -ed Sally\" | sed -e 's/\" \"/EMPTY/' > \
prefix11.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.521316736071385*^9, {3.521319386734666*^9, 3.521319401379262*^9}, 
   3.5213194634772453`*^9, {3.521319513832222*^9, 3.5213196078095922`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the sweet which David give -ed Sally be\\\" | sed -e \
's/\\\" \\\"/EMPTY/' > prefix12.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the \
sweet which David give -ed Sally be\" | sed -e 's/\" \"/EMPTY/' > \
prefix12.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.521316738978359*^9, {3.5213193867348423`*^9, 3.521319401379485*^9}, 
   3.521319463477377*^9, {3.521319513832406*^9, 3.5213196078097897`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the sweet which David give -ed Sally be -ed\\\" | \
sed -e 's/\\\" \\\"/EMPTY/' > prefix13.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the \
sweet which David give -ed Sally be -ed\" | sed -e 's/\" \"/EMPTY/' > \
prefix13.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.521316741347118*^9, {3.521319386735018*^9, 3.5213194013797083`*^9}, 
   3.521319463477508*^9, {3.52131951383259*^9, 3.52131960780998*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the sweet which David give -ed Sally be -ed a\\\" | \
sed -e 's/\\\" \\\"/EMPTY/' > prefix14.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the \
sweet which David give -ed Sally be -ed a\" | sed -e 's/\" \"/EMPTY/' > \
prefix14.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.52131674373482*^9, {3.521319386735195*^9, 3.521319401379928*^9}, 
   3.5213194634776382`*^9, {3.521319513832773*^9, 3.521319607810184*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trying: \"\>", 
   "\[InvisibleSpace]", "\<\"./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \
\\\"he remember -ed that the sweet which David give -ed Sally be -ed a \
treat\\\" | sed -e 's/\\\" \\\"/EMPTY/' > prefix15.chart\"\>"}],
  SequenceForm[
  "trying: ", 
   "./mcfg_nt grammars/wmcfg/larsonian1.wmcfg -p \"he remember -ed that the \
sweet which David give -ed Sally be -ed a treat\" | sed -e 's/\" \"/EMPTY/' > \
prefix15.chart"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.52131637897843*^9, 3.521316446715373*^9, 3.5213166164562597`*^9, 
   3.52131674623277*^9, {3.521319386735372*^9, 3.521319401380148*^9}, 
   3.521319463477771*^9, {3.521319513832958*^9, 3.521319607810368*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"606", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"612", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"615", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"607", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"653", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"846", ",", 
     RowBox[{"{", 
      RowBox[{"332", ",", "5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"847", ",", 
     RowBox[{"{", 
      RowBox[{"332", ",", "5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"896", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"773", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"778", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"748", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"697", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"702", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"697", ",", 
     RowBox[{"{", "332", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"170", ",", 
     RowBox[{"{", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.521316366375394*^9, 3.521316382764443*^9}, 
   3.521316450115303*^9, 3.521316643320356*^9, 3.521316747223919*^9, {
   3.521319386735538*^9, 3.5213194013803673`*^9}, 3.521319463477895*^9, {
   3.521319513833132*^9, 3.521319607810527*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["entOfSentence",
  FontFamily->"Courier"],
 " calculates the entropy of each prefix of a given sentence using a supplied \
unconditioned grammar. It does this by running the mcfg prefix parser, then \
calling entOfGrammarFile on the parser' s output."
}], "Subsubtitle",
 CellChangeTimes->{{3.521317037327656*^9, 3.521317083780078*^9}, {
   3.5213193867356863`*^9, 3.5213194013805447`*^9}, 3.521319463478009*^9, {
   3.521319513833291*^9, 3.5213195507719307`*^9}, {3.5213196005540667`*^9, 
   3.521319607810677*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"entOfSentence", "[", 
   RowBox[{"unconditionedgrammarfilename_", ",", "words_List"}], "]"}], ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "cleanupEpsilon", "=", " ", "\"\<sed -e 's/\\\" \\\"/EMPTY/'\>\""}], 
      ",", "prefixes", ",", "interdigitate", ",", "grindout", ",", 
      "entropyvalue", ",", "timestats"}], "}"}], ",", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"prefixes", "[", "x_List", "]"}], " ", ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Take", "[", 
          RowBox[{"x", ",", "#"}], "]"}], ")"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "x", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"interdigitate", "[", 
       RowBox[{"a_String", ",", "b_String"}], "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "\"\<\>\""}], ",", "b", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"b", "\[Equal]", "\"\<\>\""}], ",", "a", ",", 
          RowBox[{"a", "<>", "\"\< \>\"", "<>", "b"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"grindout", "[", 
       RowBox[{"initialfragment_List", ",", "sequencenumber_List"}], "]"}], 
      " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cmd", ",", "fragstring", ",", "dest"}], "}"}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"fragstring", "=", " ", 
          RowBox[{"Fold", "[", 
           RowBox[{"interdigitate", ",", "\"\<\>\"", ",", "initialfragment"}],
            "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"dest", "=", " ", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<prefix\>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"First", "[", "sequencenumber", "]"}], "]"}], ",", 
            "\"\<.chart\>\""}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"cmd", "  ", "=", " ", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
           "\"\<./mcfg_nt \>\"", " ", ",", "unconditionedgrammarfilename", 
            ",", "\"\< -p \\\"\>\"", ",", "fragstring", ",", 
            "\"\<\\\" | \>\"", ",", "cleanupEpsilon", ",", "\"\< > \>\"", ",",
             "dest"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<trying: \>\"", ",", "cmd"}], "]"}], ">>>", 
            "\"\<grindout.log\>\""}], ";"}], "*)"}], "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<trying: \>\"", ",", "cmd"}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Run", "[", "cmd", "]"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"entropyvalue", ",", "timestats"}], "}"}], "=", 
          RowBox[{"Reap", "[", 
           RowBox[{"entOfGrammarFile", "[", "dest", "]"}], "]"}]}], ";", " ", 
         
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"timestats", ">>>", " ", "\"\<grindout.log\>\""}], ";"}], 
          "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Print", "[", "timestats", "]"}], ";", "\[IndentingNewLine]",
          "\t\t", 
         RowBox[{"Return", "[", 
          RowBox[{"entOfGrammarFile", "[", "dest", "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"MapIndexed", "[", 
         RowBox[{"grindout", ",", 
          RowBox[{"prefixes", "[", "words", "]"}]}], "]"}], ",", 
        RowBox[{
        "entOfGrammarFile", "[", "unconditionedgrammarfilename", "]"}]}], 
       "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.521230223778779*^9, 3.521230285891438*^9}, {
   3.521230506137141*^9, 3.521230508804079*^9}, {3.521230638725775*^9, 
   3.521230730905217*^9}, {3.521230761108287*^9, 3.521230773396546*^9}, {
   3.521230871217618*^9, 3.521230939366537*^9}, {3.5212311020863028`*^9, 
   3.521231115220996*^9}, {3.521231157751893*^9, 3.52123122469064*^9}, {
   3.521231268171501*^9, 3.521231330746172*^9}, {3.5212314084216413`*^9, 
   3.521231733931239*^9}, {3.5212317796616297`*^9, 3.521231785916037*^9}, {
   3.521231869832955*^9, 3.52123211537459*^9}, {3.521232146653811*^9, 
   3.521232147794187*^9}, {3.521232183707019*^9, 3.521232272962346*^9}, {
   3.521232308116851*^9, 3.5212324436408377`*^9}, {3.521232518528755*^9, 
   3.521232565350956*^9}, {3.521232930017671*^9, 3.521232986293044*^9}, {
   3.521233026482492*^9, 3.5212330464330378`*^9}, {3.521233208098222*^9, 
   3.5212332426428337`*^9}, {3.521242904526806*^9, 3.521242982765984*^9}, 
   3.5212438711166687`*^9, {3.521247892316291*^9, 3.521247935687792*^9}, {
   3.521248046311225*^9, 3.521248060981613*^9}, {3.521280044502046*^9, 
   3.521280084278262*^9}, {3.521290202453122*^9, 3.521290208941087*^9}, 
   3.521294877829378*^9, {3.521319386735841*^9, 3.52131940138072*^9}, 
   3.521319463478128*^9, {3.521319513833461*^9, 3.521319550772126*^9}, {
   3.521319600554237*^9, 3.521319607810829*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["reductions",
  FontFamily->"Courier"],
 " is the notion of reduction in the Entropy Reduction Hyp"
}], "Subsubtitle",
 CellChangeTimes->{{3.521317019842511*^9, 3.521317033409377*^9}, {
   3.521319386735989*^9, 3.521319401380896*^9}, 3.5213194634782476`*^9, {
   3.521319513833622*^9, 3.521319550772325*^9}, {3.521319600554412*^9, 
   3.521319607810985*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"reductions", "[", "l_List", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Max", "[", 
     RowBox[{"0", ",", "#"}], "]"}], "&"}], "/@", " ", 
   RowBox[{"-", 
    RowBox[{"Differences", "[", "l", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.521243746875893*^9, 3.521243765129139*^9}, 
   3.5212438711179132`*^9, 3.5212948778306828`*^9, {3.5213193867361097`*^9, 
   3.52131940138107*^9}, 3.521319463478368*^9, {3.5213195138337708`*^9, 
   3.521319550772519*^9}, {3.5213196005545797`*^9, 3.521319607811137*^9}}]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
CellGrouping->Manual,
WindowSize->{974, 850},
WindowMargins->{{8, Automatic}, {0, Automatic}},
ShowSelection->True,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 6, \
2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 186, 4, 26, "Subsubtitle"],
Cell[CellGroupData[{
Cell[768, 28, 152, 2, 67, "Section"],
Cell[923, 32, 443, 10, 27, "Input"],
Cell[1369, 44, 507, 12, 27, "Input"],
Cell[CellGroupData[{
Cell[1901, 60, 320, 9, 27, "Input"],
Cell[2224, 71, 604, 12, 40, "Message"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2877, 89, 174, 2, 67, "Section"],
Cell[3054, 93, 8898, 194, 592, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[11989, 292, 133, 2, 37, "Section"],
Cell[12125, 296, 4026, 93, 283, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[16188, 394, 168, 2, 37, "Section"],
Cell[16359, 398, 1846, 46, 178, "Input"],
Cell[18208, 446, 3012, 78, 178, "Input"],
Cell[21223, 526, 1664, 43, 163, "Input"],
Cell[22890, 571, 1854, 48, 118, "Input"],
Cell[24747, 621, 1523, 30, 88, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[26307, 656, 115, 1, 37, "Section"],
Cell[26425, 659, 20934, 443, 1153, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[47396, 1107, 145, 2, 37, "Section"],
Cell[47544, 1111, 5476, 124, 430, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[53057, 1240, 129, 2, 37, "Section"],
Cell[53189, 1244, 2167, 50, 193, "Input"],
Cell[55359, 1296, 4258, 99, 253, "Input"],
Cell[59620, 1397, 2981, 70, 208, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[62638, 1472, 149, 2, 37, "Section"],
Cell[62790, 1476, 512, 11, 26, "Subsubtitle"],
Cell[63305, 1489, 1359, 21, 27, "Input"],
Cell[CellGroupData[{
Cell[64689, 1514, 460, 9, 43, "Subsubtitle"],
Cell[65152, 1525, 5019, 102, 373, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70208, 1632, 487, 10, 43, "Subsubtitle"],
Cell[70698, 1644, 6130, 127, 418, "Input"],
Cell[CellGroupData[{
Cell[76853, 1775, 482, 8, 27, "Input"],
Cell[CellGroupData[{
Cell[77360, 1787, 603, 13, 20, "Print"],
Cell[77966, 1802, 622, 13, 20, "Print"],
Cell[78591, 1817, 628, 13, 20, "Print"],
Cell[79222, 1832, 640, 14, 20, "Print"],
Cell[79865, 1848, 651, 14, 20, "Print"],
Cell[80519, 1864, 661, 14, 36, "Print"],
Cell[81183, 1880, 679, 14, 36, "Print"],
Cell[81865, 1896, 688, 14, 36, "Print"],
Cell[82556, 1912, 699, 14, 36, "Print"],
Cell[83258, 1928, 708, 14, 36, "Print"],
Cell[83969, 1944, 723, 15, 36, "Print"],
Cell[84695, 1961, 729, 15, 36, "Print"],
Cell[85427, 1978, 733, 15, 36, "Print"],
Cell[86163, 1995, 738, 15, 36, "Print"],
Cell[86904, 2012, 748, 15, 36, "Print"]
}, Open  ]],
Cell[87667, 2030, 1695, 53, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89399, 2088, 542, 10, 43, "Subsubtitle"],
Cell[89944, 2100, 5523, 118, 328, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95504, 2223, 384, 8, 26, "Subsubtitle"],
Cell[95891, 2233, 548, 12, 27, "Input"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
