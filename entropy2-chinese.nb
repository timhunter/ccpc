(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    199578,       4737]
NotebookOptionsPosition[    192774,       4541]
NotebookOutlinePosition[    193174,       4559]
CellTagsIndexPosition[    193131,       4556]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Adapted from Jiwon Yun\[CloseCurlyQuote]s notebook, \"entropy\"\
\>", "Subsubtitle",
 CellChangeTimes->{{3.521046126505453*^9, 3.521046181479065*^9}, 
   3.521047276315086*^9}],

Cell[CellGroupData[{

Cell["Preliminary", "Section",
 CellChangeTimes->{{3.5210508405518312`*^9, 3.5210508497658653`*^9}, 
   3.5211105377011147`*^9, 3.5213195845808067`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Chen", "'"}], "s", " ", "laptop"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.521041240635828*^9, 3.52104125008845*^9}, 
   3.521047276320116*^9, 3.521050849766611*^9, 3.521110537701565*^9, {
   3.521110577811446*^9, 3.521110585020406*^9}, 3.521319584581023*^9, {
   3.522057473564556*^9, 3.52205750297887*^9}, {3.52205878851546*^9, 
   3.5220587932485332`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Off", "[", 
    StyleBox[
     RowBox[{"Graph", "::", "optx"}], "MessageName"], "]"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Turn", " ", "off", " ", "warnings", " ", "about", " ", "graph", " ", 
    "options"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.521041824893127*^9, 3.521041827901721*^9}, 
   3.521047276317972*^9, 3.521050849766397*^9, 3.521110537701359*^9, {
   3.521110577811822*^9, 3.521110585021237*^9}, 3.5213195845812073`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "Combinatorica`", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"was", " ", 
     RowBox[{"<<", "DiscreteMath`Combinatorica`"}]}], ";"}], "  ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{
  3.521110537701769*^9, {3.521110577811635*^9, 3.5211105919804497`*^9}, 
   3.52131958458139*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "compat"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Combinatorica Graph and Permutations functionality has \
been superseded by preloaded functionaliy. The package now being loaded may \
conflict with this. Please see the Compatibility Guide for details.\"\>"}]], \
"Message", "MSG",
 CellChangeTimes->{3.521621956520191*^9, 3.521622590903119*^9, 
  3.5216230268565407`*^9, 3.5216237325970507`*^9, 3.521627821542341*^9, 
  3.521628502236227*^9, 3.52162907175079*^9, 3.521629120102004*^9, 
  3.5216312025656147`*^9, 3.521726121169017*^9, 3.521808271710466*^9, 
  3.521808980884643*^9, 3.5218196517475157`*^9, 3.521872940723523*^9, 
  3.5218908866896*^9, 3.521992087902547*^9, 3.5220578315538282`*^9, 
  3.522058801287217*^9}]
}, Open  ]],

Cell["\<\
I increased WorkingPrecision in CalculateZ to avoid rounding off some very \
small Z values to zero, which was happening in the 6th sentence of the K-H \
stimuli. Turn off the complaining about how that FindRoot call is using \
arguments with lower precision than that. Also turn off warnings about line \
search.\
\>", "Subsubtitle",
 CellChangeTimes->{{3.521317037327656*^9, 3.521317083780078*^9}, {
   3.5213193867356863`*^9, 3.5213194013805447`*^9}, 3.521319463478009*^9, {
   3.521319513833291*^9, 3.5213195507719307`*^9}, {3.5213196005540667`*^9, 
   3.521319607810677*^9}, 3.521474730469139*^9, {3.521545247032642*^9, 
   3.521545334719014*^9}, {3.5215463820708113`*^9, 3.521546394668632*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"FindRoot", "::", "precw"}], "]"}], ";", " ", 
  RowBox[{"Off", "[", 
   RowBox[{"FindRoot", "::", "bddir"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.5215451823240967`*^9, {3.521546296641974*^9, 3.521546296743299*^9}, {
   3.521546370416049*^9, 3.52154637451829*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Normalize Grammar", "Section",
 CellChangeTimes->{{3.521050665803228*^9, 3.521050697003292*^9}, {
   3.521050778363489*^9, 3.521050807825485*^9}, 3.521319584581579*^9}],

Cell[TextData[{
 "note that this function does ",
 StyleBox["not",
  FontSlant->"Italic"],
 " divide by the sum of the weights of rules sharing the same LHS; rather it \
preserves the given weight as a Mathematica fraction. This is key for \
deriving Z values other than 1."
}], "Subsubtitle",
 CellChangeTimes->{{3.521320162884633*^9, 3.521320219675064*^9}, {
  3.521320268716888*^9, 3.5213202944213*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChartToGrammar", "[", 
    RowBox[{"ch_", ",", 
     RowBox[{"startsymbolregexp_", " ", ":", "\"\<S.*\>\""}]}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nonterminals", ",", "terminals"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"LhsRhsSymbol", "[", "line_", "]"}], " ", ":=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"Length", "[", "line", "]"}], ",", "\[IndentingNewLine]", 
         "6", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}]}], "}"}], ",", "   ", 
         RowBox[{"(*", " ", 
          RowBox[{"terminal", " ", "line"}], " ", "*)"}], 
         "\[IndentingNewLine]", "7", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}]}], "}"}], ",", "    ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "unary", " ", "with", " ", "string", " ", "rewriting", " ", 
           "recipe"}], " ", "*)"}], "\[IndentingNewLine]", "8", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "7"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"(*", " ", "binary", " ", "*)"}], "\[IndentingNewLine]", "_",
          ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LhsSymbol", "[", "line_", "]"}], " ", ":=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"Length", "[", "line", "]"}], ",", "\[IndentingNewLine]", 
         "6", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Part", "[", 
           RowBox[{"line", ",", "4"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", "7", ",", 
         RowBox[{"{", 
          RowBox[{"Part", "[", 
           RowBox[{"line", ",", "4"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", "8", ",", 
         RowBox[{"{", 
          RowBox[{"Part", "[", 
           RowBox[{"line", ",", "4"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", "_", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kind", "[", "f_", "]"}], " ", ":=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"f", " ", "/@", " ", "ch"}], " ", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nonterminals", " ", "=", " ", 
       RowBox[{"kind", "[", "LhsSymbol", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"terminals", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"kind", "[", "LhsRhsSymbol", "]"}], ",", 
         RowBox[{"kind", "[", "LhsSymbol", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"markup", "[", "line_", "]"}], " ", ":=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"Length", "[", "line", "]"}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"throw", " ", "away", " ", "recipe"}], " ", "*)"}], 
         "\[IndentingNewLine]", "6", ",", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<Preterminal\>\"", ",", 
           FractionBox[
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "1"}], "]"}], 
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "3"}], "]"}]], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "7", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Unary\>\"", ",", 
           FractionBox[
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "1"}], "]"}], 
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "3"}], "]"}]], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "8", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Binary\>\"", ",", 
           FractionBox[
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "1"}], "]"}], 
            RowBox[{"Part", "[", 
             RowBox[{"line", ",", "3"}], "]"}]], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "4"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "6"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"line", ",", "7"}], "]"}]}], "}"}], ",", " ", 
         "\[IndentingNewLine]", "_", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Return", "[", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"nonterminals", ",", 
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"#", ",", 
               RowBox[{"RegularExpression", "[", "startsymbolregexp", "]"}]}],
               "]"}], "&"}]}], "]"}], "]"}], ",", 
         RowBox[{"(*", " ", 
          RowBox[{"assume", " ", 
           RowBox[{"it", "'"}], "s", " ", "the", " ", "first", " ", "one"}], 
          " ", "*)"}], "\[IndentingNewLine]", "              ", 
         "nonterminals", ",", "   ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "second", " ", "and", " ", "third", " ", "components", " ", 
           "constitute", " ", "a", " ", "disjoint", " ", "set", " ", "of", 
           " ", "vertex", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]",
          "              ", "terminals", ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"markup", "/@", "ch"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{"was", " ", ":", " ", 
          RowBox[{"divide", " ", "/@", " ", "vulgar"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5210453616988564`*^9, 3.521045509758832*^9}, {
   3.521045715358897*^9, 3.5210457644487534`*^9}, {3.5210459215826387`*^9, 
   3.521045947548011*^9}, {3.521045981802122*^9, 3.521046026772624*^9}, {
   3.521046057423563*^9, 3.5210460587118883`*^9}, {3.521046209436735*^9, 
   3.5210462620031843`*^9}, {3.521046424560535*^9, 3.521046437502431*^9}, {
   3.521046537202574*^9, 3.521046562580079*^9}, {3.521046886481656*^9, 
   3.5210469504606447`*^9}, 3.5210472763329477`*^9, {3.521047322676434*^9, 
   3.521047417919262*^9}, {3.521047500450485*^9, 3.521047566205042*^9}, {
   3.521047599390966*^9, 3.5210476005019903`*^9}, {3.521047730504223*^9, 
   3.521047730889804*^9}, {3.521047832629524*^9, 3.5210478353071613`*^9}, 
   3.521050807825715*^9, {3.5210595696987543`*^9, 3.521059584971801*^9}, {
   3.521059615405764*^9, 3.521059677094536*^9}, {3.521059783677019*^9, 
   3.521059833273716*^9}, {3.521059863494815*^9, 3.521060248406458*^9}, {
   3.5210602907553577`*^9, 3.5210603065615797`*^9}, {3.521229429665511*^9, 
   3.521229459648827*^9}, {3.521282679198513*^9, 3.521282683065998*^9}, {
   3.521282737823332*^9, 3.521282742824397*^9}, {3.5212828074589043`*^9, 
   3.521282839983326*^9}, {3.5212853969616632`*^9, 3.5212854114860783`*^9}, 
   3.521285902428548*^9, {3.5212885355773077`*^9, 3.5212885741874638`*^9}, {
   3.521294696925201*^9, 3.5212947146195173`*^9}, 3.521294779902314*^9, 
   3.521294864924876*^9, 3.5212949848535957`*^9, {3.521312817265922*^9, 
   3.5213128182490597`*^9}, {3.521312863434371*^9, 3.521312866356287*^9}, {
   3.521312941666684*^9, 3.521312948123149*^9}, {3.52131301190842*^9, 
   3.521313039276209*^9}, {3.521313124434664*^9, 3.521313194541823*^9}, {
   3.521313239050331*^9, 3.5213132663792553`*^9}, {3.521313329431266*^9, 
   3.521313380884316*^9}, {3.521313413168827*^9, 3.521313467645018*^9}, {
   3.521313504007193*^9, 3.521313537729723*^9}, {3.521313578500512*^9, 
   3.521313578968895*^9}, {3.521313667400344*^9, 3.521313715615177*^9}, {
   3.52131379427017*^9, 3.5213138044202538`*^9}, 3.521317882539277*^9, 
   3.521319584581788*^9, {3.521320219830171*^9, 3.5213202377784433`*^9}, 
   3.521992149108419*^9}],

Cell[CellGroupData[{

Cell["This was the procedure from Hale 2003 , 2006", "Subsubtitle",
 CellChangeTimes->{{3.521872907201007*^9, 3.521872922666739*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["LocallyNormalize",
     FontColor->RGBColor[1, 0, 1]], "[", "grammar_List", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "start", ",", "nonterminals", ",", "terminals", ",", "rules", ",", 
       "sums", ",", "both", ",", "divide"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        "=", "grammar"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sums", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Fold", "[", 
           RowBox[{"Plus", ",", "0", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
             RowBox[{"Select", "[", 
              RowBox[{"rules", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "3"}], "]"}], "\[Equal]", "symbol"}], 
                "&"}]}], "]"}]}]}], "]"}]}], "]"}], "/@", "nonterminals"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"both", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"nonterminals", ",", "terminals"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"divide", "[", "wrule_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "originalweight", ",", "nonterminalnumber", ",", "nonterminalsum"}],
           "}"}], ",", 
         RowBox[{
          RowBox[{"originalweight", "=", 
           RowBox[{"Part", "[", 
            RowBox[{"wrule", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"nonterminalnumber", "=", 
           RowBox[{"FromDigits", "[", 
            RowBox[{"FromDigits", "[", 
             RowBox[{"Position", "[", 
              RowBox[{"both", ",", 
               RowBox[{"Part", "[", 
                RowBox[{"wrule", ",", "3"}], "]"}]}], "]"}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"nonterminalsum", "=", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"originalweight", "/", 
              RowBox[{"(", 
               RowBox[{"sums", "[", 
                RowBox[{"[", "nonterminalnumber", "]"}], "]"}], ")"}]}], ",", 
             "MachinePrecision"}], "]"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"become", " ", "machine"}], "-", "precision"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"wrule", ",", 
            RowBox[{"2", "\[Rule]", "nonterminalsum"}]}], "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"start", ",", "nonterminals", ",", "terminals", ",", 
         RowBox[{"(", 
          RowBox[{"divide", "/@", "rules"}], ")"}]}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.521872627317367*^9, 3.521872890798181*^9}, {
  3.5218733148051367`*^9, 3.521873321081225*^9}, {3.521976792728516*^9, 
  3.521976799818046*^9}, {3.521992102672916*^9, 3.521992137545946*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Create Graph Projection", "Section",
 CellChangeTimes->{{3.521050816821314*^9, 3.52105082730166*^9}, 
   3.521319584581963*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GraphProjection", "[", "g_", " ", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "start", ",", "nonterminals", ",", "terminals", ",", "vertices", ",", 
       "rules", ",", "edges", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "g"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"vertices", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"nonterminals", ",", "terminals"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"edges", " ", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"lookup", "[", 
        RowBox[{"rulenum_", ",", "eltnum_"}], "]"}], " ", ":=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"vertices", ",", 
           RowBox[{
            RowBox[{"rules", "[", 
             RowBox[{"[", "rulenum", "]"}], "]"}], "[", 
            RowBox[{"[", "eltnum", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "rules", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t    ", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"rules", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]",
           "\t ", "\"\<Preterminal\>\"", ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"edges", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"lookup", "[", 
               RowBox[{"i", ",", "3"}], "]"}], ",", 
              RowBox[{"lookup", "[", 
               RowBox[{"i", ",", "4"}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", "\"\<Unary\>\"", ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"edges", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"lookup", "[", 
               RowBox[{"i", ",", "3"}], "]"}], ",", 
              RowBox[{"lookup", "[", 
               RowBox[{"i", ",", "4"}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", "\"\<Binary\>\"", ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"edges", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"lookup", "[", 
                RowBox[{"i", ",", "3"}], "]"}], ",", 
               RowBox[{"lookup", "[", 
                RowBox[{"i", ",", "4"}], "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t   ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"edges", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"lookup", "[", 
                RowBox[{"i", ",", "3"}], "]"}], ",", 
               RowBox[{"lookup", "[", 
                RowBox[{"i", ",", "5"}], "]"}]}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", "\t", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FromOrderedPairs", "[", "edges", "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.521046308779977*^9, 3.521046417471559*^9}, {
   3.521046465705617*^9, 3.52104648275665*^9}, 3.5210472763788977`*^9, {
   3.521047623054633*^9, 3.5210476292926483`*^9}, {3.5210478406806717`*^9, 
   3.521048085333157*^9}, {3.5210481224280653`*^9, 3.5210482947953777`*^9}, {
   3.521048342418798*^9, 3.5210486200115347`*^9}, 3.521048832480753*^9, 
   3.52105082730197*^9, 3.521319584582135*^9, {3.521618146508712*^9, 
   3.5216181468743362`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Strongly - Connected Components", "Section",
 CellChangeTimes->{{3.5210508646150627`*^9, 3.5210509050477533`*^9}, 
   3.521234159712307*^9, 3.521319584582305*^9}],

Cell[TextData[{
 "Whereas Cormen, Leisersohn and Rivest give just one, more complicated \
function, I split things up into two different DFS functions. One records \
finishing times while the other keeps track of \"depth first forests\" \
originating from a given start point. Node numbers for vertices in these \
forests are stored on the ",
 StyleBox["lastfound",
  FontFamily->"Courier"],
 " list"
}], "Subsubtitle",
 CellChangeTimes->{{3.521320325931897*^9, 3.521320400078168*^9}, {
  3.521320434686097*^9, 3.521320544328659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ftimeDFSVisit", "[", "u_Integer", "]"}], " ", ":=", 
  "\[IndentingNewLine]", "\t\t", 
  RowBox[{"Module", " ", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "recursive", " ", "helper", " ", "function", " ", "for", " ", 
       "ftimeDFS"}], ",", " ", "below"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"color", "[", 
       RowBox[{"[", "u", "]"}], "]"}], " ", "=", " ", "Gray"}], ";", 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"Scan", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"color", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "White"}], ",", 
            "\[IndentingNewLine]", "\t\t\t\t", 
            RowBox[{
             RowBox[{"ftimeDFSVisit", "[", "#", "]"}], ";", 
             "\[IndentingNewLine]", "\t\t\t\t", 
             RowBox[{
              RowBox[{"color", "[", 
               RowBox[{"[", "u", "]"}], "]"}], "=", "Black"}]}]}], "]"}], ";",
           "\[IndentingNewLine]", "\t\t\t\t   ", 
          RowBox[{"t", "++"}], ";", "\[IndentingNewLine]", "\t\t\t   ", 
          RowBox[{
           RowBox[{"ftime", "[", 
            RowBox[{"[", "u", "]"}], "]"}], "=", " ", "t"}], ";"}], 
         "\[IndentingNewLine]", "\t\t", ")"}], "&"}], ",", 
       RowBox[{"e", "[", 
        RowBox[{"[", "u", "]"}], "]"}]}], "\[IndentingNewLine]", "\t\t\t", 
      "]"}]}]}], "\[IndentingNewLine]", "\t\t", "]"}]}]], "Input",
 CellChangeTimes->{{3.52123380834979*^9, 3.5212338390229673`*^9}, {
   3.5212340668484163`*^9, 3.5212340876523523`*^9}, 3.521234168680027*^9, 
   3.52124157637729*^9, 3.5213195845824757`*^9}],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{"ftimeDFS", "[", "g_Graph", "]"}], " ", ":=", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "function", " ", "computes", " ", "a", " ", "list", " ", 
      "of", " ", "finishing", " ", "times", " ", "in", " ", "a", " ", "DFS", 
      " ", "traversal", " ", "of", " ", 
      RowBox[{"g", ".", " ", "p541"}], " ", "of", " ", "Cormen"}], ",", " ", 
     RowBox[{
      RowBox[{"Leisersohn", " ", "&"}], " ", "Rivest"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"color", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"White", ",", 
          RowBox[{"{", 
           RowBox[{"V", "[", "g", "]"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"t", "=", "0"}], ",", 
       RowBox[{"e", "=", 
        RowBox[{"ToAdjacencyLists", "[", "g", "]"}]}], ",", 
       RowBox[{"ftime", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"V", "[", "g", "]"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"$RecursionLimit", " ", "=", " ", "Infinity"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"for", " ", "each", " ", "vertex"}], ",", " ", 
       RowBox[{"check", " ", "if", " ", 
        RowBox[{"we", "'"}], "ve", " ", "been", " ", "there", " ", "before"}],
        ",", " ", 
       RowBox[{"otherwise", " ", "call", " ", "ftimeDFSVisit"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"color", "[", 
            RowBox[{"[", "vert", "]"}], "]"}], "\[Equal]", "White"}], ",", 
          RowBox[{"ftimeDFSVisit", "[", "vert", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"vert", ",", "1", ",", 
          RowBox[{"V", "[", "g", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"V", "[", "g", "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ftime", "[", 
             RowBox[{"[", "#1", "]"}], "]"}], ">", 
            RowBox[{"ftime", "[", 
             RowBox[{"[", "#2", "]"}], "]"}]}], ")"}], "&"}]}], "]"}], 
       "]"}]}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Descending", " ", "order", " ", "order", " ", "on", " ", "times"}], 
      " ", "=", " ", 
      RowBox[{"Ascending", " ", "whole", " ", "numbers"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.52123380834979*^9, 3.521233815624053*^9}, {
   3.521234028429615*^9, 3.52123406191055*^9}, 3.521234168680298*^9, 
   3.5213195845826387`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"myDFSVisit", "[", "u_Integer", "]"}], " ", ":=", " ", 
   RowBox[{"Module", " ", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "recursive", " ", "helper", " ", "function", " ", "for", " ", 
        "myDFS"}], ",", " ", "below"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"lastfound", ",", "u"}], "]"}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{
       RowBox[{"color", "[", 
        RowBox[{"[", "u", "]"}], "]"}], " ", "=", " ", "Gray"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"Scan", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"color", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "White"}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{"myDFSVisit", "[", "#", "]"}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{"color", "[", 
               RowBox[{"[", "u", "]"}], "]"}], "=", "Black"}]}]}], "]"}], 
          ")"}], "&"}], ",", 
        RowBox[{"e", "[", 
         RowBox[{"[", "u", "]"}], "]"}]}], "\[IndentingNewLine]", "\t\t", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.52123380834979*^9, 3.521233849303899*^9}, {
   3.521234092238488*^9, 3.521234099003668*^9}, 3.521234168680518*^9, 
   3.521319584582803*^9}],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"myDFS", "[", 
     RowBox[{"graph_Graph", ",", "orderedvertices_List"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "same", " ", "algorithm", " ", "but", " ", "keep", " ", "track", " ", 
       "of", " ", "all", " ", "vertices", " ", "in", " ", "what", " ", "CLR", 
       " ", "call", " ", "the", " ", "Depth"}], "-", 
      RowBox[{"first", " ", "Forest"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"color", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"White", ",", 
           RowBox[{"{", 
            RowBox[{"V", "[", "graph", "]"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"e", "=", 
         RowBox[{"ToAdjacencyLists", "[", "graph", "]"}]}], ",", 
        RowBox[{"lastfound", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"$RecursionLimit", " ", "=", " ", "Infinity"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"color", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", " ", "White"}], ",", 
           
           RowBox[{
            RowBox[{"myDFSVisit", "[", "#", "]"}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"SCCs", ",", "lastfound"}], "]"}], ";", 
            RowBox[{"lastfound", "=", 
             RowBox[{"{", "}"}]}]}]}], "]"}], ")"}], "&"}], " ", "/@", " ", 
       "orderedvertices"}]}], "\[IndentingNewLine]", "\t", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.52123380834979*^9, 3.521233849303899*^9}, {
   3.521234107952362*^9, 3.521234168680736*^9}, 3.521319584582965*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getSCCs", "[", "graph_Graph", "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"SCCs", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"myDFS", "[", 
      RowBox[{
       RowBox[{"ReverseEdges", "[", "graph", "]"}], ",", 
       RowBox[{"ftimeDFS", "[", "graph", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", 
      RowBox[{"Reverse", "[", "SCCs", "]"}], "]"}]}]}], "\[IndentingNewLine]",
    "\t", "]"}]}]], "Input",
 CellChangeTimes->{{3.521203983708074*^9, 3.521203997087873*^9}, {
   3.5212040465146713`*^9, 3.521204154075883*^9}, {3.5212042099955673`*^9, 
   3.5212042173062763`*^9}, {3.5212043858620663`*^9, 3.521204389899292*^9}, {
   3.521204441693245*^9, 3.5212044481989393`*^9}, {3.5212045916664057`*^9, 
   3.521204605292041*^9}, {3.521204853517263*^9, 3.521204876868855*^9}, {
   3.521206412706799*^9, 3.5212064505112133`*^9}, {3.521207493615526*^9, 
   3.5212074963433123`*^9}, {3.521208179064296*^9, 3.521208180547997*^9}, {
   3.521208211453815*^9, 3.521208213237515*^9}, {3.521208251008823*^9, 
   3.521208251729707*^9}, {3.52120853237495*^9, 3.521208533062118*^9}, {
   3.521228394334072*^9, 3.521228395813717*^9}, 3.521233406799541*^9, {
   3.521233615686246*^9, 3.521233674420582*^9}, {3.5212337182113028`*^9, 
   3.521233759500865*^9}, 3.521233793419997*^9, 3.521233863737523*^9, 
   3.52131958458313*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Inside Probabilities", "Section",
 CellChangeTimes->{{3.521050924216598*^9, 3.521050936466646*^9}}],

Cell[TextData[{
 "page 146 of Nederhof & Satta (2008) ",
 StyleBox["Computing Partition Functions of PCFG",
  FontVariations->{"Underline"->True}]
}], "Subsubtitle",
 CellChangeTimes->{{3.521320621306513*^9, 3.5213206390523233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CalculateZ", "[", 
    RowBox[{"grammar_", ",", "graphprojection_", ",", "sortedSCCs_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myZ", ",", "start", ",", "nonterminals", ",", "terminals", ",", 
       "rules", ",", "tbl", ",", "vertices", ",", "vertexNumber", ",", 
       "vertexLabel", ",", "eqns", ",", "vars", ",", "zValues"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "grammar"}], ";", "\[IndentingNewLine]", 
      RowBox[{"vertices", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"nonterminals", ",", "terminals"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "is", " ", "the", " ", "ordering", " ", "used", " ", "in",
         " ", "GraphProjection"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "lookup", " ", "table", " ", "maps", " ", "from", " ", "a", " ", 
        "given", " ", "nonterminal", " ", "number", " ", "to", " ", "all", 
        " ", "the", " ", "rules", " ", "sharing", " ", "that", " ", 
        "nonterminal"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tbl", " ", "=", " ", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"nt", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"rules", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "\[Equal]", "nt"}], "&"}]}], 
           "]"}]}], "]"}], "/@", " ", "nonterminals"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Initialize", " ", "the", " ", "list", " ", "of", " ", "Z", " ", 
        "values", " ", "as", " ", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"myZ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"V", "[", "graphprojection", "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"vertexNumber", " ", "\[Rule]", " ", "x_vertexNumber"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XVariable", "[", "n_", "]"}], ":=", 
       RowBox[{"Subscript", "[", 
        RowBox[{"x", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vertexNumber", "[", "v_String", "]"}], " ", ":=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"vertices", ",", "v"}], "]"}], "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"just", " ", "as", " ", "in", " ", "GraphProjection"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vertexLabel", "[", "v_Integer", "]"}], " ", ":=", " ", 
       RowBox[{"vertices", "[", 
        RowBox[{"[", "v", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Recursive", " ", "Function", " ", 
         RowBox[{"Falpha", ":", " ", 
          RowBox[{
           RowBox[{"Falpha", "[", 
            RowBox[{"scc", ",", "rhs"}], "]"}], " ", "calculates", " ", "the",
            " ", "value", " ", "of", " ", "f_a", " ", "for", " ", "the", " ", 
           "given", " ", "scc"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "following", " ", "the", " ", "instruction", " ", "in", " ", 
           "Nederhof"}], " ", "&"}], " ", "Satta", " ", 
         RowBox[{"(", "2008", ")"}], " ", "p", ".146"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"caller", ":", " ", "Expr"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Falpha", "[", 
        RowBox[{"scc_", ",", "rhs_"}], "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"rhs", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "1", "]"}], ",", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", "22", ")"}], " ", "f_epsilon"}], " ", "=", " ", 
              "1"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"terminals", ",", 
                 RowBox[{"vertexLabel", "[", 
                  RowBox[{"First", "[", "rhs", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", 
                RowBox[{"Falpha", "[", 
                 RowBox[{"scc", ",", 
                  RowBox[{"Rest", "[", "rhs", "]"}]}], "]"}], "]"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", "23", ")"}], " ", "f_ab"}], " ", "=", " ", 
                  "f_b"}], ",", " ", 
                 RowBox[{"if", " ", "a", " ", "is", " ", "terminal"}]}], " ", 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"scc", ",", 
                    RowBox[{"First", "[", "rhs", "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Return", "[", 
                   RowBox[{
                    RowBox[{"myZ", "[", 
                    RowBox[{"[", 
                    RowBox[{"First", "[", "rhs", "]"}], "]"}], "]"}], "*", 
                    RowBox[{"Falpha", "[", 
                    RowBox[{"scc", ",", 
                    RowBox[{"Rest", "[", "rhs", "]"}]}], "]"}]}], "]"}], ",", 
                  
                  RowBox[{"(*", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", "24", ")"}], " ", "f_Bb"}], " ", "=", " ", 
                    RowBox[{"Z", 
                    RowBox[{"(", "B", ")"}], " ", "*", " ", "f_b"}]}], ",", 
                    " ", 
                    RowBox[{
                    "if", " ", "B", " ", "is", " ", "not", " ", "a", " ", 
                    "member", " ", "of", " ", "the", " ", "scc"}]}], " ", 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"Return", "[", 
                   RowBox[{
                    RowBox[{"XVariable", "[", 
                    RowBox[{"First", "[", "rhs", "]"}], "]"}], "*", 
                    RowBox[{"Falpha", "[", 
                    RowBox[{"scc", ",", 
                    RowBox[{"Rest", "[", "rhs", "]"}]}], "]"}]}], "]"}]}], 
                 " ", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", "25", ")"}], " ", "f_Bb"}], " ", "=", " ", 
                    RowBox[{"x_i", " ", "*", " ", "f_b"}]}], ",", " ", 
                   RowBox[{
                   "if", " ", "B", " ", "is", " ", "a", " ", "member", " ", 
                    "of", " ", "the", " ", "scc"}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Function", " ", 
         RowBox[{"Expr", ":", " ", 
          RowBox[{
           RowBox[{"Expr", "[", 
            RowBox[{"scc", ",", "vertex"}], "]"}], " ", "gives", " ", "a", 
           " ", "polynomial", " ", "expression", " ", "for", " ", "each", " ",
            "vertex", " ", "in", " ", "the", " ", "scc"}]}]}], ",", " ", 
        RowBox[{"which", " ", "eventually", " ", "comprises", " ", "Eqns"}]}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Expr", "[", 
        RowBox[{"scc_", ",", "vertex_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "myValue", ",", "weight", ",", "rhs", ",", "relevantRules"}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"terminals", ",", 
              RowBox[{"vertexLabel", "[", "vertex", "]"}]}], "]"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"XVariable", "[", "vertex", "]"}]}], "+", "1"}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"otherwise", "..."}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"myValue", "=", 
           RowBox[{"-", 
            RowBox[{"XVariable", "[", "vertex", "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Scan", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"r", ",", 
              RowBox[{
               RowBox[{"weight", " ", "=", " ", 
                RowBox[{"r", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
                "\t", 
               RowBox[{"rhs", " ", "=", " ", 
                RowBox[{"vertexNumber", " ", "/@", " ", 
                 RowBox[{"Switch", "[", 
                  RowBox[{
                   RowBox[{"First", "[", "r", "]"}], ",", "\"\<Binary\>\"", 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", "_", ",", 
                   RowBox[{"{", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "}"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"myValue", "+=", 
                RowBox[{"weight", "*", 
                 RowBox[{"Falpha", "[", 
                  RowBox[{"scc", ",", "rhs"}], "]"}]}]}]}]}], "]"}], ",", 
            RowBox[{"tbl", "[", 
             RowBox[{"[", "vertex", "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "myValue", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Vars", "[", "scc_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "poly", "}"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"poly", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Expr", "[", 
              RowBox[{"scc", ",", "#"}], "]"}], "&"}], "/@", " ", "scc"}]}], 
          ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"Variables", "[", "poly", "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eqns", "[", "scc_", "]"}], ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Expr", "[", 
            RowBox[{"scc", ",", "#"}], "]"}], "\[Equal]", "0"}], ")"}], "&"}],
         "/@", "scc"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"For", " ", "each", " ", "scc"}], ",", " ", 
        RowBox[{
        "calculate", " ", "the", " ", "Z", " ", "value", " ", "of", " ", 
         "all", " ", "the", " ", "vertices", " ", "in", " ", "it"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"myBucket", ",", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "myBucket", "]"}], "\[Equal]", "0"}], ",",
             " ", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Case", " ", "0"}], ":", " ", 
               RowBox[{"the", " ", "scc", " ", "is", " ", "empty"}]}], " ", 
              "\[Rule]", " ", 
              RowBox[{"something", " ", "is", " ", 
               RowBox[{"wrong", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Fail: The scc is empty\>\"", ",", "i"}], "]"}], ",",
             " ", 
            RowBox[{"(*", " ", 
             RowBox[{"Jiwon", ":", " ", 
              RowBox[{"break", " ", 
               RowBox[{"here", "!!"}]}]}], " ", "*)"}], "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Case", " ", "1"}], ":", " ", 
              RowBox[{
              "otherwise", " ", "we", " ", "can", " ", "calculate", " ", 
               "the", " ", "inside", " ", "probability", " ", "of", " ", 
               "each", " ", "node", " ", "in", " ", "the", " ", 
               RowBox[{"scc", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"eqns", "=", 
              RowBox[{"Eqns", "[", "myBucket", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"vars", "=", 
              RowBox[{"Vars", "[", "myBucket", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"zValues", "=", 
              RowBox[{"vars", "/.", 
               RowBox[{"FindRoot", "[", 
                RowBox[{"eqns", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "0"}], "}"}], "&"}], "/@", "vars"}], 
                  ")"}], ",", 
                 RowBox[{"WorkingPrecision", "\[Rule]", "16"}]}], " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"MachinePrecision", "+", "2"}], " ", "*)"}], 
                "]"}]}]}], ";", " ", 
             RowBox[{"(*", " ", 
              RowBox[{"motivated", " ", "by", " ", "sentence", " ", "6"}], 
              " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "<=", 
                RowBox[{"Length", "[", "vars", "]"}]}], ",", 
               RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"vars", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "=", " ", 
                 RowBox[{
                  RowBox[{"subscript", " ", "number"}], " ", "=", " ", 
                  RowBox[{"vertex", " ", "number"}]}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"vars", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "eqns", ",", 
                    "\"\< got set to zero. increase WorkingPrecision?\>\""}], 
                    "]"}], ";", 
                   RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<node \>\"", ",", 
                    RowBox[{
                    RowBox[{"vars", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\< Z=\>\"", ",", 
                    RowBox[{"zValues", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"myZ", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"vars", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
                 RowBox[{"zValues", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], ",", "sortedSCCs"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "myZ", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.521050963466382*^9, 3.52105096490619*^9}, {
   3.521051028829207*^9, 3.52105103526641*^9}, {3.5210511788734503`*^9, 
   3.521051222761256*^9}, {3.521051256017447*^9, 3.521051355503663*^9}, {
   3.521051387885639*^9, 3.521051421914116*^9}, {3.521051473038464*^9, 
   3.5210514964544907`*^9}, {3.521051906150488*^9, 3.521051912721962*^9}, {
   3.521051959234867*^9, 3.52105198039261*^9}, {3.5210520493787107`*^9, 
   3.5210520572922983`*^9}, {3.5210521289949512`*^9, 
   3.5210522489685907`*^9}, {3.521052312223234*^9, 3.521052374827656*^9}, {
   3.521052410222352*^9, 3.5210525085050364`*^9}, {3.5210526387111683`*^9, 
   3.521052645338029*^9}, {3.5210527525730047`*^9, 3.521052816311141*^9}, {
   3.521052890899049*^9, 3.521052891303132*^9}, {3.521052965058267*^9, 
   3.521052991424265*^9}, {3.5210530292931423`*^9, 3.521053060015956*^9}, {
   3.521053140055848*^9, 3.52105317069984*^9}, {3.5210532441177998`*^9, 
   3.521053273327066*^9}, {3.521053310906169*^9, 3.521053350949424*^9}, {
   3.5210534258260393`*^9, 3.521053428187635*^9}, {3.5210534782939167`*^9, 
   3.521053501001923*^9}, {3.521053533097218*^9, 3.5210535453727627`*^9}, {
   3.5210535808284273`*^9, 3.521053647318647*^9}, {3.521053682077736*^9, 
   3.521053704631069*^9}, {3.5210537760590343`*^9, 3.521053971386417*^9}, {
   3.521054152689769*^9, 3.521054160827986*^9}, {3.52105460370862*^9, 
   3.521054604319113*^9}, {3.5210546978427067`*^9, 3.5210547017024393`*^9}, {
   3.521054811549306*^9, 3.5210548124454727`*^9}, {3.5210548679487057`*^9, 
   3.521054894891707*^9}, {3.521055410801669*^9, 3.521055443681818*^9}, {
   3.5210569799374733`*^9, 3.521056981731896*^9}, 3.521057367750722*^9, {
   3.521057974663062*^9, 3.521057983544602*^9}, {3.52106045028405*^9, 
   3.521060452551876*^9}, {3.521065660642516*^9, 3.521065661772284*^9}, {
   3.521103417042163*^9, 3.521103418422183*^9}, {3.5211106556287107`*^9, 
   3.521110679759441*^9}, {3.521110826925111*^9, 3.521110828439506*^9}, {
   3.521241931289513*^9, 3.521242099300514*^9}, {3.521242142337459*^9, 
   3.521242206307404*^9}, {3.5212422560229273`*^9, 3.521242356814395*^9}, {
   3.5212423902691317`*^9, 3.521242567289056*^9}, {3.521242609314695*^9, 
   3.5212426132087107`*^9}, {3.521242651933394*^9, 3.521242689170977*^9}, {
   3.521242814646936*^9, 3.521242862862753*^9}, {3.5212430616728783`*^9, 
   3.521243103365232*^9}, {3.521243468387285*^9, 3.521243487402128*^9}, {
   3.521243692157366*^9, 3.5212437204809713`*^9}, {3.521243813520628*^9, 
   3.521243833782428*^9}, {3.521243953132824*^9, 3.521243999676551*^9}, {
   3.521244057871716*^9, 3.521244062105088*^9}, {3.5212442045589046`*^9, 
   3.5212442222877893`*^9}, {3.52124427168361*^9, 3.521244283944644*^9}, {
   3.52124492175791*^9, 3.5212449852412567`*^9}, {3.521245024273617*^9, 
   3.521245094337302*^9}, {3.521245146219775*^9, 3.521245166108247*^9}, {
   3.52124520475524*^9, 3.5212452088505707`*^9}, {3.5212452697323914`*^9, 
   3.5212452782474947`*^9}, {3.521245386986876*^9, 3.521245390927082*^9}, {
   3.521245432815832*^9, 3.521245433341372*^9}, {3.521245706975243*^9, 
   3.5212457176429243`*^9}, {3.521245915074039*^9, 3.521245919079719*^9}, {
   3.521245983999357*^9, 3.5212459904934673`*^9}, {3.521246298820109*^9, 
   3.521246316915447*^9}, {3.521246455276247*^9, 3.5212464669908524`*^9}, {
   3.521246581061974*^9, 3.521246621449978*^9}, {3.521246701066279*^9, 
   3.521246732823806*^9}, {3.521246813840914*^9, 3.521246827251734*^9}, {
   3.521246860925748*^9, 3.52124690678019*^9}, {3.5212469846728354`*^9, 
   3.5212470325721607`*^9}, {3.52124708011476*^9, 3.521247198040626*^9}, {
   3.5212784966515913`*^9, 3.521278545859209*^9}, 3.5212789577540092`*^9, {
   3.52128648359439*^9, 3.521286530917808*^9}, {3.5212882338114443`*^9, 
   3.521288235244276*^9}, 3.5212886589309196`*^9, {3.521290685953918*^9, 
   3.5212906893364897`*^9}, {3.521290783912389*^9, 3.521290785853427*^9}, {
   3.521290873754937*^9, 3.521290879163756*^9}, {3.5212950227211533`*^9, 
   3.521295027709084*^9}, {3.521296428087329*^9, 3.5212964293726387`*^9}, {
   3.521297004097254*^9, 3.521297032841053*^9}, {3.5212971167915*^9, 
   3.521297122285644*^9}, {3.521297163093952*^9, 3.521297174674197*^9}, {
   3.521297304382716*^9, 3.521297350457254*^9}, 3.521317754661022*^9, {
   3.521320665802087*^9, 3.521320696559751*^9}, {3.52153847325732*^9, 
   3.521538558414214*^9}, {3.5215387002402363`*^9, 3.521538740975911*^9}, {
   3.521539208791109*^9, 3.5215392128717613`*^9}, {3.521539380896934*^9, 
   3.521539398830626*^9}, {3.521539989680833*^9, 3.521540029308675*^9}, {
   3.521545026800226*^9, 3.5215450308569117`*^9}, {3.5215461654463377`*^9, 
   3.521546165748316*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Tilt by Z", "Section",
 CellChangeTimes->{{3.5210627888864403`*^9, 3.521062802172014*^9}, {
  3.521319353359457*^9, 3.521319355041935*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TiltGrammar", "[", 
    RowBox[{"g_", ",", "z_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "start", ",", "nonterminals", ",", "terminals", ",", "rules", ",", 
       "amount"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "g"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"vertices", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"nonterminals", ",", "terminals"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"vertexNumber", "[", "v_String", "]"}], " ", ":=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"vertices", ",", "v"}], "]"}], "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"just", " ", "as", " ", "in", " ", "GraphProjection"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"zParent", "[", "lhs_String", "]"}], " ", ":=", " ", 
       RowBox[{"z", "[", 
        RowBox[{"[", 
         RowBox[{"vertexNumber", "[", "lhs", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "         ", 
      RowBox[{
       RowBox[{"zChildren", "[", "rhs_List", "]"}], " ", ":=", " ", 
       RowBox[{"Fold", "[", 
        RowBox[{"Times", ",", "1", ",", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"sym", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"terminals", ",", "sym"}], "]"}], ",", "1", ",", 
              RowBox[{"z", "[", 
               RowBox[{"[", 
                RowBox[{"vertexNumber", "[", "sym", "]"}], "]"}], "]"}]}], 
             "]"}]}], "]"}], "/@", "rhs"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\n", "\t       ", 
      RowBox[{
       RowBox[{"TiltRule", "[", "wrule_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"originalprob", ",", "lhs", ",", "rhs"}], "}"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"originalprob", " ", "=", " ", 
           RowBox[{"Part", "[", 
            RowBox[{"wrule", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"lhs", " ", "=", 
           RowBox[{"Part", "[", 
            RowBox[{"wrule", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"rhs", " ", "=", " ", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"wrule", ",", "1"}], "]"}], ",", "\"\<Binary\>\"", ",", 
             
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"wrule", ",", "4"}], "]"}], ",", 
               RowBox[{"Part", "[", 
                RowBox[{"wrule", ",", "5"}], "]"}]}], "}"}], ",", "_", ",", 
             RowBox[{"{", 
              RowBox[{"Part", "[", 
               RowBox[{"wrule", ",", "4"}], "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"zParent", "[", "lhs", "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<couldn't find a z for \>\"", ",", "lhs", ",", 
               "\"\< number \>\"", ",", 
               RowBox[{"vertexNumber", "[", "lhs", "]"}]}], "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"amount", " ", "=", " ", 
           FractionBox[
            RowBox[{"zChildren", "[", "rhs", "]"}], 
            RowBox[{"zParent", "[", "lhs", "]"}]]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"1", "-", "amount"}], "]"}], ">", 
               SuperscriptBox["10", 
                RowBox[{"-", "10"}]]}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<tilting by \>\"", ",", "amount"}], "]"}]}], "]"}],
             ";"}], "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"wrule", ",", 
            RowBox[{"2", "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"originalprob", "*", "amount"}], ")"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "start", ",", "\[IndentingNewLine]", "                      ", 
         "nonterminals", ",", "\[IndentingNewLine]", "                      ",
          "terminals", ",", "\[IndentingNewLine]", "\t             ", 
         RowBox[{"TiltRule", "/@", "rules"}]}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.521064634288941*^9, 3.521064669575275*^9}, {
   3.521064749358428*^9, 3.52106477920584*^9}, {3.521064820572771*^9, 
   3.521064934116136*^9}, {3.521064969236292*^9, 3.5210650520642843`*^9}, {
   3.521065103872355*^9, 3.5210652469257803`*^9}, {3.521065323291642*^9, 
   3.52106532910573*^9}, {3.5210653615932083`*^9, 3.5210653622175713`*^9}, {
   3.521065451504815*^9, 3.521065496517537*^9}, {3.521065530359167*^9, 
   3.521065596445261*^9}, {3.521065685692095*^9, 3.5210658909074697`*^9}, 
   3.521066206789157*^9, {3.521066239231772*^9, 3.521066240665299*^9}, {
   3.5210663961555233`*^9, 3.521066414728958*^9}, {3.521278987834457*^9, 
   3.521279008295988*^9}, {3.521279070665119*^9, 3.521279194785535*^9}, {
   3.52129042455934*^9, 3.52129042464744*^9}, 3.5215340958767767`*^9, {
   3.521537792553496*^9, 3.521537847358748*^9}, 3.521537900460814*^9, {
   3.521537940034748*^9, 3.521537950122031*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Entropy of Grammar", "Section",
 CellChangeTimes->{{3.521066615424281*^9, 3.521066623161025*^9}, 
   3.521067480624716*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"littleh", "[", "g_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "start", ",", "nonterminals", ",", "terminals", ",", "rules", ",", 
       "Eta"}], "}"}], ",", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "g"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\t\t\t", 
      RowBox[{
       RowBox[{"Eta", "[", "p_", "]"}], ":=", 
       RowBox[{
        RowBox[{"-", "p"}], "*", 
        RowBox[{"Log2", "[", "p", "]"}]}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"is", " ", "there", " ", "a", " ", "better", " ", 
        RowBox[{"name", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"nt", ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
          RowBox[{"Fold", "[", 
           RowBox[{"Plus", ",", "0", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Eta", "[", 
               RowBox[{"Part", "[", 
                RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], "/@", " ", 
             RowBox[{"Select", "[", 
              RowBox[{"rules", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "3"}], "]"}], "\[Equal]", "nt"}], "&"}]}],
               " ", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
         "\t\t                    ", "]"}], " ", "/@", " ", "nonterminals"}], 
       "\[IndentingNewLine]", "\t\t\t\t", "]"}]}]}], "\[IndentingNewLine]", 
    "\t\t\t", "\[IndentingNewLine]", "\t\t\t", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.521066926550675*^9, 3.521066987787122*^9}, {
  3.521067025158918*^9, 3.521067040924506*^9}, {3.521067073364771*^9, 
  3.52106707361235*^9}, {3.521067111902608*^9, 3.521067170551113*^9}, {
  3.521067223857483*^9, 3.521067284371007*^9}, {3.521067456602127*^9, 
  3.521067480629274*^9}, {3.52162842995184*^9, 3.5216284323747187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fertilitymatrix", "[", "g_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "start", ",", "nonterminals", ",", "terminals", ",", "rules", ",", 
       "idx", ",", "a", ",", "updateA"}], "}"}], ",", "\[IndentingNewLine]", 
     "\t\t\t                    ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "g"}], ";", "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{
       RowBox[{"idx", "[", "nt_String", "]"}], " ", ":=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"nonterminals", ",", "nt"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{"a", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "nonterminals", "]"}], ",", 
           RowBox[{"Length", "[", "nonterminals", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{
       RowBox[{"updateA", "[", "r_", "]"}], " ", ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"prob", ",", "lhs"}], "}"}], ",", "\[IndentingNewLine]", 
         "\t                                              ", 
         RowBox[{
          RowBox[{"prob", " ", "=", " ", 
           RowBox[{"Part", "[", 
            RowBox[{"r", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t\t\t\t\t\t", 
          RowBox[{"lhs", " ", "=", 
           RowBox[{"Part", "[", 
            RowBox[{"r", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"nonterminals", ",", 
              RowBox[{"Part", "[", 
               RowBox[{"r", ",", "4"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"idx", "[", "lhs", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"idx", "[", 
                RowBox[{"Part", "[", 
                 RowBox[{"r", ",", "4"}], "]"}], "]"}], "]"}], "]"}], " ", "+=",
              " ", "prob"}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t\t\t\t\t", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"r", ",", "1"}], "]"}], "\[Equal]", "\"\<Binary\>\""}],
              " ", "&&", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"nonterminals", ",", 
               RowBox[{"Part", "[", 
                RowBox[{"r", ",", "5"}], "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"idx", "[", "lhs", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"idx", "[", 
                RowBox[{"Part", "[", 
                 RowBox[{"r", ",", "5"}], "]"}], "]"}], "]"}], "]"}], " ", "+=",
              " ", "prob"}]}], "]"}]}]}], " ", "\[IndentingNewLine]", 
        "\t\t\t\t\t", "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{"Scan", "[", 
       RowBox[{"updateA", ",", "rules"}], "]"}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t\t", 
      RowBox[{"Return", "[", "a", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.521067433958193*^9, 3.521067480629919*^9}, {
  3.521067594786831*^9, 3.5210676226495037`*^9}, {3.521067664039221*^9, 
  3.521067717624651*^9}, {3.52106776703487*^9, 3.521067869159582*^9}, {
  3.521067923521698*^9, 3.5210679516257544`*^9}, {3.521067982167158*^9, 
  3.521068256295389*^9}, {3.521068382251794*^9, 3.521068403551566*^9}, {
  3.521068454131744*^9, 3.5210684869538603`*^9}, {3.52106859573897*^9, 
  3.521068714993072*^9}, {3.521068780048923*^9, 3.521068786610106*^9}, {
  3.52106885766037*^9, 3.521068859260067*^9}, {3.521628439189142*^9, 
  3.521628442028866*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"entropyOfGrammar", "[", "g_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "start", ",", "nonterminals", ",", "terminals", ",", "rules", ",", 
       "idx", ",", "fert", ",", "h", ",", "spectralradius", ",", 
       "everybody"}], "}"}], ",", "\[IndentingNewLine]", 
     "\t\t\t                    ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", "nonterminals", ",", "terminals", ",", "rules"}], "}"}],
        " ", "=", "g"}], ";", "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{
       RowBox[{"idx", "[", "nt_String", "]"}], " ", ":=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"nonterminals", ",", "nt"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"littleh", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t\t", 
      RowBox[{"fert", " ", "=", " ", 
       RowBox[{"fertilitymatrix", "[", "g", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{"spectralradius", " ", "=", " ", 
       RowBox[{
        RowBox[{"Eigenvalues", "[", "fert", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"spectralradius", " ", ">", " ", "1"}], ",", 
        RowBox[{
        "Print", "[", "\"\<entropyOfGrammar: grammar not consistent\>\"", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\t\t\t\t\t", 
      RowBox[{"everybody", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", "nonterminals", "]"}], "]"}], "-", 
           "fert"}], "]"}], ")"}], " ", ".", " ", "h"}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"everybody", "[", 
           RowBox[{"[", 
            RowBox[{"idx", "[", "start", "]"}], "]"}], "]"}], ",", 
          "everybody"}], "}"}], "]"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\t\t\t\t\t", 
      RowBox[{"everybody", "[", 
       RowBox[{"[", 
        RowBox[{"idx", "[", "start", "]"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.521068927478796*^9, 3.521068997063561*^9}, {
  3.521069089232115*^9, 3.521069390506503*^9}, {3.521069499561411*^9, 
  3.5210695073808804`*^9}, {3.5210695594816303`*^9, 3.521069621548584*^9}, {
  3.521069708342515*^9, 3.521069720749278*^9}, {3.521070174948873*^9, 
  3.5210701861123037`*^9}, {3.5212475165391483`*^9, 3.5212475317529984`*^9}, {
  3.52127856404617*^9, 3.521278569265682*^9}}],

Cell["End - to - End", "Section",
 CellChangeTimes->{{3.5213195187848387`*^9, 3.521319543317102*^9}, 
   3.521319578908976*^9, 3.521319771947098*^9, 3.5218209150723658`*^9, 
   3.5218257161693993`*^9, 3.522002098300983*^9}],

Cell[TextData[{
 StyleBox["chinese.m",
  FontFamily->"Courier"],
 " is a ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " list of strings encoding the Chinese relative clauses. There are 4 stimuli \
total manipulating the RC types and their positions in the main clause."
}], "Subsubtitle",
 CellChangeTimes->{{3.521317142501919*^9, 3.521317166835775*^9}, {
   3.521319386731978*^9, 3.521319401375168*^9}, 3.521319463475148*^9, {
   3.5213195138292847`*^9, 3.521319607805811*^9}, {3.521319659659851*^9, 
   3.521319671641014*^9}, {3.521319843356265*^9, 3.521319866520307*^9}, {
   3.521726236824164*^9, 3.5217262443926897`*^9}, 3.5218209150730543`*^9, 
   3.5218228288960037`*^9, 3.521825716169784*^9, 3.522002098301281*^9, 
   3.522057542705296*^9}],

Cell[BoxData[
 RowBox[{"<<", "chinese.m", "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "keenanhawkins", " ", "with", " ", "all", " ", "NPs", " ", "made", " ", 
    "singular"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5210698395909843`*^9, 3.521069863894834*^9}, {
   3.521069925943438*^9, 3.5210701069196167`*^9}, {3.521070145826118*^9, 
   3.521070238897768*^9}, {3.521070288207314*^9, 3.5210703887510366`*^9}, {
   3.521070464695272*^9, 3.521070470054871*^9}, {3.521070524424835*^9, 
   3.521070524750812*^9}, {3.52107070763085*^9, 3.521070708196704*^9}, {
   3.521071054440201*^9, 3.521071081409778*^9}, {3.521071122758716*^9, 
   3.521071126478445*^9}, {3.521110899821299*^9, 3.521110950061779*^9}, {
   3.521111044775882*^9, 3.521111053978692*^9}, {3.521111090803322*^9, 
   3.5211111313673058`*^9}, {3.521228530125078*^9, 3.5212285315968018`*^9}, {
   3.521229499822503*^9, 3.521229501441409*^9}, {3.5212300547390547`*^9, 
   3.5212300596656513`*^9}, {3.521230111767807*^9, 3.5212301493089657`*^9}, {
   3.521232691968664*^9, 3.5212326991235743`*^9}, {3.5212331368181*^9, 
   3.5212331375695868`*^9}, {3.5212416374547243`*^9, 3.521241666446217*^9}, 
   3.5212438711085043`*^9, 3.521294877755548*^9, {3.521319386731803*^9, 
   3.52131940137494*^9}, 3.521319463474987*^9, {3.5213195138290873`*^9, 
   3.521319607805608*^9}, 3.52131972884424*^9, {3.52181963392533*^9, 
   3.521819636987224*^9}, 3.521820915073765*^9, 3.5218257161702747`*^9, {
   3.5218264314092093`*^9, 3.5218264336406116`*^9}, 3.522002098301762*^9, {
   3.5220575272594976`*^9, 3.5220575293685017`*^9}}],

Cell[TextData[{
 StyleBox[" nameOfCoordinate",
  FontFamily->"Courier"],
 " indexes the filenames created by ",
 StyleBox["getCharts",
  FontFamily->"Courier"],
 "and other functions below"
}], "Subsubtitle",
 CellChangeTimes->{{3.521317142501919*^9, 3.521317166835775*^9}, {
   3.521319386731978*^9, 3.521319401375168*^9}, 3.521319463475148*^9, {
   3.5213195138292847`*^9, 3.521319607805811*^9}, {3.521319659659851*^9, 
   3.521319671641014*^9}, {3.521703481525141*^9, 3.521703482108189*^9}, {
   3.521724548225464*^9, 3.521724628047853*^9}, {3.521724665474366*^9, 
   3.5217246674763107`*^9}, {3.521725113880369*^9, 3.5217251242957783`*^9}, 
   3.5218209150796843`*^9, 3.521825716172567*^9, 3.52200209830363*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nameOfCoordinate", "[", 
   RowBox[{"sentencenumber_", ",", "prefixnumber_"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"$TemporaryDirectory", ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"put", " ", "it", " ", 
       RowBox[{
        RowBox[{"in", " ", "/", "tmp"}], "/", "m"}], " ", "on", " ", "Mac", 
       " ", "OS", " ", "X"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<prefix\>\"", ",", 
       RowBox[{"ToString", "[", "sentencenumber", "]"}], ",", "\"\<-\>\"", 
       ",", 
       RowBox[{"ToString", "[", "prefixnumber", "]"}], ",", 
       "\"\<.chart\>\""}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.521548667235656*^9, 3.5215487233372297`*^9}, {
   3.521725229516972*^9, 3.521725280979501*^9}, 3.521820915080593*^9, 
   3.5218257161733418`*^9, 3.5220020983043528`*^9}],

Cell[TextData[{
 StyleBox["getCharts",
  FontFamily->"Courier"],
 " calls the MCFG parser to create all the prefix<Sentence>-<Prefix>.chart \
files using \[OpenCurlyDoubleQuote]unconditionedgrammarfilename\
\[CloseCurlyDoubleQuote] (which should be: \
\[OpenCurlyDoubleQuote]grammars/wmcfg/larsonian1.wmcfg\[CloseCurlyDoubleQuote]\
) or perhaps \[OpenCurlyDoubleQuote]grammars/wmcfg/jpr-fig13.wmcfg\
\[CloseCurlyDoubleQuote]"
}], "Subsubtitle",
 CellChangeTimes->{{3.521317037327656*^9, 3.521317083780078*^9}, {
   3.5213193867356863`*^9, 3.5213194013805447`*^9}, 3.521319463478009*^9, {
   3.521319513833291*^9, 3.5213195507719307`*^9}, {3.5213196005540667`*^9, 
   3.521319607810677*^9}, 3.521474730469139*^9, {3.521548602023877*^9, 
   3.52154861615458*^9}, {3.521565407857685*^9, 3.521565446279286*^9}, {
   3.5215697171789837`*^9, 3.521569720970861*^9}, 3.521724637817404*^9, 
   3.521725072158081*^9, {3.521819722824585*^9, 3.521819742281311*^9}, 
   3.521820915082098*^9, 3.521825716173794*^9, 3.522002098305687*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getCharts", "[", 
   RowBox[{"unconditionedgrammarfilename_", ",", "sentences_List"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "cleanupEpsilon", "=", " ", "\"\<sed -e 's/\\\" \\\"/EMPTY/'\>\""}], 
      ",", "fragstring", ",", "dest", ",", "cmd"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"interdigitate", "[", 
       RowBox[{"a_String", ",", "b_String"}], "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "\"\<\>\""}], ",", "b", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"b", "\[Equal]", "\"\<\>\""}], ",", "a", ",", 
          RowBox[{"a", "<>", "\"\< \>\"", "<>", "b"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"sentencenumber", "=", "1"}], ",", 
       RowBox[{"sentencenumber", "\[LessEqual]", 
        RowBox[{"Length", "[", "sentences", "]"}]}], ",", 
       RowBox[{"sentencenumber", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"prefixnumber", " ", "=", "1"}], ",", 
         RowBox[{"prefixnumber", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"sentences", "[", 
            RowBox[{"[", "sentencenumber", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"prefixnumber", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"fragstring", "=", " ", 
           RowBox[{"Fold", "[", 
            RowBox[{"interdigitate", ",", "\"\<\>\"", ",", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"sentences", "[", 
                RowBox[{"[", "sentencenumber", "]"}], "]"}], ",", 
               "prefixnumber"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]",
           "\t\t", 
          RowBox[{"dest", " ", "=", 
           RowBox[{"nameOfCoordinate", "[", 
            RowBox[{"sentencenumber", ",", "prefixnumber"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t ", 
          RowBox[{"cmd", "  ", "=", " ", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
            "\"\<./mcfg_nt \>\"", " ", ",", "unconditionedgrammarfilename", 
             ",", "\"\< -p \\\"\>\"", ",", "fragstring", ",", 
             "\"\<\\\" | \>\"", ",", "cleanupEpsilon", ",", "\"\< > \>\"", 
             ",", "dest"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"PrintTemporary", "[", "cmd", "]"}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Run", "[", "cmd", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "\t\t", "\[IndentingNewLine]", "\t\t", "]"}]}], "\[IndentingNewLine]",
       "\t", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5215480289804783`*^9, 3.521548383585897*^9}, {
   3.52154850670404*^9, 3.521548527365749*^9}, {3.5215485746300583`*^9, 
   3.521548578588773*^9}, {3.521548741115735*^9, 3.521548771339295*^9}, {
   3.521550475321536*^9, 3.521550613809619*^9}, {3.521550659110273*^9, 
   3.5215506764454*^9}, {3.5215509752535143`*^9, 3.521550994281599*^9}, {
   3.521565258922016*^9, 3.5215653159485598`*^9}, {3.521565349658861*^9, 
   3.52156535279206*^9}, {3.521617079633128*^9, 3.521617080718692*^9}, {
   3.5217251607732573`*^9, 3.521725196169465*^9}, {3.521725259848289*^9, 
   3.521725266763184*^9}, 3.5218209150840597`*^9, 3.521825716175844*^9, {
   3.521975753982016*^9, 3.521975845290036*^9}, {3.52197592035931*^9, 
   3.521976090437585*^9}, {3.5219762047310963`*^9, 3.521976205145857*^9}, {
   3.521976262067668*^9, 3.521976282131731*^9}, {3.5219763320249987`*^9, 
   3.5219763860000277`*^9}, {3.5219781371308413`*^9, 3.5219781523473787`*^9}, 
   3.522002098307468*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getUnlexicalizedCharts", "[", 
   RowBox[{"unconditionedgrammarfilename_", ",", "sentences_List"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "cleanupEpsilon", "=", " ", "\"\<sed -e 's/\\\" \\\"/EMPTY/'\>\""}], 
      ",", "fragstring", ",", "dest", ",", "cmd", ",", "postprocess", ",", 
      "unlexicalizer"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"interdigitate", "[", 
       RowBox[{"a_String", ",", "b_String"}], "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "\"\<\>\""}], ",", "b", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"b", "\[Equal]", "\"\<\>\""}], ",", "a", ",", 
          RowBox[{"a", "<>", "\"\< \>\"", "<>", "b"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"sentencenumber", "=", "1"}], ",", 
       RowBox[{"sentencenumber", "\[LessEqual]", 
        RowBox[{"Length", "[", "sentences", "]"}]}], ",", 
       RowBox[{"sentencenumber", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"prefixnumber", " ", "=", "1"}], ",", 
         RowBox[{"prefixnumber", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"sentences", "[", 
            RowBox[{"[", "sentencenumber", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"prefixnumber", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"fragstring", "=", " ", 
           RowBox[{"Fold", "[", 
            RowBox[{"interdigitate", ",", "\"\<\>\"", ",", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"sentences", "[", 
                RowBox[{"[", "sentencenumber", "]"}], "]"}], ",", 
               "prefixnumber"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]",
           "\t\t", 
          RowBox[{"dest", " ", "=", 
           RowBox[{"nameOfCoordinate", "[", 
            RowBox[{"sentencenumber", ",", "prefixnumber"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "the", " ", "light", " ", "gray", " ", "colored", " ", "lines", 
            " ", "below", " ", "do", " ", "the", " ", "unlexicalizing"}], " ",
            "*)"}], "\[IndentingNewLine]", "\t\t", 
          StyleBox[
           RowBox[{"postprocess", "=", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<./unlexicalize.csh \>\"", ",", 
              RowBox[{"ToString", "[", "prefixnumber", "]"}]}], "]"}]}],
           Background->GrayLevel[0.85]], 
          StyleBox[";",
           Background->GrayLevel[0.85]], 
          StyleBox["\[IndentingNewLine]",
           Background->GrayLevel[0.85]], 
          StyleBox["\t\t",
           Background->GrayLevel[0.85]], 
          StyleBox[
           RowBox[{"PrintTemporary", "[", "postprocess", "]"}],
           Background->GrayLevel[0.85]], 
          StyleBox[";",
           Background->GrayLevel[0.85]], 
          StyleBox["\[IndentingNewLine]",
           Background->GrayLevel[0.85]], 
          StyleBox["\t\t",
           Background->GrayLevel[0.85]], 
          StyleBox[
           RowBox[{"Run", "[", "postprocess", "]"}],
           Background->GrayLevel[0.85]], 
          StyleBox[";",
           Background->GrayLevel[0.85]], 
          StyleBox["\[IndentingNewLine]",
           Background->RGBColor[0.87, 0.94, 1]], "\[IndentingNewLine]", 
          "\t\t", 
          StyleBox[
           RowBox[{"unlexicalizer", "=", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<unlexicalize\>\"", ",", 
              RowBox[{"ToString", "[", "prefixnumber", "]"}], ",", 
              "\"\<.sed\>\""}], "]"}]}],
           Background->GrayLevel[0.85]], 
          StyleBox[";",
           Background->GrayLevel[0.85]], 
          StyleBox["\[IndentingNewLine]",
           Background->GrayLevel[0.85]], 
          StyleBox["\t\t",
           Background->GrayLevel[0.85]], 
          StyleBox[
           RowBox[{"cmd", "  ", "=", " ", 
            RowBox[{"StringJoin", "[", 
             RowBox[{
             "\"\<./mcfg_nt \>\"", " ", ",", "unconditionedgrammarfilename", 
              ",", "\"\< -p \\\"\>\"", ",", "fragstring", ",", 
              "\"\<\\\" | \>\"", ",", "cleanupEpsilon", ",", 
              "\"\< | sed -E -f \>\"", ",", "unlexicalizer", ",", 
              "\"\< | sort -k4 | uniq > \>\"", ",", "dest"}], "]"}]}],
           Background->GrayLevel[0.85]], 
          StyleBox[";",
           Background->GrayLevel[0.85]], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"PrintTemporary", "[", "cmd", "]"}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Run", "[", "cmd", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "\t\t", "\[IndentingNewLine]", "\t\t", "]"}]}], "\[IndentingNewLine]",
       "\t", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5215480289804783`*^9, 3.521548383585897*^9}, {
   3.52154850670404*^9, 3.521548527365749*^9}, {3.5215485746300583`*^9, 
   3.521548578588773*^9}, {3.521548741115735*^9, 3.521548771339295*^9}, {
   3.521550475321536*^9, 3.521550613809619*^9}, {3.521550659110273*^9, 
   3.5215506764454*^9}, {3.5215509752535143`*^9, 3.521550994281599*^9}, {
   3.521565258922016*^9, 3.5215653159485598`*^9}, {3.521565349658861*^9, 
   3.52156535279206*^9}, {3.521617079633128*^9, 3.521617080718692*^9}, {
   3.5217251607732573`*^9, 3.521725196169465*^9}, {3.521725259848289*^9, 
   3.521725266763184*^9}, 3.5218209150840597`*^9, 3.521825716175844*^9, {
   3.521975753982016*^9, 3.521975845290036*^9}, {3.52197592035931*^9, 
   3.521976090437585*^9}, {3.5219762047310963`*^9, 3.521976205145857*^9}, {
   3.521976262067668*^9, 3.521976282131731*^9}, {3.5219763320249987`*^9, 
   3.5219763860000277`*^9}, {3.521978127212421*^9, 3.521978128738614*^9}, 
   3.5219921851744833`*^9, {3.521992220446756*^9, 3.521992244934684*^9}, 
   3.522002098309947*^9}],

Cell["\<\
This re-creates all the prefix grammars for a given set of examples:\
\>", "Subsubtitle",
 CellChangeTimes->{{3.521317142501919*^9, 3.521317166835775*^9}, {
   3.521319386731978*^9, 3.521319401375168*^9}, 3.521319463475148*^9, {
   3.5213195138292847`*^9, 3.521319607805811*^9}, {3.521319659659851*^9, 
   3.521319671641014*^9}, {3.521703481525141*^9, 3.521703482108189*^9}, {
   3.521724548225464*^9, 3.521724628047853*^9}, {3.521724665474366*^9, 
   3.5217246674763107`*^9}, {3.521725113880369*^9, 3.5217251242957783`*^9}, {
   3.5217253023692627`*^9, 3.521725313318643*^9}, {3.52172544182451*^9, 
   3.521725449838323*^9}, {3.521725840534666*^9, 3.521725849687869*^9}, 
   3.521820915085104*^9, {3.521822807185692*^9, 3.52182281543788*^9}, 
   3.5218257161761703`*^9, 3.5220020983109903`*^9}],

Cell[BoxData[
 RowBox[{"getCharts", "[", 
  RowBox[{"\"\<grammars/wmcfg/chinese.wmcfg\>\"", ",", "chinese"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.521819753209079*^9, 3.521819763203238*^9}, 
   3.521820915085783*^9, 3.521825716176921*^9, 3.522002098312299*^9, {
   3.52205762028309*^9, 3.522057624370586*^9}}],

Cell[TextData[{
 StyleBox["entOfGrammarFile",
  FontFamily->"Courier"],
 " computes the entropy of a grammar after first renormalizing using \
functions defined above, especially CalculateZ"
}], "Subsubtitle",
 CellChangeTimes->{{3.521317142501919*^9, 3.521317166835775*^9}, {
   3.521319386731978*^9, 3.521319401375168*^9}, 3.521319463475148*^9, {
   3.5213195138292847`*^9, 3.521319607805811*^9}, {3.521319659659851*^9, 
   3.521319671641014*^9}, {3.521703481525141*^9, 3.521703482108189*^9}, 
   3.521820915087068*^9, 3.5218224144538937`*^9, 3.521825716177247*^9, 
   3.522002098312533*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"entOfGrammarFile", "[", "filename_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grammar", ",", "graph", ",", "SCCs", ",", "z", ",", "gprime"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grammar", " ", "=", " ", 
       RowBox[{"ChartToGrammar", "[", 
        RowBox[{"Import", "[", 
         RowBox[{"filename", ",", "\"\<Table\>\""}], "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "add", " ", "regexp", " ", "here", " ", "for", " ", "custom", " ", 
        "start", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"graph", "=", 
       RowBox[{"GraphProjection", "[", "grammar", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SCCs", " ", "=", " ", 
       RowBox[{"getSCCs", "[", "graph", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"z", " ", "=", " ", 
       RowBox[{"CalculateZ", "[", 
        RowBox[{"grammar", ",", "graph", ",", "SCCs"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gprime", " ", "=", " ", 
       RowBox[{"TiltGrammar", "[", 
        RowBox[{"grammar", ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"entropyOfGrammar", "[", "gprime", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5210698395909843`*^9, 3.521069863894834*^9}, {
   3.521069925943438*^9, 3.5210701069196167`*^9}, {3.521070145826118*^9, 
   3.521070238897768*^9}, {3.521070288207314*^9, 3.5210703887510366`*^9}, {
   3.521070464695272*^9, 3.521070470054871*^9}, {3.521070524424835*^9, 
   3.521070524750812*^9}, {3.52107070763085*^9, 3.521070708196704*^9}, {
   3.521071054440201*^9, 3.521071081409778*^9}, {3.521071122758716*^9, 
   3.521071126478445*^9}, {3.521110899821299*^9, 3.521110950061779*^9}, {
   3.521111044775882*^9, 3.521111053978692*^9}, {3.521111090803322*^9, 
   3.5211111313673058`*^9}, {3.521228530125078*^9, 3.5212285315968018`*^9}, {
   3.521229499822503*^9, 3.521229501441409*^9}, {3.5212300547390547`*^9, 
   3.5212300596656513`*^9}, {3.521230111767807*^9, 3.5212301493089657`*^9}, {
   3.521232691968664*^9, 3.5212326991235743`*^9}, {3.5212331368181*^9, 
   3.5212331375695868`*^9}, {3.5212416374547243`*^9, 3.521241720403041*^9}, 
   3.521243871112418*^9, {3.521247286872305*^9, 3.521247376164542*^9}, {
   3.521288981945671*^9, 3.521289011823636*^9}, {3.5212890674761543`*^9, 
   3.521289102435152*^9}, 3.521294877759672*^9, 3.521299780493725*^9, {
   3.521319386732151*^9, 3.52131940137539*^9}, 3.521319463475306*^9, {
   3.521319513829475*^9, 3.5213196078060093`*^9}, {3.5215651879623528`*^9, 
   3.5215652003049*^9}, 3.521565498206937*^9, {3.521578035877157*^9, 
   3.521578074555182*^9}, 3.521578238144631*^9, 3.52157883655936*^9, 
   3.521618226940034*^9, {3.521627365598917*^9, 3.5216273716217003`*^9}, {
   3.521628543504944*^9, 3.521628544487854*^9}, {3.521631133952808*^9, 
   3.521631168277775*^9}, {3.5216312173560133`*^9, 3.5216312292471533`*^9}, {
   3.521724942336699*^9, 3.521724949426097*^9}, {3.521725526533742*^9, 
   3.521725534300598*^9}, 3.521820915088853*^9, 3.521822070795561*^9, {
   3.521822384441882*^9, 3.521822410303321*^9}, 3.521825716178364*^9, 
   3.522002098313468*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"oldStyle", "[", "filename_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grammar", ",", "graph", ",", "SCCs", ",", "z", ",", "gprime"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grammar", " ", "=", " ", 
       RowBox[{
        StyleBox["LocallyNormalize",
         FontColor->RGBColor[1, 0, 1]], "[", 
        RowBox[{"ChartToGrammar", "[", 
         RowBox[{"Import", "[", 
          RowBox[{"filename", ",", "\"\<Table\>\""}], "]"}], "]"}], "]"}]}], 
      ";", " ", 
      RowBox[{"(*", "  ", 
       RowBox[{
       "add", " ", "regexp", " ", "here", " ", "for", " ", "custom", " ", 
        "start", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"entropyOfGrammar", "[", "grammar", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5210698395909843`*^9, 3.521069863894834*^9}, {
   3.521069925943438*^9, 3.5210701069196167`*^9}, {3.521070145826118*^9, 
   3.521070238897768*^9}, {3.521070288207314*^9, 3.5210703887510366`*^9}, {
   3.521070464695272*^9, 3.521070470054871*^9}, {3.521070524424835*^9, 
   3.521070524750812*^9}, {3.52107070763085*^9, 3.521070708196704*^9}, {
   3.521071054440201*^9, 3.521071081409778*^9}, {3.521071122758716*^9, 
   3.521071126478445*^9}, {3.521110899821299*^9, 3.521110950061779*^9}, {
   3.521111044775882*^9, 3.521111053978692*^9}, {3.521111090803322*^9, 
   3.5211111313673058`*^9}, {3.521228530125078*^9, 3.5212285315968018`*^9}, {
   3.521229499822503*^9, 3.521229501441409*^9}, {3.5212300547390547`*^9, 
   3.5212300596656513`*^9}, {3.521230111767807*^9, 3.5212301493089657`*^9}, {
   3.521232691968664*^9, 3.5212326991235743`*^9}, {3.5212331368181*^9, 
   3.5212331375695868`*^9}, {3.5212416374547243`*^9, 3.521241720403041*^9}, 
   3.521243871112418*^9, {3.521247286872305*^9, 3.521247376164542*^9}, {
   3.521288981945671*^9, 3.521289011823636*^9}, {3.5212890674761543`*^9, 
   3.521289102435152*^9}, 3.521294877759672*^9, 3.521299780493725*^9, {
   3.521319386732151*^9, 3.52131940137539*^9}, 3.521319463475306*^9, {
   3.521319513829475*^9, 3.5213196078060093`*^9}, {3.5215651879623528`*^9, 
   3.5215652003049*^9}, 3.521565498206937*^9, {3.521578035877157*^9, 
   3.521578074555182*^9}, 3.521578238144631*^9, 3.52157883655936*^9, 
   3.521618226940034*^9, {3.521627365598917*^9, 3.5216273716217003`*^9}, {
   3.521628543504944*^9, 3.521628544487854*^9}, {3.521631133952808*^9, 
   3.521631168277775*^9}, {3.5216312173560133`*^9, 3.5216312292471533`*^9}, {
   3.521724942336699*^9, 3.521724949426097*^9}, {3.521725526533742*^9, 
   3.521725534300598*^9}, 3.521820915088853*^9, 3.521822070795561*^9, {
   3.521822384441882*^9, 3.521822410303321*^9}, 3.521825716178364*^9, {
   3.5218733835563793`*^9, 3.521873429264453*^9}, {3.52187384114054*^9, 
   3.52187386055693*^9}, {3.52189096903657*^9, 3.521890972380877*^9}, 
   3.521891489737894*^9, {3.521976425052455*^9, 3.521976440600672*^9}, {
   3.521976837237794*^9, 3.521976876356812*^9}, 3.5220020983149357`*^9}],

Cell[TextData[{
 StyleBox["probOfGrammarFile",
  FontFamily->"Courier"],
 " computes the inside probability of the supplied grammar\[CloseCurlyQuote]s \
start symbol. if this is an intersection grammar for a prefix, the value is \
in the prefix probability."
}], "Subsubtitle",
 CellChangeTimes->{{3.521317142501919*^9, 3.521317166835775*^9}, {
   3.521319386731978*^9, 3.521319401375168*^9}, 3.521319463475148*^9, {
   3.5213195138292847`*^9, 3.521319607805811*^9}, {3.521319659659851*^9, 
   3.521319671641014*^9}, {3.521703481525141*^9, 3.521703482108189*^9}, {
   3.521724548225464*^9, 3.5217245950013523`*^9}, 3.5218209150899763`*^9, 
   3.521822419916572*^9, 3.5218257161788177`*^9, 3.5220020983157167`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"probOfGrammarFile", "[", "filename_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "grammar", ",", "startnumber", ",", "s", ",", "n", ",", "t", ",", "r", 
      ",", "vertices", ",", "graph", ",", "SCCs", ",", "z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"grammar", " ", "=", " ", 
      RowBox[{"ChartToGrammar", "[", 
       RowBox[{"Import", "[", 
        RowBox[{"filename", ",", "\"\<Table\>\""}], "]"}], "]"}]}], ";", " ", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "add", " ", "regexp", " ", "here", " ", "for", " ", "custom", " ", 
       "start", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "n", ",", "t", ",", "r"}], "}"}], " ", "=", 
       "grammar"}],
      Background->GrayLevel[0.85]], 
     StyleBox[";",
      Background->GrayLevel[0.85]], 
     StyleBox["   ",
      Background->GrayLevel[0.85]], 
     RowBox[{"(*", " ", 
      RowBox[{
      "this", " ", "code", " ", "threshes", " ", "out", " ", "the", " ", 
       "start", " ", "symbol", " ", "previously", " ", "guessed", " ", "by", 
       " ", "ChartToGrammar"}], " ", "*)"}], 
     StyleBox["\[IndentingNewLine]",
      Background->GrayLevel[0.85]], 
     StyleBox[
      RowBox[{"vertices", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"n", ",", "t"}], "]"}]}],
      Background->GrayLevel[0.85]], 
     StyleBox[";",
      Background->GrayLevel[0.85]], 
     StyleBox[" ",
      Background->GrayLevel[0.85]], 
     RowBox[{"(*", " ", 
      RowBox[{
      "pass", " ", "in", " ", "a", " ", "custom", " ", "regexp", " ", "above",
        " ", "if", " ", "you", " ", "know", " ", "the", " ", "start", " ", 
       RowBox[{"symbol", "'"}], "s", " ", "spelling"}], " ", "*)"}], 
     StyleBox["\[IndentingNewLine]",
      Background->GrayLevel[0.85]], 
     StyleBox[
      RowBox[{"startnumber", " ", "=", "  ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"vertices", ",", "s"}], "]"}], "]"}], "]"}]}],
      Background->GrayLevel[0.85]], 
     StyleBox[";",
      Background->GrayLevel[0.85]], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{"GraphProjection", "[", "grammar", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SCCs", " ", "=", " ", 
      RowBox[{"getSCCs", "[", "graph", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", " ", "=", " ", 
      RowBox[{"CalculateZ", "[", 
       RowBox[{"grammar", ",", "graph", ",", "SCCs"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"z", "[", 
       RowBox[{"[", "startnumber", "]"}], "]"}], "]"}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"use", " ", "start", " ", "symbol", " ", "threshed"}], "-", 
     RowBox[{"out", " ", "above"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5217035686265697`*^9, 3.521703645381432*^9}, {
   3.521703680334858*^9, 3.5217037171398563`*^9}, {3.5217037793228903`*^9, 
   3.521703885063738*^9}, 3.5218209150913553`*^9, 3.5218211136458683`*^9, {
   3.521822449725368*^9, 3.521822545667715*^9}, {3.521822898741961*^9, 
   3.5218229058606453`*^9}, 3.52182571618075*^9, 3.522002098317237*^9}],

Cell[TextData[{
 "these declarations set up the parallel processing stuff used below in ",
 StyleBox["doSentences",
  FontFamily->"Courier"]
}], "Subsubtitle",
 CellChangeTimes->{{3.521317142501919*^9, 3.521317166835775*^9}, {
   3.521319386731978*^9, 3.521319401375168*^9}, 3.521319463475148*^9, {
   3.5213195138292847`*^9, 3.521319607805811*^9}, {3.521319659659851*^9, 
   3.521319671641014*^9}, {3.521703481525141*^9, 3.521703482108189*^9}, {
   3.521724548225464*^9, 3.521724628047853*^9}, {3.521724665474366*^9, 
   3.5217246674763107`*^9}, {3.521724745613735*^9, 3.521724777473323*^9}, 
   3.521820915091633*^9, {3.521822557332704*^9, 3.521822565936205*^9}, 
   3.521825716181101*^9, 3.5220020983174686`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"FindRoot", "::", "precw"}], "]"}], ";", 
    RowBox[{"Off", "[", 
     RowBox[{"FindRoot", "::", "bddir"}], "]"}]}], "]"}], ";", 
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{
   "SetDirectory", "[", 
    "\"\</Users/zhong/Documents/research/parser/mcfgcky2_repos/\>\"", "]"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ParallelNeeds", "[", "\"\<Combinatorica`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.521615395351416*^9, 3.521615477671434*^9}, {
   3.521615513185747*^9, 3.52161552236764*^9}, {3.521615561568541*^9, 
   3.521615563056746*^9}, {3.521621846817646*^9, 3.521621847944057*^9}, 
   3.521628096471792*^9, 3.521724605694316*^9, 3.5218209150921907`*^9, 
   3.521825716181734*^9, 3.5220020983180027`*^9, 3.522057663732811*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "compat"}], "MessageName"], ":", 
  " ", "\<\"Combinatorica Graph and Permutations functionality has been \
superseded by preloaded functionaliy. The package now being loaded may \
conflict with this. Please see the Compatibility Guide for details.\"\>"}]], \
"Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 ShowCellLabel->True,
 CellChangeTimes->{3.521890979324911*^9, 3.522002098318714*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "compat"}], "MessageName"], ":", 
  " ", "\<\"Combinatorica Graph and Permutations functionality has been \
superseded by preloaded functionaliy. The package now being loaded may \
conflict with this. Please see the Compatibility Guide for details.\"\>"}]], \
"Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 ShowCellLabel->True,
 CellChangeTimes->{3.521890979569953*^9, 3.52200209831942*^9}],

Cell[TextData[{
 StyleBox["doSentences:",
  FontFamily->"Courier"],
 " compute a function, say probOfGrammarFile or entOfGrammarFile, over each \
prefix file from a given collection of sentences, doing just sentences ",
 StyleBox["min",
  FontSlant->"Italic"],
 " through ",
 StyleBox["max",
  FontSlant->"Italic"]
}], "Subsubtitle",
 CellChangeTimes->{{3.521317142501919*^9, 3.521317166835775*^9}, {
   3.521319386731978*^9, 3.521319401375168*^9}, 3.521319463475148*^9, {
   3.5213195138292847`*^9, 3.521319607805811*^9}, {3.521319659659851*^9, 
   3.521319671641014*^9}, {3.521703481525141*^9, 3.521703482108189*^9}, {
   3.521724548225464*^9, 3.521724628047853*^9}, {3.521724665474366*^9, 
   3.5217246989465227`*^9}, {3.521725586041285*^9, 3.521725592456399*^9}, {
   3.521820877301931*^9, 3.521820915096253*^9}, 3.521820980156537*^9, {
   3.521822111719666*^9, 3.521822145110676*^9}, 3.521822562123186*^9, 
   3.521825716182191*^9, {3.521992543637866*^9, 3.52199254378691*^9}, 
   3.522002098319701*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"doSentences", "[", 
   RowBox[{"set_List", ",", "min_", ",", "max_", ",", "f_"}], "]"}], ":=", 
  " ", "\[IndentingNewLine]", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"filename", "=", 
        RowBox[{"nameOfCoordinate", "[", 
         RowBox[{"number", ",", "pfix"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PrintTemporary", "[", "filename", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "[", "filename", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"number", ",", "min", ",", "max"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"pfix", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"set", "[", 
        RowBox[{"[", "number", "]"}], "]"}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.521566128200369*^9, 3.5215661448679953`*^9}, {
   3.5215662069216413`*^9, 3.521566324970025*^9}, {3.5215663585620747`*^9, 
   3.521566383010213*^9}, {3.521566581701152*^9, 3.521566616227387*^9}, {
   3.52157010273724*^9, 3.521570147152409*^9}, {3.521570177218542*^9, 
   3.5215702524828777`*^9}, {3.52157050728584*^9, 3.521570516407744*^9}, {
   3.521570609600782*^9, 3.521570610139307*^9}, {3.521570643158681*^9, 
   3.521570650285839*^9}, {3.521576576474018*^9, 3.521576610477903*^9}, {
   3.52157664683792*^9, 3.521576657299679*^9}, {3.521576775489037*^9, 
   3.521576785344805*^9}, {3.521577342938566*^9, 3.5215774012615128`*^9}, {
   3.521577479531952*^9, 3.521577517146078*^9}, {3.5215775628541193`*^9, 
   3.5215775697737083`*^9}, {3.521577884446393*^9, 3.521577884711187*^9}, {
   3.521577933958902*^9, 3.521577963646666*^9}, {3.521578265656769*^9, 
   3.5215782670015697`*^9}, {3.5215783123253717`*^9, 3.52157833153232*^9}, {
   3.521578396710205*^9, 3.521578398924773*^9}, {3.5215784649886007`*^9, 
   3.521578582655361*^9}, {3.521578733392336*^9, 3.521578773504771*^9}, {
   3.521578853898817*^9, 3.521578856799595*^9}, {3.521578909402953*^9, 
   3.52157893645649*^9}, {3.5216148345248747`*^9, 3.521614869035562*^9}, {
   3.521615138065255*^9, 3.521615140190489*^9}, 3.5216153897818937`*^9, {
   3.5216159424199743`*^9, 3.521615951648117*^9}, {3.521617458618888*^9, 
   3.5216174918857327`*^9}, {3.521617585013887*^9, 3.521617587586083*^9}, {
   3.521617855402831*^9, 3.521617863747902*^9}, {3.521618257968296*^9, 
   3.52161826134208*^9}, {3.521618895397807*^9, 3.521618929459449*^9}, {
   3.521621809993103*^9, 3.521621821203416*^9}, 3.521622201393146*^9, {
   3.521622812290825*^9, 3.521622844576187*^9}, {3.5216228875335484`*^9, 
   3.521622984812546*^9}, {3.521623077749832*^9, 3.521623078799066*^9}, {
   3.521627839277733*^9, 3.521627901647059*^9}, {3.521627946984671*^9, 
   3.521627954442101*^9}, {3.52162837520049*^9, 3.521628378028964*^9}, {
   3.521631244241028*^9, 3.5216312458468113`*^9}, {3.521703904095697*^9, 
   3.521703929375496*^9}, {3.521706030820917*^9, 3.5217060322692432`*^9}, 
   3.5218209151327343`*^9, {3.521820972522644*^9, 3.5218209912258987`*^9}, {
   3.521821077904023*^9, 3.521821091698435*^9}, 3.521821122987492*^9, {
   3.521821153261726*^9, 3.5218212552528677`*^9}, {3.5218213114226923`*^9, 
   3.521821331116688*^9}, {3.521821409542615*^9, 3.521821427004588*^9}, {
   3.521821482128134*^9, 3.52182150281425*^9}, 3.5218215431326637`*^9, {
   3.521821586548917*^9, 3.521821586834687*^9}, {3.5218221532308617`*^9, 
   3.5218221821052103`*^9}, {3.521822284008195*^9, 3.521822286181644*^9}, {
   3.521822316431769*^9, 3.521822339933617*^9}, 3.521825716183079*^9, {
   3.521874126078307*^9, 3.521874154802473*^9}, {3.521874327230088*^9, 
   3.5218743305973577`*^9}, {3.521874700433238*^9, 3.521874704715626*^9}, 
   3.522002098320457*^9}],

Cell["for instance", "Subsubtitle",
 CellChangeTimes->{{3.5220021259739513`*^9, 3.522002130045308*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ents", "=", 
  RowBox[{"doSentences", "[", 
   RowBox[{"chinese", ",", "1", ",", "4", ",", "oldStyle"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.521976516899992*^9, 3.5219765331697283`*^9}, 
   3.521976889111277*^9, {3.5219773847338657`*^9, 3.521977388724862*^9}, {
   3.521992293142497*^9, 3.521992294742218*^9}, {3.5220013885281467`*^9, 
   3.522001393670082*^9}, 3.52200209832162*^9, {3.5220576736976*^9, 
   3.5220576743037033`*^9}, 3.522058208513143*^9, {3.522058252677147*^9, 
   3.5220582693062468`*^9}}],

Cell[BoxData["\<\"/tmp/prefix1-1.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058803841107*^9}],

Cell[BoxData["\<\"/tmp/prefix3-1.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058803869431*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Greater", "::", "nord"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Invalid comparison with \
\\!\\(\\(\\(-0.09506590237289582`\\)\\) + \\(\\(0.1646589729772381`\\\\ \
\[ImaginaryI]\\)\\)\\) attempted.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058803928091*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Greater", "::", "nord"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Invalid comparison with \
\\!\\(\\(\\(-0.09506590237289574`\\)\\) + \\(\\(0.16465897297723808`\\\\ \
\[ImaginaryI]\\)\\)\\) attempted.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058803970751*^9}],

Cell[BoxData["\<\"/tmp/prefix1-2.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.52205880402033*^9}],

Cell[BoxData["\<\"/tmp/prefix3-2.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804074567*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Greater", "::", "nord"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Invalid comparison with \
\\!\\(\\(\\(-0.09506590237289574`\\)\\) + \\(\\(0.16465897297723808`\\\\ \
\[ImaginaryI]\\)\\)\\) attempted.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804182081*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Greater", "::", "nord"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Invalid comparison with \
\\!\\(\\(\\(-0.09506590237289582`\\)\\) + \\(\\(0.1646589729772381`\\\\ \
\[ImaginaryI]\\)\\)\\) attempted.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804286611*^9}],

Cell[BoxData["\<\"/tmp/prefix1-3.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804412755*^9}],

Cell[BoxData["\<\"/tmp/prefix3-3.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804492072*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Greater", "::", "nord"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Invalid comparison with \
\\!\\(\\(\\(-0.09506590237289574`\\)\\) + \\(\\(0.16465897297723808`\\\\ \
\[ImaginaryI]\\)\\)\\) attempted.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804557816*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Greater", "::", "nord"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Invalid comparison with \
\\!\\(\\(\\(-0.0950659023728957`\\)\\) + \\(\\(0.16465897297723803`\\\\ \
\[ImaginaryI]\\)\\)\\) attempted.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804608387*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Greater :: nord\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804658029*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Greater :: nord\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588047071733`*^9}],

Cell[BoxData["\<\"/tmp/prefix1-4.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804757224*^9}],

Cell[BoxData["\<\"/tmp/prefix3-4.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804807084*^9}],

Cell[BoxData["\<\"/tmp/prefix1-5.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804856985*^9}],

Cell[BoxData["\<\"/tmp/prefix3-5.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804907076*^9}],

Cell[BoxData["\<\"/tmp/prefix1-6.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058804955554*^9}],

Cell[BoxData["\<\"/tmp/prefix3-6.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058805006493*^9}],

Cell[BoxData["\<\"/tmp/prefix2-1.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588050566587`*^9}],

Cell[BoxData["\<\"/tmp/prefix4-1.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058805104837*^9}],

Cell[BoxData["\<\"/tmp/prefix2-2.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058805155545*^9}],

Cell[BoxData["\<\"/tmp/prefix4-2.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588052053823`*^9}],

Cell[BoxData["\<\"/tmp/prefix2-3.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058805254931*^9}],

Cell[BoxData["\<\"/tmp/prefix4-3.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.52205880530589*^9}],

Cell[BoxData["\<\"/tmp/prefix2-4.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588053547993`*^9}],

Cell[BoxData["\<\"/tmp/prefix4-4.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058805405031*^9}],

Cell[BoxData["\<\"/tmp/prefix2-5.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588054535227`*^9}],

Cell[BoxData["\<\"/tmp/prefix4-5.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058805504263*^9}],

Cell[BoxData["\<\"/tmp/prefix2-6.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588055537233`*^9}],

Cell[BoxData["\<\"/tmp/prefix4-6.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588056522827`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.0972601801293314`", ",", "0.38533653277652413`", ",", 
     "4.510484726142886`", ",", "2.92552222542173`", ",", 
     "1.9255222254217301`", ",", "0.21629721997691198`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.067673139157379`", ",", "2.0676731391573786`", ",", 
     "4.510484726142886`", ",", "2.92552222542173`", ",", 
     "1.9255222254217301`", ",", "0.21629721997691198`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.067673139157379`", ",", "2.0676731391573786`", ",", 
     "3.703738886047554`", ",", "1.8012597206980683`", ",", 
     "1.584962500721156`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.067673139157379`", ",", "2.0676731391573786`", ",", 
     "0.21629721997691198`", ",", "1.584962500721156`", ",", 
     "1.584962500721156`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5220578357573853`*^9, 3.522058212121952*^9, {3.522058259232777*^9, 
   3.5220582730463333`*^9}, 3.52205880575343*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"probs", "=", 
  RowBox[{"doSentences", "[", 
   RowBox[{"chinese", ",", "1", ",", "4", ",", "probOfGrammarFile"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.52205831506577*^9, 3.52205835756316*^9}}],

Cell[BoxData["\<\"/tmp/prefix1-1.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058805878577*^9}],

Cell[BoxData["\<\"/tmp/prefix3-1.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058805911862*^9}],

Cell[BoxData["\<\"/tmp/prefix3-2.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058805968258*^9}],

Cell[BoxData["\<\"/tmp/prefix1-2.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588060558577`*^9}],

Cell[BoxData["\<\"/tmp/prefix1-3.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588061117353`*^9}],

Cell[BoxData["\<\"/tmp/prefix3-3.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588061675177`*^9}],

Cell[BoxData["\<\"/tmp/prefix3-4.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058806214603*^9}],

Cell[BoxData["\<\"/tmp/prefix3-5.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588062856407`*^9}],

Cell[BoxData["\<\"/tmp/prefix1-4.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058806356196*^9}],

Cell[BoxData["\<\"/tmp/prefix1-5.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588064165373`*^9}],

Cell[BoxData["\<\"/tmp/prefix3-6.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588064612494`*^9}],

Cell[BoxData["\<\"/tmp/prefix1-6.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058806511405*^9}],

Cell[BoxData["\<\"/tmp/prefix4-1.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058806571014*^9}],

Cell[BoxData["\<\"/tmp/prefix2-1.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058806638443*^9}],

Cell[BoxData["\<\"/tmp/prefix4-2.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588066997423`*^9}],

Cell[BoxData["\<\"/tmp/prefix2-2.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058806767455*^9}],

Cell[BoxData["\<\"/tmp/prefix4-3.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058806777313*^9}],

Cell[BoxData["\<\"/tmp/prefix2-3.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588069175*^9}],

Cell[BoxData["\<\"/tmp/prefix4-4.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058806923712*^9}],

Cell[BoxData["\<\"/tmp/prefix2-4.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.52205880703393*^9}],

Cell[BoxData["\<\"/tmp/prefix4-5.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058807098*^9}],

Cell[BoxData["\<\"/tmp/prefix2-5.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5220588071442003`*^9}],

Cell[BoxData["\<\"/tmp/prefix4-6.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058807193166*^9}],

Cell[BoxData["\<\"/tmp/prefix2-6.chart\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.522058807243514*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.1807657793807797563800932039157487452`16.", ",", 
     "0.05848035648577622896970851229525578674`16.", ",", 
     "0.00134210157067490972945811300576224312`16.", ",", 
     "0.000447367190224969945959443418104228840472181873399824384`16.", ",", 
     "0.0002236835951124850000847760211897252702328842133283615112`16.", ",", 
     "0.0000727708834001893132940874675540499083581380546092987061`16."}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.2128228137461468105762207869702251628`16.", ",", 
     "0.1064114068730734052881103934851125814`16.", ",", 
     "0.0006076230695091654112477419502624798`16.", ",", 
     "0.0002025410231697217947142292127082896513456944376230239868`16.", ",", 
     "0.0001012705115848608973571146063541448256728472188115119934`16.", ",", 
     "0.0000329462899892746783649111197433967390679754316806793213`16."}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.2128228137461468105762207869702251628`16.", ",", 
     "0.1064114068730734052881103934851125814`16.", ",", 
     "0.00089357877841980378266772966355802055`16.", ",", 
     "0.0002338818971735107414208765241880882967961952090263366699`16.", ",", 
     "0.0002324517406751749480815771864428143089753575623035430908`16.", ",", 
     "0.0000774839135583916583955438328601417197205591946840286255`16."}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.2128228137461468105762207869702251628`16.", ",", 
     "0.1064114068730734052881103934851125814`16.", ",", 
     "0.03442109740142613311109087703698605765`16.", ",", 
     "0.0001052402018356708186938228144491347393341129645705223083`16.", ",", 
     "0.0001052402018356708186938228144491347393341129645705223083`16.", ",", 
     "0.0000350800672785569350470985527934431047469843178987503052`16."}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.52205836111066*^9, 3.522058807293635*^9}]
}, Open  ]],

Cell["Surprisal", "Subsection",
 CellChangeTimes->{{3.521703998317958*^9, 3.521704004519012*^9}, {
   3.5217040477049227`*^9, 3.521704048514924*^9}, 3.521820915137067*^9, 
   3.52182571620225*^9, 3.522002098322398*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"surp", "[", "l_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ready", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ready", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{"l", ",", "1"}], "]"}]}], ";", "      ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "this", " ", "adds", " ", "the", " ", "probability", " ", "1", " ", 
       "as", " ", "the", " ", "new", " ", "1", "st", " ", "component", " ", 
       "of", " ", "each", " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Differences", "[", 
      RowBox[{"-", 
       RowBox[{"Log2", "[", "ready", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.521243746875893*^9, 3.521243765129139*^9}, 
   3.5212438711179132`*^9, 3.5212948778306828`*^9, {3.5213193867361097`*^9, 
   3.52131940138107*^9}, 3.521319463478368*^9, {3.5213195138337708`*^9, 
   3.521319550772519*^9}, {3.5213196005545797`*^9, 3.521319607811137*^9}, 
   3.5214747306077213`*^9, {3.521704135327537*^9, 3.521704135710116*^9}, {
   3.5217041717354116`*^9, 3.521704179757832*^9}, 3.521704249963914*^9, {
   3.521704596984932*^9, 3.521704602174305*^9}, {3.521704843313448*^9, 
   3.5217048665137663`*^9}, {3.521726085799912*^9, 3.5217260988564*^9}, 
   3.521820915137703*^9, 3.521825716203002*^9, 3.52200209832329*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"surprisals", "=", 
   RowBox[{"surp", "/@", "probs"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.521706288984742*^9, 3.5217063044687557`*^9}, 
   3.521820915137998*^9, 3.521825716203953*^9, 3.522002098323594*^9}],

Cell[CellGroupData[{

Cell[BoxData["surprisals"], "Input",
 CellChangeTimes->{{3.5220584649819613`*^9, 3.522058468884145*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.46780650668315185465801157546844173954`16.23313656601165", ",", 
     "1.62809757736391117171785825431667174601`15.751475895443408", ",", 
     "5.44538634132437529415967911607921299439`16.275824163054786", ",", 
     "1.58496250072115606490718749484298471992`15.73981445690494", ",", 
     "0.99999999999999982518017282634276995936`15.53979546538116", ",", 
     "1.62002622397366317246297681076123371929`15.749317510068773"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "2.23227528467663478041792851264069261803`16.189573211903856", ",", 
     "1.`15.53979546538116", ",", 
     "7.45226044946558657483675284707676445948`16.412083490052638", ",", 
     "1.5849625007211562458099647053153148833`15.73981445690493", ",", 
     "1.`15.53979546538115", ",", 
     "1.62002622397366287677391927540301383541`15.749317510068773"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "2.23227528467663478041792851264069261803`16.189573211903856", ",", 
     "1.`15.53979546538116", ",", 
     "6.89584217117340699966243867804475053014`16.378382778381564", ",", 
     "1.93381472455168777550679394235558444368`15.826210328117135", ",", 
     "0.00884896987488186408840580557814970006`13.486688181989324", ",", 
     "1.58496250072115601322816521597637120636`15.73981445690494"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "2.23227528467663478041792851264069261803`16.189573211903856", ",", 
     "1.`15.53979546538116", ",", 
     "1.62828781148646633137369142553199360904`15.751526637367311", ",", 
     "8.35346336288429330460779773692296173734`16.461662037576247", ",", 
     "0``15.53979546538115", ",", 
     "1.5849625007211563672398109823077065549`15.73981445690494"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.52205847102649*^9, 3.522058807406581*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BarChart", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"surprisals", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", 
     RowBox[{"ChartLabels", "\[Rule]", 
      RowBox[{
       RowBox[{"chinese", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"42", "*", "10"}]}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"subject", "-", 
    RowBox[{"modifying", " ", "conditions"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.522057784939486*^9, 3.522057786105466*^9}, {
  3.522058611022553*^9, 3.522058631827119*^9}, {3.52205997253452*^9, 
  3.522059977533927*^9}, {3.522060072346669*^9, 3.5220600808795443`*^9}, {
  3.522060238799851*^9, 3.522060250460801*^9}, {3.522060363896369*^9, 
  3.5220603871320047`*^9}, {3.5220606365332117`*^9, 3.5220606366686687`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{
     {Opacity[0], PointBox[{{0.4545454545454546, 0.}}]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
       EdgeForm[Opacity[0.7]], 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{0.5454545454545454, 0.}, {1.4545454545454546`, 
              2.467806506683152}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{17.113454545454545`, 109.48800000000003`}, {
             3.6470929678320516`, 117.25598179868683`}}],
           
           StatusArea[#, 
            2.46780650668315185465801157546844173954`16.23313656601165]& ,
           
           TagBoxNote->
            "2.46780650668315185465801157546844173954`16.23313656601165"],
          StyleBox[
          "2.46780650668315185465801157546844173954`16.23313656601165", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[2.46780650668315185465801157546844173954`16.23313656601165, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{1.5454545454545454`, 0.}, {2.4545454545454546`, 
              1.6280975773639113`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{117.62545454545457`, 210.00000000000003`}, {
             41.96399067270025, 117.25598179868683`}}],
           
           StatusArea[#, 
            1.62809757736391117171785825431667174601`15.751475895443408]& ,
           
           TagBoxNote->
            "1.62809757736391117171785825431667174601`15.751475895443408"],
          StyleBox[
          "1.62809757736391117171785825431667174601`15.751475895443408", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[
          1.62809757736391117171785825431667174601`15.751475895443408, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{2.5454545454545454`, 0.}, {3.4545454545454546`, 
              5.445386341324375}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{218.13745454545457`, 
             310.51200000000006`}, {-132.22334731023093`, 
             117.25598179868683`}}],
           
           StatusArea[#, 
            5.44538634132437529415967911607921299439`16.275824163054786]& ,
           
           TagBoxNote->
            "5.44538634132437529415967911607921299439`16.275824163054786"],
          StyleBox[
          "5.44538634132437529415967911607921299439`16.275824163054786", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[
          5.44538634132437529415967911607921299439`16.275824163054786, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{3.5454545454545454`, 0.}, {4.454545454545454, 
              1.584962500721156}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{318.6494545454546, 411.024}, {
             43.932294523597776`, 117.25598179868683`}}],
           
           StatusArea[#, 
            1.58496250072115606490718749484298471992`15.73981445690494]& ,
           
           TagBoxNote->
            "1.58496250072115606490718749484298471992`15.73981445690494"],
          StyleBox[
          "1.58496250072115606490718749484298471992`15.73981445690494", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.58496250072115606490718749484298471992`15.73981445690494, {
            GrayLevel[0]}], 
          "Tooltip"]& ]}}, {}, {}}, {}, {{{{{{{}, {}}, {}}, {{{}, {}}, {}}, \
{{{}, {}}, {}}, {{{}, {}}, {}}}, {}}, {}}, {}}, GraphicsGroupBox[
      {GrayLevel[0], 
       StyleBox[
        GraphicsGroupBox[{
          LineBox[{{{0.5454545454545454, 0.}, 
             Offset[{0, -4}, {0.5454545454545454, 0.}]}, {{4.454545454545454, 
             0.}, Offset[{0, -4}, {4.454545454545454, 0.}]}}], InsetBox[
           PaneBox["\<\"yaoqing\"\>"], Offset[{0, -2}, {1., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"fuhao\"\>"], Offset[{0, -2}, {2., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"de\"\>"], Offset[{0, -2}, {3., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"guanyuan\"\>"], Offset[{0, -2}, {4., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]]}],
        Antialiasing->False]}]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesOrigin->{0.4545454545454546, 0},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    ImageSize->420,
    PlotRangePadding->Scaled[0.02],
    Ticks->{None, Automatic}], ",", 
   GraphicsBox[{
     {Opacity[0], PointBox[{{0.4545454545454546, 0.}}]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
       EdgeForm[Opacity[0.7]], 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{0.5454545454545454, 0.}, {1.4545454545454546`, 
              2.2322752846766347`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{17.11345454545455, 109.48800000000003`}, {
             41.82564366381321, 117.25598179868678`}}],
           
           StatusArea[#, 
            2.23227528467663478041792851264069261803`16.189573211903856]& ,
           
           TagBoxNote->
            "2.23227528467663478041792851264069261803`16.189573211903856"],
          StyleBox[
          "2.23227528467663478041792851264069261803`16.189573211903856", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[
          2.23227528467663478041792851264069261803`16.189573211903856, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{1.5454545454545454`, 0.}, {2.4545454545454546`, 
              1.}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{117.62545454545457`, 210.00000000000003`}, {
             82.91316846119311, 117.25598179868678`}}],
           StatusArea[#, 1.`15.53979546538116]& ,
           TagBoxNote->"1.`15.53979546538116"],
          StyleBox["1.`15.53979546538116", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.`15.53979546538116, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{2.5454545454545454`, 0.}, {3.4545454545454546`, 
              7.452260449465586}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{218.13745454545457`, 
             310.51200000000006`}, {-132.22334731023093`, 
             117.25598179868678`}}],
           
           StatusArea[#, 
            7.45226044946558657483675284707676445948`16.412083490052638]& ,
           
           TagBoxNote->
            "7.45226044946558657483675284707676445948`16.412083490052638"],
          StyleBox[
          "7.45226044946558657483675284707676445948`16.412083490052638", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[
          7.45226044946558657483675284707676445948`16.412083490052638, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{3.5454545454545454`, 0.}, {4.454545454545454, 
              1.5849625007211563`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{318.6494545454546, 411.024}, {63.40887299021409,
              117.25598179868678`}}],
           
           StatusArea[#, 
            1.5849625007211562458099647053153148833`15.73981445690493]& ,
           
           TagBoxNote->
            "1.5849625007211562458099647053153148833`15.73981445690493"],
          StyleBox[
          "1.5849625007211562458099647053153148833`15.73981445690493", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.5849625007211562458099647053153148833`15.73981445690493, {
            GrayLevel[0]}], 
          "Tooltip"]& ]}}, {}, {}}, {}, {{{{{{{}, {}}, {}}, {{{}, {}}, {}}, \
{{{}, {}}, {}}, {{{}, {}}, {}}}, {}}, {}}, {}}, GraphicsGroupBox[
      {GrayLevel[0], 
       StyleBox[
        GraphicsGroupBox[{
          LineBox[{{{0.5454545454545454, 0.}, 
             Offset[{0, -4}, {0.5454545454545454, 0.}]}, {{4.454545454545454, 
             0.}, Offset[{0, -4}, {4.454545454545454, 0.}]}}], InsetBox[
           PaneBox["\<\"fuhao\"\>"], Offset[{0, -2}, {1., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"yaoqing\"\>"], Offset[{0, -2}, {2., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"de\"\>"], Offset[{0, -2}, {3., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"guanyuan\"\>"], Offset[{0, -2}, {4., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]]}],
        Antialiasing->False]}]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesOrigin->{0.4545454545454546, 0},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    ImageSize->420,
    PlotRangePadding->Scaled[0.02],
    Ticks->{None, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.522060082850436*^9, {3.522060244998208*^9, 3.522060254516371*^9}, 
   3.522060389552251*^9, 3.522060638559842*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BarChart", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"surprisals", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"3", ";;", "6"}], "]"}], "]"}], ",", 
     RowBox[{"ChartLabels", "\[Rule]", 
      RowBox[{
       RowBox[{"chinese", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;", "6"}], "]"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"42", "*", "10"}]}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"3", ",", "4"}], "}"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"object", "-", 
    RowBox[{"modifying", " ", "conditions"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.52206055848295*^9, 3.522060563400968*^9}, {
  3.522060625855204*^9, 3.522060632156866*^9}, {3.52206067983578*^9, 
  3.522060679961877*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{
     {Opacity[0], PointBox[{{0.4545454545454546, 0.}}]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
       EdgeForm[Opacity[0.7]], 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{0.5454545454545454, 0.}, {1.4545454545454546`, 
              6.895842171173407}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{17.113454545454545`, 
             109.48800000000003`}, {-130.2468590803218, 119.23247002859591`}}],
           
           StatusArea[#, 
            6.89584217117340699966243867804475053014`16.378382778381564]& ,
           
           TagBoxNote->
            "6.89584217117340699966243867804475053014`16.378382778381564"],
          StyleBox[
          "6.89584217117340699966243867804475053014`16.378382778381564", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[
          6.89584217117340699966243867804475053014`16.378382778381564, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{1.5454545454545454`, 0.}, {2.4545454545454546`, 
              1.9338147245516877`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{117.62545454545457`, 210.00000000000003`}, {
             48.55091794983292, 119.23247002859591`}}],
           
           StatusArea[#, 
            1.93381472455168777550679394235558444368`15.826210328117135]& ,
           
           TagBoxNote->
            "1.93381472455168777550679394235558444368`15.826210328117135"],
          StyleBox[
          "1.93381472455168777550679394235558444368`15.826210328117135", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[
          1.93381472455168777550679394235558444368`15.826210328117135, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{2.5454545454545454`, 0.}, {3.4545454545454546`, 
              0.008848969874881865}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{218.13745454545457`, 310.51200000000006`}, {
             117.91361323877447`, 119.23247002859591`}}],
           
           StatusArea[#, 
            0.00884896987488186408840580557814970006`13.486688181989324]& ,
           
           TagBoxNote->
            "0.00884896987488186408840580557814970006`13.486688181989324"],
          StyleBox[
          "0.00884896987488186408840580557814970006`13.486688181989324", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[
          0.00884896987488186408840580557814970006`13.486688181989324, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{3.5454545454545454`, 0.}, {4.454545454545454, 
              1.584962500721156}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{318.6494545454546, 411.024}, {61.12118339151057,
              119.23247002859591`}}],
           
           StatusArea[#, 
            1.58496250072115601322816521597637120636`15.73981445690494]& ,
           
           TagBoxNote->
            "1.58496250072115601322816521597637120636`15.73981445690494"],
          StyleBox[
          "1.58496250072115601322816521597637120636`15.73981445690494", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.58496250072115601322816521597637120636`15.73981445690494, {
            GrayLevel[0]}], 
          "Tooltip"]& ]}}, {}, {}}, {}, {{{{{{{}, {}}, {}}, {{{}, {}}, {}}, \
{{{}, {}}, {}}, {{{}, {}}, {}}}, {}}, {}}, {}}, GraphicsGroupBox[
      {GrayLevel[0], 
       StyleBox[
        GraphicsGroupBox[{
          LineBox[{{{0.5454545454545454, 0.}, 
             Offset[{0, -4}, {0.5454545454545454, 0.}]}, {{4.454545454545454, 
             0.}, Offset[{0, -4}, {4.454545454545454, 0.}]}}], InsetBox[
           PaneBox["\<\"yaoqing\"\>"], Offset[{0, -2}, {1., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"fuhao\"\>"], Offset[{0, -2}, {2., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"de\"\>"], Offset[{0, -2}, {3., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"guanyuan\"\>"], Offset[{0, -2}, {4., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]]}],
        Antialiasing->False]}]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesOrigin->{0.4545454545454546, 0},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    ImageSize->420,
    PlotRangePadding->Scaled[0.02],
    Ticks->{None, Automatic}], ",", 
   GraphicsBox[{
     {Opacity[0], PointBox[{{0.4545454545454546, 0.}}]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
       EdgeForm[Opacity[0.7]], 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{0.5454545454545454, 0.}, {1.4545454545454546`, 
              1.6282878114864663`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{17.113454545454537`, 109.488}, {
             67.82147680138637, 117.25598179868675`}}],
           
           StatusArea[#, 
            1.62828781148646633137369142553199360904`15.751526637367311]& ,
           
           TagBoxNote->
            "1.62828781148646633137369142553199360904`15.751526637367311"],
          StyleBox[
          "1.62828781148646633137369142553199360904`15.751526637367311", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[
          1.62828781148646633137369142553199360904`15.751526637367311, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{1.5454545454545454`, 0.}, {2.4545454545454546`, 
              8.353463362884293}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{117.62545454545455`, 210.}, {-132.2233473102309,
              117.25598179868675`}}],
           
           StatusArea[#, 
            8.35346336288429330460779773692296173734`16.461662037576247]& ,
           
           TagBoxNote->
            "8.35346336288429330460779773692296173734`16.461662037576247"],
          StyleBox[
          "8.35346336288429330460779773692296173734`16.461662037576247", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[
          8.35346336288429330460779773692296173734`16.461662037576247, {
            GrayLevel[0]}], "Tooltip"]& ]}, {}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{3.5454545454545454`, 0.}, {4.454545454545454, 
              1.5849625007211563`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{318.64945454545455`, 411.02399999999994`}, {
             69.1102170142461, 117.25598179868675`}}],
           
           StatusArea[#, 
            1.5849625007211563672398109823077065549`15.73981445690494]& ,
           
           TagBoxNote->
            "1.5849625007211563672398109823077065549`15.73981445690494"],
          StyleBox[
          "1.5849625007211563672398109823077065549`15.73981445690494", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.5849625007211563672398109823077065549`15.73981445690494, {
            GrayLevel[0]}], 
          "Tooltip"]& ]}}, {}, {}}, {}, {{{{{{{}, {}}, {}}, {{{}, {}}, {}}, \
{}, {{{}, {}}, {}}}, {}}, {}}, {}}, GraphicsGroupBox[
      {GrayLevel[0], 
       StyleBox[
        GraphicsGroupBox[{
          LineBox[{{{0.5454545454545454, 0.}, 
             Offset[{0, -4}, {0.5454545454545454, 0.}]}, {{4.454545454545454, 
             0.}, Offset[{0, -4}, {4.454545454545454, 0.}]}}], InsetBox[
           PaneBox["\<\"fuhao\"\>"], Offset[{0, -2}, {1., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"yaoqing\"\>"], Offset[{0, -2}, {2., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"de\"\>"], Offset[{0, -2}, {3., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"guanyuan\"\>"], Offset[{0, -2}, {4., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]]}],
        Antialiasing->False]}]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesOrigin->{0.4545454545454546, 0},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    ImageSize->420,
    PlotRangePadding->Scaled[0.02],
    Ticks->{None, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{3.522060682944441*^9}]
}, Open  ]],

Cell["Entropy Reduction", "Subsection",
 CellChangeTimes->{{3.521703998317958*^9, 3.521704004519012*^9}, 
   3.5218209151382113`*^9, 3.521825716205023*^9, 3.5220020983238163`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"reductions", "[", "l_List", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Max", "[", 
     RowBox[{"0", ",", "#"}], "]"}], "&"}], "/@", " ", 
   RowBox[{"-", 
    RowBox[{"Differences", "[", "l", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.521243746875893*^9, 3.521243765129139*^9}, 
   3.5212438711179132`*^9, 3.5212948778306828`*^9, {3.5213193867361097`*^9, 
   3.52131940138107*^9}, 3.521319463478368*^9, {3.5213195138337708`*^9, 
   3.521319550772519*^9}, {3.5213196005545797`*^9, 3.521319607811137*^9}, 
   3.5214747306077213`*^9, 3.521820915138681*^9, 3.5218257162055492`*^9, 
   3.522002098324295*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"postprocess", "[", "results_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "unconditioned", "}"}], ",", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "this", " ", "adds", " ", "the", " ", "unconditional", " ", "entropy", 
      " ", "as", " ", "the", " ", "new", " ", "1", "st", " ", "component", 
      " ", "of", " ", "each", " ", "list"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"unconditioned", " ", "=", " ", 
      RowBox[{
      "oldStyle", "[", "\"\<grammars/wmcfg/chinese.wmcfg\>\"", "]"}]}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"change", " ", 
        RowBox[{"me", "!"}]}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{"#", ",", "unconditioned"}], "]"}], "&"}], "/@", 
      "results"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.521649399660924*^9, 3.52164947308147*^9}, {
   3.521650055725163*^9, 3.521650064965631*^9}, 3.5216501724952593`*^9, {
   3.521704647839357*^9, 3.521704652880988*^9}, {3.521707065936427*^9, 
   3.521707067943473*^9}, {3.521726068763345*^9, 3.521726082735437*^9}, {
   3.521728593419773*^9, 3.521728593894904*^9}, {3.52181993679733*^9, 
   3.521819939852838*^9}, 3.5218257162068777`*^9, {3.521828345783763*^9, 
   3.521828348649109*^9}, {3.521875614709317*^9, 3.521875629725123*^9}, {
   3.521976471136793*^9, 3.521976474540029*^9}, {3.521978245360805*^9, 
   3.521978250333658*^9}, {3.5219923562239122`*^9, 3.521992365845804*^9}, {
   3.52199276364554*^9, 3.5219927650431557`*^9}, 3.522001516633965*^9, 
   3.522002098325742*^9, {3.522057759502054*^9, 3.522057760788002*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"entropyreductions", "=", 
   RowBox[{"reductions", "/@", " ", 
    RowBox[{"postprocess", "[", "ents", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5217287109167624`*^9, 3.521728746505842*^9}, {
   3.5218199478269653`*^9, 3.52181994824179*^9}, 3.5218257162078247`*^9, 
   3.52182788615578*^9, 3.52200209833082*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Greater", "::", "nord"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Invalid comparison with \
\[NoBreak]\\!\\(\\(\\(-0.11931745135103794`\\)\\) + \
\\(\\(0.20666388796962556`\\\\ \[ImaginaryI]\\)\\)\\)\[NoBreak] attempted. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/nord\\\", \
ButtonNote -> \\\"Greater::nord\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.5220578362409067`*^9, 3.5220588081092777`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["entropyreductions"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.89825094299733`", ",", "1.7119236473528072`", ",", "0", ",", 
     "1.584962500721156`", ",", "1.`", ",", "1.7092250054448181`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "1.9278379839692823`", ",", "1.0000000000000004`", ",", "0", ",", 
     "1.584962500721156`", ",", "1.`", ",", "1.7092250054448181`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "1.9278379839692823`", ",", "1.0000000000000004`", ",", "0", ",", 
     "1.9024791653494857`", ",", "0.2162972199769122`", ",", 
     "1.584962500721156`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.9278379839692823`", ",", "1.0000000000000004`", ",", 
     "1.8513759191804666`", ",", "0", ",", "0.`", ",", "1.584962500721156`"}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.522060784448387*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BarChart", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"entropyreductions", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", 
     RowBox[{"ChartLabels", "\[Rule]", 
      RowBox[{
       RowBox[{"chinese", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"42", "*", "10"}]}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}], 
  RowBox[{"(*", " ", 
   RowBox[{"subject", "-", 
    RowBox[{"modifying", " ", "conditions"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5218280685128937`*^9, 3.521828091360756*^9}, {
   3.521828963450851*^9, 3.521828978432322*^9}, {3.5218291908366823`*^9, 
   3.521829190937614*^9}, {3.521910433453793*^9, 3.5219104337898273`*^9}, 
   3.522002098331236*^9, {3.522057746036166*^9, 3.522057747043853*^9}, {
   3.522059900964492*^9, 3.522059923616953*^9}, {3.522060604935816*^9, 
   3.522060645115445*^9}, {3.522060808571081*^9, 3.522060827818614*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{
     {Opacity[0], PointBox[{{0.4545454545454546, 0.}}]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
       EdgeForm[Opacity[0.7]], 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{0.5454545454545454, 0.}, {1.4545454545454546`, 
              2.89825094299733}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{24.469944341372912`, 
             115.16938775510208`}, {-130.31824705985034`, 
             114.60589406733263`}}],
           StatusArea[#, 2.89825094299733]& ,
           TagBoxNote->"2.89825094299733"],
          StyleBox["2.89825094299733`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[2.89825094299733, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{1.5454545454545454`, 0.}, {2.4545454545454546`, 
              1.7119236473528072`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{123.13933209647497`, 
             213.83877551020413`}, {-30.47393668879684, 114.60589406733263`}}],
           StatusArea[#, 1.7119236473528072`]& ,
           TagBoxNote->"1.7119236473528072"],
          StyleBox["1.7119236473528072`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.7119236473528072`, {
            GrayLevel[0]}], "Tooltip"]& ]}, {}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{3.5454545454545454`, 0.}, {4.454545454545454, 
              1.584962500721156}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{320.47810760667915`, 
             411.17755102040826`}, {-19.788564974013497`, 
             114.60589406733263`}}],
           StatusArea[#, 1.584962500721156]& ,
           TagBoxNote->"1.584962500721156"],
          StyleBox["1.584962500721156`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.584962500721156, {
            GrayLevel[0]}], 
          "Tooltip"]& ]}}, {}, {}}, {}, {{{{{{{}, {}}, {}}, {{{}, {}}, {}}, \
{}, {{{}, {}}, {}}}, {}}, {}}, {}}, GraphicsGroupBox[
      {GrayLevel[0], 
       StyleBox[
        GraphicsGroupBox[{
          LineBox[{{{0.5454545454545454, 0.}, 
             Offset[{0, -4}, {0.5454545454545454, 0.}]}, {{4.454545454545454, 
             0.}, Offset[{0, -4}, {4.454545454545454, 0.}]}}], InsetBox[
           PaneBox["\<\"yaoqing\"\>"], Offset[{0, -2}, {1., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"fuhao\"\>"], Offset[{0, -2}, {2., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"de\"\>"], Offset[{0, -2}, {3., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"guanyuan\"\>"], Offset[{0, -2}, {4., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]]}],
        Antialiasing->False]}]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesOrigin->{0.4545454545454546, 0},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    ImageSize->420,
    PlotRangePadding->Scaled[0.02],
    Ticks->{None, Automatic}], ",", 
   GraphicsBox[{
     {Opacity[0], PointBox[{{0.4545454545454546, 0.}}]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
       EdgeForm[Opacity[0.7]], 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{0.5454545454545454, 0.}, {1.4545454545454546`, 
              1.9278379839692823`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{24.469944341372912`, 
             115.16938775510208`}, {-130.3182470598503, 114.60589406733266`}}],
           StatusArea[#, 1.9278379839692823`]& ,
           TagBoxNote->"1.9278379839692823"],
          StyleBox["1.9278379839692823`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.9278379839692823`, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{1.5454545454545454`, 0.}, {2.4545454545454546`, 
              1.0000000000000004`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{123.13933209647497`, 
             213.83877551020413`}, {-12.921409137348732`, 
             114.60589406733267`}}],
           StatusArea[#, 1.0000000000000004`]& ,
           TagBoxNote->"1.0000000000000004"],
          StyleBox["1.0000000000000004`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.0000000000000004`, {
            GrayLevel[0]}], "Tooltip"]& ]}, {}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{3.5454545454545454`, 0.}, {4.454545454545454, 
              1.584962500721156}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{320.47810760667915`, 
             411.17755102040826`}, {-86.93513682946302, 114.60589406733267`}}],
           StatusArea[#, 1.584962500721156]& ,
           TagBoxNote->"1.584962500721156"],
          StyleBox["1.584962500721156`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.584962500721156, {
            GrayLevel[0]}], 
          "Tooltip"]& ]}}, {}, {}}, {}, {{{{{{{}, {}}, {}}, {{{}, {}}, {}}, \
{}, {{{}, {}}, {}}}, {}}, {}}, {}}, GraphicsGroupBox[
      {GrayLevel[0], 
       StyleBox[
        GraphicsGroupBox[{
          LineBox[{{{0.5454545454545454, 0.}, 
             Offset[{0, -4}, {0.5454545454545454, 0.}]}, {{4.454545454545454, 
             0.}, Offset[{0, -4}, {4.454545454545454, 0.}]}}], InsetBox[
           PaneBox["\<\"fuhao\"\>"], Offset[{0, -2}, {1., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"yaoqing\"\>"], Offset[{0, -2}, {2., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"de\"\>"], Offset[{0, -2}, {3., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"guanyuan\"\>"], Offset[{0, -2}, {4., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]]}],
        Antialiasing->False]}]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesOrigin->{0.4545454545454546, 0},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    ImageSize->420,
    PlotRangePadding->Scaled[0.02],
    Ticks->{None, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5220578365031977`*^9, 3.522058808331648*^9, {3.522059901927114*^9, 
   3.522059925147438*^9}, 3.522060649413903*^9, 3.52206082918638*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BarChart", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"entropyreductions", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"3", ";;", "6"}], "]"}], "]"}], ",", 
     RowBox[{"ChartLabels", "\[Rule]", 
      RowBox[{
       RowBox[{"chinese", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;", "6"}], "]"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"42", "*", "10"}]}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"3", ",", "4"}], "}"}], 
  RowBox[{"(*", " ", 
   RowBox[{"object", "-", 
    RowBox[{"modifying", " ", "conditions"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5220608449929953`*^9, 3.522060857846695*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{
     {Opacity[0], PointBox[{{0.4545454545454546, 0.}}]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
       EdgeForm[Opacity[0.7]], {}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{1.5454545454545454`, 0.}, {2.4545454545454546`, 
              1.9024791653494857`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{123.13933209647496`, 
             213.83877551020413`}, {-130.31824705985036`, 
             114.60589406733257`}}],
           StatusArea[#, 1.9024791653494857`]& ,
           TagBoxNote->"1.9024791653494857"],
          StyleBox["1.9024791653494857`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.9024791653494857`, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{2.5454545454545454`, 0.}, {3.4545454545454546`, 
              0.2162972199769122}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{221.80871985157702`, 312.5081632653062}, {
             85.87359897995188, 114.60589406733257`}}],
           StatusArea[#, 0.2162972199769122]& ,
           TagBoxNote->"0.2162972199769122"],
          StyleBox["0.2162972199769122`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[0.2162972199769122, {
            GrayLevel[0]}], "Tooltip"]& ]}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{3.5454545454545454`, 0.}, {4.454545454545454, 
              1.584962500721156}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{320.47810760667915`, 
             411.17755102040826`}, {-89.6082192584129, 114.60589406733257`}}],
           
           StatusArea[#, 1.584962500721156]& ,
           TagBoxNote->"1.584962500721156"],
          StyleBox["1.584962500721156`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.584962500721156, {
            GrayLevel[0]}], 
          "Tooltip"]& ]}}, {}, {}}, {}, {{{{{}, {{{}, {}}, {}}, {{{}, {}}, \
{}}, {{{}, {}}, {}}}, {}}, {}}, {}}, GraphicsGroupBox[
      {GrayLevel[0], 
       StyleBox[
        GraphicsGroupBox[{
          LineBox[{{{0.5454545454545454, 0.}, 
             Offset[{0, -4}, {0.5454545454545454, 0.}]}, {{4.454545454545454, 
             0.}, Offset[{0, -4}, {4.454545454545454, 0.}]}}], InsetBox[
           PaneBox["\<\"yaoqing\"\>"], Offset[{0, -2}, {1., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"fuhao\"\>"], Offset[{0, -2}, {2., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"de\"\>"], Offset[{0, -2}, {3., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"guanyuan\"\>"], Offset[{0, -2}, {4., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]]}],
        Antialiasing->False]}]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesOrigin->{0.4545454545454546, 0},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    ImageSize->420,
    PlotRangePadding->Scaled[0.02],
    Ticks->{None, Automatic}], ",", 
   GraphicsBox[{
     {Opacity[0], PointBox[{{0.4545454545454546, 0.}}]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
       EdgeForm[Opacity[0.7]], 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{0.5454545454545454, 0.}, {1.4545454545454546`, 
              1.8513759191804666`}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{24.469944341372923`, 
             115.1693877551021}, {-130.31824705985036`, 114.60589406733268`}}],
           StatusArea[#, 1.8513759191804666`]& ,
           TagBoxNote->"1.8513759191804666"],
          StyleBox["1.8513759191804666`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.8513759191804666`, {
            GrayLevel[0]}], "Tooltip"]& ]}, {}, {}, 
       {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
        EdgeForm[Opacity[0.7]], 
        TagBox[
         TooltipBox[
          TagBox[
           DynamicBox[{
             FEPrivate`If[
              CurrentValue["MouseOver"], 
              EdgeForm[{
                GrayLevel[0.5], 
                AbsoluteThickness[1.5], 
                Opacity[0.66]}], {}, {}], 
             
             RectangleBox[{3.5454545454545454`, 0.}, {4.454545454545454, 
              1.584962500721156}, "RoundingRadius" -> 0]},
            
            ImageSizeCache->{{320.4781076066792, 
             411.1775510204084}, {-95.21750732936366, 114.60589406733268`}}],
           StatusArea[#, 1.584962500721156]& ,
           TagBoxNote->"1.584962500721156"],
          StyleBox["1.584962500721156`", {
            GrayLevel[0]}, StripOnInput -> False]],
         Annotation[#, 
          Style[1.584962500721156, {
            GrayLevel[0]}], 
          "Tooltip"]& ]}}, {}, {}}, {}, {{{{{{{}, {}}, {}}, {}, {}, {{{}, \
{}}, {}}}, {}}, {}}, {}}, GraphicsGroupBox[
      {GrayLevel[0], 
       StyleBox[
        GraphicsGroupBox[{
          LineBox[{{{0.5454545454545454, 0.}, 
             Offset[{0, -4}, {0.5454545454545454, 0.}]}, {{4.454545454545454, 
             0.}, Offset[{0, -4}, {4.454545454545454, 0.}]}}], InsetBox[
           PaneBox["\<\"fuhao\"\>"], Offset[{0, -2}, {1., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"yaoqing\"\>"], Offset[{0, -2}, {2., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"de\"\>"], Offset[{0, -2}, {3., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]], InsetBox[
           PaneBox["\<\"guanyuan\"\>"], Offset[{0, -2}, {4., 0.}], 
           ImageScaled[{Rational[1, 2], 1}]]}],
        Antialiasing->False]}]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesOrigin->{0.4545454545454546, 0},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    ImageSize->420,
    PlotRangePadding->Scaled[0.02],
    Ticks->{None, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{3.522060859919355*^9}]
}, Open  ]],

Cell["Word-by-Word Comparison", "Subsection",
 CellChangeTimes->{{3.521703998317958*^9, 3.521704004519012*^9}, {
   3.521706327599328*^9, 3.521706328442132*^9}, {3.521724929124468*^9, 
   3.521724931256426*^9}, 3.521825716308092*^9, 3.522002098360869*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PairedBarChart", "[", 
  RowBox[{
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"surprisals", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "Orange"}], "]"}], ",", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"surprisals", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "Purple"}], "]"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"72", "*", "10"}]}], ",", 
   RowBox[{"ChartLabels", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<V1(SR) N1(OR)\>\"", ",", " ", "\"\<N1(SR) V1(OR)\>\"", ",", 
      "\"\<DE\>\"", ",", "\"\<N2(head)\>\""}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.521704683011252*^9, 3.52170472324225*^9}, {
   3.5217050406819763`*^9, 3.5217050544412117`*^9}, {3.5217051188253393`*^9, 
   3.521705145690246*^9}, {3.5217051898346767`*^9, 3.5217052266607018`*^9}, {
   3.521705295930417*^9, 3.521705306717448*^9}, {3.521705465794045*^9, 
   3.521705468382613*^9}, {3.521705586782785*^9, 3.5217056030073347`*^9}, {
   3.521705648950656*^9, 3.521705673187108*^9}, {3.5217057049074697`*^9, 
   3.521705716323905*^9}, {3.521705759211151*^9, 3.521705859185699*^9}, {
   3.521706332335395*^9, 3.521706355006834*^9}, {3.521706509968178*^9, 
   3.521706611832981*^9}, {3.521707187545876*^9, 3.521707215108493*^9}, {
   3.5217287701094027`*^9, 3.5217287732525*^9}, 3.521825716308826*^9, {
   3.5219123657125683`*^9, 3.521912393065675*^9}, {3.5219126061075277`*^9, 
   3.521912610553833*^9}, {3.5220003794799843`*^9, 3.522000386451305*^9}, 
   3.522002098361518*^9, {3.522057751676754*^9, 3.522057752324497*^9}, {
   3.522058753120021*^9, 3.522058757339851*^9}, {3.522061256641879*^9, 
   3.5220612593249187`*^9}, {3.522061293788055*^9, 3.522061403500278*^9}, {
   3.522061472604332*^9, 3.52206160353541*^9}, {3.5220617008676777`*^9, 
   3.522061752846442*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
    EdgeForm[Opacity[0.7]], {{}, {{{}, {{}, {{}, {
          {RGBColor[1, 0.5, 0], EdgeForm[Opacity[0.7]], 
           TagBox[
            TooltipBox[
             TagBox[
              DynamicBox[{
                FEPrivate`If[
                 CurrentValue["MouseOver"], 
                 EdgeForm[{
                   GrayLevel[0.5], 
                   AbsoluteThickness[1.5], 
                   Opacity[0.66]}], {}, {}], 
                
                RectangleBox[{-2.7658969246617753`, 
                 0.1433333333333333}, {-0.29809041797862346`, 
                 1.1433333333333333`}, "RoundingRadius" -> 0]},
               
               ImageSizeCache->{{236.75927488904995`, 346.8256880733945}, {
                101.00285857509358`, 197.11558045322545`}}],
              
              StatusArea[#, 
               2.46780650668315185465801157546844173954`16.23313656601165]& ,
              
              TagBoxNote->
               "2.46780650668315185465801157546844173954`16.23313656601165"],
             StyleBox[
             "2.46780650668315185465801157546844173954`16.23313656601165", {
               GrayLevel[0]}, StripOnInput -> False]],
            Annotation[#, 
             Style[
             2.46780650668315185465801157546844173954`16.23313656601165, {
               GrayLevel[0]}], "Tooltip"]& ]}, 
          {RGBColor[1, 0.5, 0], EdgeForm[Opacity[0.7]], 
           TagBox[
            TooltipBox[
             TagBox[
              DynamicBox[{
                FEPrivate`If[
                 CurrentValue["MouseOver"], 
                 EdgeForm[{
                   GrayLevel[0.5], 
                   AbsoluteThickness[1.5], 
                   Opacity[0.66]}], {}, {}], 
                
                RectangleBox[{-1.9261879953425347`, 
                 1.2433333333333334`}, {-0.29809041797862346`, 
                 2.243333333333333}, "RoundingRadius" -> 0]},
               
               ImageSizeCache->{{273.87079104385947`, 
                346.8256880733945}, {-3.6211354908514863`, 
                92.49158638728038}}],
              
              StatusArea[#, 
               1.62809757736391117171785825431667174601`15.751475895443408]& ,
              
              
              TagBoxNote->
               "1.62809757736391117171785825431667174601`15.751475895443408"],
             
             StyleBox[
             "1.62809757736391117171785825431667174601`15.751475895443408", {
               GrayLevel[0]}, StripOnInput -> False]],
            Annotation[#, 
             Style[
             1.62809757736391117171785825431667174601`15.751475895443408, {
               GrayLevel[0]}], "Tooltip"]& ]}, 
          {RGBColor[1, 0.5, 0], EdgeForm[Opacity[0.7]], 
           TagBox[
            TooltipBox[
             TagBox[
              DynamicBox[{
                FEPrivate`If[
                 CurrentValue["MouseOver"], 
                 EdgeForm[{
                   GrayLevel[0.5], 
                   AbsoluteThickness[1.5], 
                   Opacity[0.66]}], {}, {}], 
                
                RectangleBox[{-5.7434767593029985`, 
                 2.3433333333333333`}, {-0.29809041797862346`, 
                 3.3433333333333333`}, "RoundingRadius" -> 0]},
               
               ImageSizeCache->{{105.1630773529487, 
                346.8256880733945}, {-108.24512955679654`, \
-12.132407678664663`}}],
              
              StatusArea[#, 
               5.44538634132437529415967911607921299439`16.275824163054786]& ,
              
              
              TagBoxNote->
               "5.44538634132437529415967911607921299439`16.275824163054786"],
             
             StyleBox[
             "5.44538634132437529415967911607921299439`16.275824163054786", {
               GrayLevel[0]}, StripOnInput -> False]],
            Annotation[#, 
             Style[
             5.44538634132437529415967911607921299439`16.275824163054786, {
               GrayLevel[0]}], "Tooltip"]& ]}, 
          {RGBColor[1, 0.5, 0], EdgeForm[Opacity[0.7]], 
           TagBox[
            TooltipBox[
             TagBox[
              DynamicBox[{
                FEPrivate`If[
                 CurrentValue["MouseOver"], 
                 EdgeForm[{
                   GrayLevel[0.5], 
                   AbsoluteThickness[1.5], 
                   Opacity[0.66]}], {}, {}], 
                
                RectangleBox[{-1.8830529186997795`, 
                 3.4433333333333334`}, {-0.29809041797862346`, 
                 4.443333333333333}, "RoundingRadius" -> 0]},
               
               ImageSizeCache->{{275.777175551363, 
                346.8256880733945}, {-212.8691236227416, \
-116.75640174460972`}}],
              
              StatusArea[#, 
               1.58496250072115606490718749484298471992`15.73981445690494]& ,
              
              TagBoxNote->
               "1.58496250072115606490718749484298471992`15.73981445690494"],
             StyleBox[
             "1.58496250072115606490718749484298471992`15.73981445690494", {
               GrayLevel[0]}, StripOnInput -> False]],
            Annotation[#, 
             Style[
             1.58496250072115606490718749484298471992`15.73981445690494, {
               GrayLevel[0]}], 
             "Tooltip"]& ]}}}, {}, {}}, {}, {}}, {{}, {{}, {{}, {
          {RGBColor[0.5, 0, 0.5], EdgeForm[Opacity[0.7]], 
           TagBox[
            TooltipBox[
             TagBox[
              DynamicBox[{
                FEPrivate`If[
                 CurrentValue["MouseOver"], 
                 EdgeForm[{
                   GrayLevel[0.5], 
                   AbsoluteThickness[1.5], 
                   Opacity[0.66]}], {}, {}], 
                
                RectangleBox[{0.29809041797862346`, 0.1433333333333333}, {
                 2.530365702655258, 1.1433333333333333`}, "RoundingRadius" -> 
                 0]},
               
               ImageSizeCache->{{372.1743119266055, 471.8312600626943}, {
                101.00285857509358`, 197.11558045322545`}}],
              
              StatusArea[#, 
               2.23227528467663478041792851264069261803`16.189573211903856]& ,
              
              
              TagBoxNote->
               "2.23227528467663478041792851264069261803`16.189573211903856"],
             
             StyleBox[
             "2.23227528467663478041792851264069261803`16.189573211903856", {
               GrayLevel[0]}, StripOnInput -> False]],
            Annotation[#, 
             Style[
             2.23227528467663478041792851264069261803`16.189573211903856, {
               GrayLevel[0]}], "Tooltip"]& ]}, 
          {RGBColor[0.5, 0, 0.5], EdgeForm[Opacity[0.7]], 
           TagBox[
            TooltipBox[
             TagBox[
              DynamicBox[{
                FEPrivate`If[
                 CurrentValue["MouseOver"], 
                 EdgeForm[{
                   GrayLevel[0.5], 
                   AbsoluteThickness[1.5], 
                   Opacity[0.66]}], {}, {}], 
                
                RectangleBox[{0.29809041797862346`, 1.2433333333333334`}, {
                 1.2980904179786235`, 2.243333333333333}, "RoundingRadius" -> 
                 0]},
               
               ImageSizeCache->{{372.1743119266055, 
                417.370002670178}, {-3.6211354908514863`, 92.49158638728038}}],
              StatusArea[#, 1.`15.53979546538116]& ,
              TagBoxNote->"1.`15.53979546538116"],
             StyleBox["1.`15.53979546538116", {
               GrayLevel[0]}, StripOnInput -> False]],
            Annotation[#, 
             Style[1.`15.53979546538116, {
               GrayLevel[0]}], "Tooltip"]& ]}, 
          {RGBColor[0.5, 0, 0.5], EdgeForm[Opacity[0.7]], 
           TagBox[
            TooltipBox[
             TagBox[
              DynamicBox[{
                FEPrivate`If[
                 CurrentValue["MouseOver"], 
                 EdgeForm[{
                   GrayLevel[0.5], 
                   AbsoluteThickness[1.5], 
                   Opacity[0.66]}], {}, {}], 
                
                RectangleBox[{0.29809041797862346`, 2.3433333333333333`}, {
                 7.75035086744421, 3.3433333333333333`}, "RoundingRadius" -> 
                 0]},
               
               ImageSizeCache->{{372.1743119266055, 
                702.5321100917431}, {-108.24512955679654`, \
-12.132407678664663`}}],
              
              StatusArea[#, 
               7.45226044946558657483675284707676445948`16.412083490052638]& ,
              
              TagBoxNote->
               "7.45226044946558657483675284707676445948`16.412083490052638"],
             
             StyleBox[
             "7.45226044946558657483675284707676445948`16.412083490052638", {
               GrayLevel[0]}, StripOnInput -> False]],
            Annotation[#, 
             Style[
             7.45226044946558657483675284707676445948`16.412083490052638, {
               GrayLevel[0]}], "Tooltip"]& ]}, 
          {RGBColor[0.5, 0, 0.5], EdgeForm[Opacity[0.7]], 
           TagBox[
            TooltipBox[
             TagBox[
              DynamicBox[{
                FEPrivate`If[
                 CurrentValue["MouseOver"], 
                 EdgeForm[{
                   GrayLevel[0.5], 
                   AbsoluteThickness[1.5], 
                   Opacity[0.66]}], {}, {}], 
                
                RectangleBox[{0.29809041797862346`, 3.4433333333333334`}, {
                 1.8830529186997798`, 4.443333333333333}, "RoundingRadius" -> 
                 0]},
               
               ImageSizeCache->{{372.1743119266055, 
                443.222824448637}, {-212.8691236227416, \
-116.75640174460972`}}],
              
              StatusArea[#, 
               1.5849625007211562458099647053153148833`15.73981445690493]& ,
              
              TagBoxNote->
               "1.5849625007211562458099647053153148833`15.73981445690493"],
             StyleBox[
             "1.5849625007211562458099647053153148833`15.73981445690493", {
               GrayLevel[0]}, StripOnInput -> False]],
            Annotation[#, 
             Style[1.5849625007211562458099647053153148833`15.73981445690493, {
               GrayLevel[0]}], 
             "Tooltip"]& ]}}}, {}, {}}, {}, {}}}, {}, {}}, {{{{{{{{{{}, {}}, \
{}}, {{{}, {}}, {}}, {{{}, {}}, {}}, {{{}, {}}, {}}}, {}}, {}}, {}}, {}}, \
{{{{{{{{}, {}}, {}}, {{{}, {}}, {}}, {{{}, {}}, {}}, {{{}, {}}, {}}}, {}}, \
{}}, {}}, {}}}, {}}, {}}, 
   StyleBox[{
     StyleBox[{{}, 
       LineBox[{{{-0.29809041797862346`, 0.}, {-8.12296388991749, 0.}}}], {
        DynamicBox[Directive[
          CurrentValue[{GraphicsBoxOptions, TicksStyle}]],
         ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
          4.503599627370496*^15, -4.503599627370496*^15}}], {}, {
         LineBox[{{{-0.29809041797862346`, 0.}, 
            Offset[{0., -5.}, {-0.29809041797862346`, 
             0.}]}, {{-2.2980904179786235`, 0.}, 
            Offset[{0., -5.}, {-2.2980904179786235`, 
             0.}]}, {{-4.2980904179786235`, 0.}, 
            Offset[{0., -5.}, {-4.2980904179786235`, 
             0.}]}, {{-6.2980904179786235`, 0.}, 
            Offset[{0., -5.}, {-6.2980904179786235`, 0.}]}}], 
         LineBox[{{{-0.7980904179786235, 0.}, 
            Offset[{0., -3.}, {-0.7980904179786235, 
             0.}]}, {{-1.2980904179786235`, 0.}, 
            Offset[{0., -3.}, {-1.2980904179786235`, 
             0.}]}, {{-1.7980904179786235`, 0.}, 
            Offset[{0., -3.}, {-1.7980904179786235`, 
             0.}]}, {{-2.7980904179786235`, 0.}, 
            Offset[{0., -3.}, {-2.7980904179786235`, 
             0.}]}, {{-3.2980904179786235`, 0.}, 
            Offset[{0., -3.}, {-3.2980904179786235`, 
             0.}]}, {{-3.798090417978623, 0.}, 
            Offset[{0., -3.}, {-3.798090417978623, 
             0.}]}, {{-4.798090417978624, 0.}, 
            Offset[{0., -3.}, {-4.798090417978624, 
             0.}]}, {{-5.298090417978624, 0.}, 
            Offset[{0., -3.}, {-5.298090417978624, 
             0.}]}, {{-5.7980904179786235`, 0.}, 
            Offset[{0., -3.}, {-5.7980904179786235`, 
             0.}]}, {{-6.7980904179786235`, 0.}, 
            Offset[{0., -3.}, {-6.7980904179786235`, 
             0.}]}, {{-7.2980904179786235`, 0.}, 
            Offset[{0., -3.}, {-7.2980904179786235`, 
             0.}]}, {{-7.798090417978624, 0.}, 
            Offset[{0., -3.}, {-7.798090417978624, 0.}]}}]}, {
         DynamicBox[Directive[
           CurrentValue[{GraphicsBoxOptions, LabelStyle}]],
          
          ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
           4.503599627370496*^15, -4.503599627370496*^15}}], {}, {{
           InsetBox["0", Offset[{0., -8.}, {-0.29809041797862346`, 0.}], {0, 1},
             Automatic, {1, 0}], 
           InsetBox["2", Offset[{0., -8.}, {-2.2980904179786235`, 0.}], {0, 1},
             Automatic, {1, 0}], 
           InsetBox["4", Offset[{0., -8.}, {-4.2980904179786235`, 0.}], {0, 1},
             Automatic, {1, 0}], 
           InsetBox["6", Offset[{0., -8.}, {-6.2980904179786235`, 0.}], {0, 1},
             Automatic, {1, 
            0}]}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}}, {}}}},
      Antialiasing->False], 
     StyleBox[{{}, 
       LineBox[{{{0.29809041797862346`, 0.}, {8.12296388991749, 0.}}}], {
        DynamicBox[Directive[
          CurrentValue[{GraphicsBoxOptions, TicksStyle}]],
         ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
          4.503599627370496*^15, -4.503599627370496*^15}}], {}, {
         LineBox[{{{0.29809041797862346`, 0.}, 
            Offset[{0., -5.}, {0.29809041797862346`, 0.}]}, {{
            2.2980904179786235`, 0.}, 
            Offset[{0., -5.}, {2.2980904179786235`, 0.}]}, {{
            4.2980904179786235`, 0.}, 
            Offset[{0., -5.}, {4.2980904179786235`, 0.}]}, {{
            6.2980904179786235`, 0.}, 
            Offset[{0., -5.}, {6.2980904179786235`, 0.}]}}], 
         LineBox[{{{0.7980904179786235, 0.}, 
            Offset[{0., -3.}, {0.7980904179786235, 0.}]}, {{
            1.2980904179786235`, 0.}, 
            Offset[{0., -3.}, {1.2980904179786235`, 0.}]}, {{
            1.7980904179786235`, 0.}, 
            Offset[{0., -3.}, {1.7980904179786235`, 0.}]}, {{
            2.7980904179786235`, 0.}, 
            Offset[{0., -3.}, {2.7980904179786235`, 0.}]}, {{
            3.2980904179786235`, 0.}, 
            Offset[{0., -3.}, {3.2980904179786235`, 0.}]}, {{
            3.798090417978623, 0.}, 
            Offset[{0., -3.}, {3.798090417978623, 0.}]}, {{4.798090417978624, 
            0.}, Offset[{0., -3.}, {4.798090417978624, 0.}]}, {{
            5.298090417978624, 0.}, 
            Offset[{0., -3.}, {5.298090417978624, 0.}]}, {{
            5.7980904179786235`, 0.}, 
            Offset[{0., -3.}, {5.7980904179786235`, 0.}]}, {{
            6.7980904179786235`, 0.}, 
            Offset[{0., -3.}, {6.7980904179786235`, 0.}]}, {{
            7.2980904179786235`, 0.}, 
            Offset[{0., -3.}, {7.2980904179786235`, 0.}]}, {{
            7.798090417978624, 0.}, 
            Offset[{0., -3.}, {7.798090417978624, 0.}]}}]}, {
         DynamicBox[Directive[
           CurrentValue[{GraphicsBoxOptions, LabelStyle}]],
          
          ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
           4.503599627370496*^15, -4.503599627370496*^15}}], {}, {{
           InsetBox["0", Offset[{0., -8.}, {0.29809041797862346`, 0.}], {0, 1},
             Automatic, {1, 0}], 
           InsetBox["2", Offset[{0., -8.}, {2.2980904179786235`, 0.}], {0, 1},
             Automatic, {1, 0}], 
           InsetBox["4", Offset[{0., -8.}, {4.2980904179786235`, 0.}], {0, 1},
             Automatic, {1, 0}], 
           InsetBox["6", Offset[{0., -8.}, {6.2980904179786235`, 0.}], {0, 1},
             Automatic, {1, 
            0}]}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}}, {}}}},
      Antialiasing->False], {}},
    Deployed->True,
    StripOnInput->False], GraphicsGroupBox[
    StyleBox[
     GraphicsGroupBox[{
       LineBox[{{-0.29809041797862346`, 
        0.1433333333333333}, {-0.29809041797862346`, 4.665500000000001}}], 
       LineBox[{{0.29809041797862346`, 0.1433333333333333}, {
        0.29809041797862346`, 4.665500000000001}}], 
       LineBox[{{-0.23847233438289878`, 
        4.443333333333333}, {-0.29809041797862346`, 4.443333333333333}}], 
       LineBox[{{-0.23847233438289878`, 
        0.1433333333333333}, {-0.29809041797862346`, 0.1433333333333333}}], 
       LineBox[{{-0.26828137618076114`, 
        0.1433333333333333}, {-0.29809041797862346`, 0.1433333333333333}}], 
       LineBox[{{-0.26828137618076114`, 
        4.443333333333333}, {-0.29809041797862346`, 4.443333333333333}}], 
       LineBox[{{0.23847233438289878`, 4.443333333333333}, {
        0.29809041797862346`, 4.443333333333333}}], 
       LineBox[{{0.23847233438289878`, 0.1433333333333333}, {
        0.29809041797862346`, 0.1433333333333333}}], 
       LineBox[{{0.26828137618076114`, 0.1433333333333333}, {
        0.29809041797862346`, 0.1433333333333333}}], 
       LineBox[{{0.26828137618076114`, 4.443333333333333}, {
        0.29809041797862346`, 4.443333333333333}}], 
       InsetBox["\<\"V1(SR) N1(OR)\"\>", {0, 0.6433333333333333}, {0, 0}], 
       InsetBox["\<\"N1(SR) V1(OR)\"\>", {0, 1.7433333333333332`}, {0, 0}], 
       InsetBox["\<\"DE\"\>", {0, 2.8433333333333333`}, {0, 0}], 
       InsetBox["\<\"N2(head)\"\>", {0, 3.9433333333333334`}, {0, 0}]}],
     Antialiasing->False]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  ImageSize->720,
  PlotRangePadding->None]], "Output",
 CellChangeTimes->{
  3.52206136473774*^9, 3.5220614063670053`*^9, 3.52206157566527*^9, 
   3.5220616062161922`*^9, {3.5220617092151737`*^9, 3.5220617548082323`*^9}}]
}, Open  ]]
}, Open  ]]
},
CellGrouping->Manual,
WindowSize->{1280, 671},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 186, 4, 26, "Subsubtitle"],
Cell[CellGroupData[{
Cell[611, 21, 152, 2, 67, "Section"],
Cell[766, 25, 532, 11, 27, "Input"],
Cell[1301, 38, 507, 12, 27, "Input"],
Cell[CellGroupData[{
Cell[1833, 54, 320, 9, 27, "Input"],
Cell[2156, 65, 795, 15, 70, "Message"]
}, Open  ]],
Cell[2966, 83, 710, 11, 43, "Subsubtitle"],
Cell[3679, 96, 328, 8, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[4044, 109, 174, 2, 37, "Section"],
Cell[4221, 113, 406, 9, 43, "Subsubtitle"],
Cell[4630, 124, 8744, 189, 577, "Input"],
Cell[CellGroupData[{
Cell[13399, 317, 133, 1, 26, "Subsubtitle"],
Cell[13535, 320, 3462, 86, 208, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[17046, 412, 133, 2, 37, "Section"],
Cell[17182, 416, 4094, 95, 283, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[21313, 516, 168, 2, 37, "Section"],
Cell[21484, 520, 534, 11, 43, "Subsubtitle"],
Cell[22021, 533, 1846, 46, 178, "Input"],
Cell[23870, 581, 3012, 78, 133, "Input"],
Cell[26885, 661, 1664, 43, 163, "Input"],
Cell[28552, 706, 1854, 48, 103, "Input"],
Cell[30409, 756, 1523, 30, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31969, 791, 115, 1, 67, "Section"],
Cell[32087, 794, 233, 5, 26, "Subsubtitle"],
Cell[32323, 801, 22196, 466, 1078, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[54556, 1272, 145, 2, 37, "Section"],
Cell[54704, 1276, 6203, 140, 430, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[60944, 1421, 129, 2, 37, "Section"],
Cell[61076, 1425, 2234, 51, 193, "Input"],
Cell[63313, 1478, 4323, 100, 238, "Input"],
Cell[67639, 1580, 2981, 70, 208, "Input"],
Cell[70623, 1652, 223, 3, 67, "Section"],
Cell[70849, 1657, 756, 15, 43, "Subsubtitle"],
Cell[71608, 1674, 1581, 24, 27, "Input"],
Cell[73192, 1700, 715, 14, 26, "Subsubtitle"],
Cell[73910, 1716, 951, 21, 58, "Input"],
Cell[74864, 1739, 1023, 17, 43, "Subsubtitle"],
Cell[75890, 1758, 3870, 78, 223, "Input"],
Cell[79763, 1838, 6207, 132, 373, "Input"],
Cell[85973, 1972, 805, 12, 26, "Subsubtitle"],
Cell[86781, 1986, 314, 6, 27, "Input"],
Cell[87098, 1994, 593, 11, 26, "Subsubtitle"],
Cell[87694, 2007, 3293, 58, 133, "Input"],
Cell[90990, 2067, 3104, 53, 73, "Input"],
Cell[94097, 2122, 713, 12, 43, "Subsubtitle"],
Cell[94813, 2136, 3448, 85, 193, "Input"],
Cell[98264, 2223, 715, 12, 26, "Subsubtitle"],
Cell[98982, 2237, 863, 18, 43, "Input"],
Cell[99848, 2257, 477, 11, 23, "Message"],
Cell[100328, 2270, 476, 11, 23, "Message"],
Cell[100807, 2283, 1008, 20, 43, "Subsubtitle"],
Cell[101818, 2305, 3816, 66, 88, "Input"],
Cell[105637, 2373, 103, 1, 26, "Subsubtitle"],
Cell[CellGroupData[{
Cell[105765, 2378, 538, 10, 27, "Input"],
Cell[106306, 2390, 118, 2, 20, "Print"],
Cell[106427, 2394, 118, 2, 20, "Print"],
Cell[106548, 2398, 345, 9, 21, "Message"],
Cell[106896, 2409, 346, 9, 21, "Message"],
Cell[107245, 2420, 117, 2, 20, "Print"],
Cell[107365, 2424, 118, 2, 20, "Print"],
Cell[107486, 2428, 346, 9, 21, "Message"],
Cell[107835, 2439, 345, 9, 21, "Message"],
Cell[108183, 2450, 118, 2, 20, "Print"],
Cell[108304, 2454, 118, 2, 20, "Print"],
Cell[108425, 2458, 346, 9, 21, "Message"],
Cell[108774, 2469, 345, 9, 21, "Message"],
Cell[109122, 2480, 342, 9, 23, "Message"],
Cell[109467, 2491, 344, 9, 23, "Message"],
Cell[109814, 2502, 118, 2, 20, "Print"],
Cell[109935, 2506, 118, 2, 20, "Print"],
Cell[110056, 2510, 118, 2, 20, "Print"],
Cell[110177, 2514, 118, 2, 20, "Print"],
Cell[110298, 2518, 118, 2, 20, "Print"],
Cell[110419, 2522, 118, 2, 20, "Print"],
Cell[110540, 2526, 120, 2, 20, "Print"],
Cell[110663, 2530, 118, 2, 20, "Print"],
Cell[110784, 2534, 118, 2, 20, "Print"],
Cell[110905, 2538, 120, 2, 20, "Print"],
Cell[111028, 2542, 118, 2, 20, "Print"],
Cell[111149, 2546, 117, 2, 20, "Print"],
Cell[111269, 2550, 120, 2, 20, "Print"],
Cell[111392, 2554, 118, 2, 20, "Print"],
Cell[111513, 2558, 120, 2, 20, "Print"],
Cell[111636, 2562, 118, 2, 20, "Print"],
Cell[111757, 2566, 120, 2, 20, "Print"],
Cell[111880, 2570, 120, 2, 20, "Print"],
Cell[112003, 2574, 1050, 25, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113090, 2604, 225, 5, 27, "Input"],
Cell[113318, 2611, 118, 2, 20, "Print"],
Cell[113439, 2615, 118, 2, 20, "Print"],
Cell[113560, 2619, 118, 2, 20, "Print"],
Cell[113681, 2623, 120, 2, 20, "Print"],
Cell[113804, 2627, 120, 2, 20, "Print"],
Cell[113927, 2631, 120, 2, 20, "Print"],
Cell[114050, 2635, 118, 2, 20, "Print"],
Cell[114171, 2639, 120, 2, 20, "Print"],
Cell[114294, 2643, 118, 2, 20, "Print"],
Cell[114415, 2647, 120, 2, 20, "Print"],
Cell[114538, 2651, 120, 2, 20, "Print"],
Cell[114661, 2655, 118, 2, 20, "Print"],
Cell[114782, 2659, 118, 2, 20, "Print"],
Cell[114903, 2663, 118, 2, 20, "Print"],
Cell[115024, 2667, 120, 2, 20, "Print"],
Cell[115147, 2671, 118, 2, 20, "Print"],
Cell[115268, 2675, 118, 2, 20, "Print"],
Cell[115389, 2679, 116, 2, 20, "Print"],
Cell[115508, 2683, 118, 2, 20, "Print"],
Cell[115629, 2687, 117, 2, 20, "Print"],
Cell[115749, 2691, 115, 2, 20, "Print"],
Cell[115867, 2695, 120, 2, 20, "Print"],
Cell[115990, 2699, 118, 2, 20, "Print"],
Cell[116111, 2703, 118, 2, 20, "Print"],
Cell[116232, 2707, 1935, 39, 73, "Output"]
}, Open  ]],
Cell[118182, 2749, 218, 3, 34, "Subsection"],
Cell[118403, 2754, 1380, 27, 67, "Input"],
Cell[119786, 2783, 246, 5, 27, "Input"],
Cell[CellGroupData[{
Cell[120057, 2792, 104, 1, 27, "Input"],
Cell[120164, 2795, 1856, 39, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122057, 2839, 1089, 27, 27, "Input"],
Cell[123149, 2868, 12722, 308, 287, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135908, 3181, 889, 25, 27, "Input"],
Cell[136800, 3208, 11608, 280, 291, "Output"]
}, Open  ]],
Cell[148423, 3491, 179, 2, 34, "Subsection"],
Cell[148605, 3495, 648, 14, 21, "Input"],
Cell[149256, 3511, 1801, 38, 73, "Input"],
Cell[CellGroupData[{
Cell[151082, 3553, 354, 7, 27, "Input"],
Cell[151439, 3562, 560, 11, 23, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152036, 3578, 43, 0, 27, "Input"],
Cell[152082, 3580, 860, 23, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152979, 3608, 1166, 28, 27, "Input"],
Cell[154148, 3638, 9198, 220, 282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163383, 3863, 797, 23, 27, "Input"],
Cell[164183, 3888, 8059, 192, 282, "Output"]
}, Open  ]],
Cell[172257, 4083, 255, 3, 34, "Subsection"],
Cell[CellGroupData[{
Cell[172537, 4090, 2019, 40, 37, "Input"],
Cell[174559, 4132, 18187, 405, 479, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

